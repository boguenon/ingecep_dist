IG$.BC$hcp={};IG$.BC$hcp.hconfig=[];IG$.BC$hcp.dconfig={CURDATE:"DATE;yyyyMMdd",PREVDATE:"DATE;yyyyMMdd;D;-1",PREVMONTH:"DATE;yyyyMMdd;M;-1",PREVYEAR:"DATE;yyyyMMdd;Y;-1",USERNAME:"USERNAME",GROUPNAME:"GROUPNAME",USERID:"USERID",USERNAME:"USERNAME",DEPTNAME:"SQL;IGCBASE;SELECT dname FROM WHERE dname='${GROUPNAME}'"};IG$._I77=$s.extend($s.panel,{closable:true,layout:"fit",bodyPadding:10,iconCls:"icon-ing-docdef",_uid:"/SYS_Config/systemconfig",_IFd:function(){var e=this,d,a=e.down("[name=grdparams]"),c,b=e._uid;d=new IG$._I3e();d.init(e,{ack:"5",payload:IG$._I2d({uid:b}),mbody:IG$._I2e({option:""})},e,e._IM9,e.rs_F1e);d._l()},_IM9:function(a){var c=this,g=IG$._I18(a,"/smsg/item"),f,b,e=[],d;if(g){f=IG$._I26(g);for(b=0;b<f.length;b++){d={name:IG$._I1b(f[b],"name"),type:IG$._I1b(f[b],"type"),value:IG$._I24(f[b])};e.push(d)}}c.params=e;c.l1()},rs_F1e:function(a){var f=this,e=true,d,c=IG$._I27(a),b=f._uid;if(c=="0x1400"){d=new IG$._I3e();d.init(f,{ack:"31",payload:IG$._I2d({address:b,name:"systemconfig",type:"PrivateContent"}),mbody:"<smsg></smsg>"},f,f._IM9,f.rs_F1w);d._l();e=false}return e},rs_F1w:function(a){var b=this,c=IG$._I18(a,"/smsg/item");b.params=[];b.l1()},l1:function(){var h=this,f=IG$.BC$hcp.hconfig,d=IG$.BC$hcp.dconfig,b=[],c=h.params,a={},g=h.down("[name=grdparams]"),e,k;for(e=0;e<f.length;e++){a[f[e]]=f[e]}for(e=0;e<c.length;e++){if(a[c[e].name]){delete a[c[e].name]}if(d[c[e].name]){delete d[c[e].name]}b.push({name:c[e].name,type:c[e].type,value:c[e].value})}for(k in a){b.push({name:k,type:"SVAR",value:""})}for(k in d){b.push({type:"DVAR",name:k,value:d[k]})}g.store.loadData(b)},_t$:function(e){var c=this,a=c.down("[name=grdparams]");switch(e){case"cmd_save":c.s1();break;case"cmd_refresh":c._IFd();break;case"cmd_add_param":var g=a.store.add({name:"",value:""});a.getSelectionModel().select(g);break;case"cmd_rm_param":var d=a.getSelectionModel().selected,b,f;for(b=d.length-1;b>=0;b--){a.store.remove(d.items[b])}break}},s1:function(){var d=this,a=d.down("[name=grdparams]"),b,e,c;cnt="<smsg><item>";for(b=0;b<a.store.data.items.length;b++){e=a.store.data.items[b];if(e.get("name")){cnt+="<param type='"+(e.get("type")||"VAR")+"' name='"+e.get("name")+"'><![CDATA["+e.get("value")+"]]></param>"}}cnt+="</item></smsg>";c=new IG$._I3e();c.init(d,{ack:"31",payload:IG$._I2d({address:d._uid}),mbody:cnt},d,d.rs_s1,null);c._l()},rs_s1:function(a){var b=this;IG$._I54(ig$.appname,IRm$.r1("M_SAVED"),null,b,0,"success")},initComponent:function(){var a=this;$s.apply(this,{items:[{xtype:"form",layout:{type:"vbox",align:"stretch"},border:0,items:[{xtype:"displayfield",value:IRm$.r1("L_V_DESC")},{xtype:"gridpanel",name:"grdparams",store:{xtype:"store",fields:["name","value","type"]},flex:1,selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell"},plugins:[{ptype:"cellediting",clicksToEdit:false}],columns:[{xtype:"gridcolumn",text:IRm$.r1("B_TYPE"),dataIndex:"type",width:80,editor:{allowBlank:false}},{xtype:"gridcolumn",text:IRm$.r1("B_NAME"),dataIndex:"name",width:200,editor:{allowBlank:false}},{xtype:"gridcolumn",text:IRm$.r1("B_VALUE"),flex:1,dataIndex:"value",editor:{allowBlank:true}}]}]}],tbar:[{iconCls:"icon-toolbar-save",name:"t_save",tooltip:IRm$.r1("L_SAVE_CONTENT"),handler:function(){this._t$("cmd_save")},scope:this},"-",{iconCls:"icon-refresh",tooltip:IRm$.r1("L_REFRESH"),handler:function(){this._t$("cmd_refresh")},scope:this},"-",{iconCls:"icon-toolbar-add",text:IRm$.r1("L_ADD_VAR"),tooltip:IRm$.r1("L_ADD_VAR"),handler:function(){this._t$("cmd_add_param")},scope:this},{iconCls:"icon-grid-delete",text:IRm$.r1("L_RM_VAR"),tooltip:IRm$.r1("L_RM_VAR"),handler:function(){this._t$("cmd_rm_param")},scope:this}]});IG$._I77.superclass.initComponent.call(this)},listeners:{afterrender:function(a){var b=this;b._IFd()}}});IG$._I9f=$s.extend($s.window,{modal:true,layout:"fit",closable:false,resizable:false,width:300,autoHeight:true,callback:null,_IFd:function(){},initComponent:function(){var a=this;a.title=IRm$.r1("L_MAKEITEM");$s.apply(this,{defaults:{bodyStyle:"padding:10px"},items:[{xtype:"form",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:"Name",name:"i_name"},{xtype:"textfield",fieldLabel:"Host address",name:"l_address"}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this.$f3()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}]});IG$._I9f.superclass.initComponent.call(this)},listeners:{afterrender:function(a){var b=this;b._IFd()}}});IG$.BC$ds=$s.extend(IG$.BC$base,{region:"center",layout:"fit",autoHeight:true,callback:null,_IFe:function(){var a=this,b=a.job;a.dsmapper=a.down("[name=dsmapper]");a.dstype=a.down("[name=dstype]");a.dsfname=a.down("[name=dsfname]");a.dstname=a.down("[name=dstname]");a.dsskipexist=a.down("[name=dsskipexist]");IG$.BC$ds.superclass._IFe.call(this,arguments);if(b){a.dsmapper.setValue(b.dsmapper);a.dstype.setValue(b.dstype);a.dsfname.setValue(b.dsfname);a.dstname.setValue(b.dstname);a.dsskipexist.setValue(b.dsskipexist=="T"?true:false)}},_IFf:function(){var a=this,b=a.job;a.callParent(arguments);if(b){b.dsmapper=a.dsmapper.getValue();b.dsfname=a.dsfname.getValue();b.dstname=a.dstname.getValue();b.dsskipexist=a.dsskipexist.getValue()?"T":"F";b.dstype=a.dstype.getValue()}a._IG0()},initComponent:function(){var a=this,c=120,b=a.__m;a.title=IRm$.r1("T_BG_DS");a.moption=[{xtype:"fieldset",title:"Advanced Option",layout:"anchor",defaults:{anchor:"100%",labelAlign:"top"},items:[{xtype:"combobox",name:"dstype",fieldLabel:"Data Type",queryMode:"local",displayField:"name",valueField:"type",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","type"],data:[{name:"File",type:"file",selected:1},{name:"Stream type",type:"stream"},{name:"Data Query",type:"sql"}]},listeners:{change:function(d){var g=this,e=d.getValue(),h=g.down("[name=f_f1]"),f=g.down("[name=f_f2]");h.setVisible(e!="sql");f.setVisible(e=="sql")},scope:this}},{xtype:"fieldcontainer",name:"f_f1",layout:"anchor",defaults:{anchor:"100%",labelAlign:"top"},items:[{xtype:"textarea",name:"dsfname",minHeight:80,hidden:!b,fieldLabel:"File/Directory (Server)"},{xtype:"checkbox",name:"dsskipexist",hidden:b,fieldLabel:"Skip if exist",boxLabel:"Enable"},{xtype:"textfield",name:"dstname",hidden:b,fieldLabel:"HDFS name"}]},{xtype:"fieldcontainer",name:"f_f2",hidden:true,layout:"anchor",defaults:{anchor:"100%",labelAlign:"top"},items:[{xtype:"textfield",name:"dbpool",fieldLabel:"DataSource"},{xtype:"textarea",name:"dbsql",fieldLabel:"SQL Query"}]},{xtype:"fieldcontainer",hidden:true,fieldLabel:"MapRed",layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",flex:1,name:"dsmapper"},{xtype:"button",text:"..",handler:function(){this.GG1(this.dsmapper)},scope:this}]}]}];IG$.BC$ds.superclass.initComponent.apply(this,arguments)}});IG$.BC$hj=$s.extend(IG$.BC$base,{modal:true,isWindow:true,region:"center",layout:"fit",closable:false,resizable:false,autoHeight:true,callback:null,_IFe:function(){var a=this,b=a.job;a.dsscript=a.down("[name=dsscript]");IG$.BC$hj.superclass._IFe.call(a,arguments);if(b){a.dsscript.setValue(Base64.decode(b.dsscript))}},_IFf:function(){var a=this,b=a.job;a.callParent(arguments);if(b){b.dsscript=Base64.encode(a.dsscript.getValue())}a._IG0()},initComponent:function(){var a=this;a.title=IRm$.r1("T_BG_HIVEJOB");a.moption=[{xtype:"fieldset",title:"Advanced Option",layout:"anchor",defaults:{anchor:"100%",labelAlign:"top"},items:[{xtype:"textarea",fieldLabel:"Hive SQL",name:"dsscript",height:150}]}];IG$.BC$hj.superclass.initComponent.apply(this,arguments)}});IG$.BC$scD=$s.extend($s.window,{modal:true,isWindow:true,region:"center",layout:"fit",closable:false,resizable:false,width:500,autoHeight:true,callback:null,_IFe:function(){var a=this,b=a.down("[name=msgresult]");b.setValue(a.msg)},initComponent:function(){var a=this;a.title=IRm$.r1("T_BG_SCR");$s.apply(this,{defaults:{bodyStyle:"padding:10px"},items:[{xtype:"form",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textarea",name:"msgresult",height:200}]}],buttons:["->",{text:IRm$.r1("B_CLOSE"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(c){var b=this;b._IFe()}}});IG$.BC$scD.superclass.initComponent.apply(this,arguments)}});BC$sc=$s.extend(IG$.BC$base,{region:"center",layout:"fit",autoHeight:true,callback:null,_IFe:function(){var a=this,b=a.job;a.dsscript=a.down("[name=dsscript]");BC$sc.superclass._IFe.call(a,arguments);if(b){a.dsscript.setValue(Base64.decode(b.dsscript))}},_IFf:function(){var a=this,b=a.job;a.callParent(arguments);if(b){b.dsscript=Base64.encode(a.dsscript.getValue())}a._IG0()},ts:function(){var e=this,a=this,c=e.dsscript.getValue(),d=new IG$._I3e(),b=[];b.push("<smsg><item sid='"+(e.job.sid||"")+"'>");b.push("<command><![CDATA["+Base64.encode(c)+"]]></command>");b.push("</item></smsg>");d.init(a,{ack:"3",payload:IG$._I2d({sid:e.job.sid,option:"command"},"sid;option"),mbody:b.join("")},a,a.rs_ts,null);d._l()},rs_ts:function(e){var k=this,a=IG$._I18(e,"/smsg"),g=a?IG$._I26(a):null,f,c,b,d,m,l=false;if(g){for(d=0;d<g.length;d++){c=IG$._I19(g[d],"errormessage");if(c){b=IG$._I24(c);b=Base64.decode(b);l=true}else{c=IG$._I19(g[d],"message");if(c){b=IG$._I24(c);b=Base64.decode(b)}}m=(m)?m+"\n"+b:b}var h=new IG$.BC$scD({msg:m});IG$._I_5(this,h);if(l==true){IG$._I54(ig$.appname,"One or more command failed. See log for detail",null,k,null,null,1,"error")}}},initComponent:function(){var a=this;a.title=IRm$.r1("T_BG_SC");a.moption=[{xtype:"fieldset",title:"Advanced Option",layout:"anchor",defaults:{anchor:"100%",labelAlign:"top"},items:[{xtype:"textarea",fieldLabel:"Shell Command",name:"dsscript",height:150},{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch"},items:[{xtype:"fieldcontainer",flex:1},{xtype:"button",text:"Test command",handler:function(){var b=this;b.ts()},scope:this}]}]}];BC$sc.superclass.initComponent.apply(this,arguments)}});IG$.BC$op=$s.extend(IG$.BC$base,{region:"center",layout:"fit",autoHeight:true,callback:null,_IFe:function(){var a=this,b=a.job;a.dsfname=a.down("[name=dsfname]");a.dscnames=a.down("[name=dscnames]");a.dsmname=a.down("[name=dsmname]");a.dsruntype=a.down("[name=dsruntype]");a.dsdelim=a.down("[name=dsdelim]");a.dsdelimval=a.down("[name=dsdelimval]");a.dstcube=a.down("[name=dstcube]");a.dsmeasuredelim=a.down("[name=dsmeasuredelim]");a.dsmeasuredelimval=a.down("[name=dsmeasuredelimval]");a.dscsdatause=a.down("[name=dscsdatause]");a.dscsdatafile=a.down("[name=dscsdatafile]");IG$.BC$op.superclass._IFe.call(a,arguments);if(b){a.dsfname.setValue(b.dsfname);a.dscnames.setValue(b.dscnames);a.dsmname.setValue(b.dsmname);a.dsruntype.setValue(b.dsruntype);a.dsdelim.setValue(b.dsdelim);a.dsdelimval.setValue(b.dsdelimval);a.dstcube.setValue(b.dstcube);a.dstcubeuid=b.dstcubeuid;a.dsmeasuredelim.setValue(b.dsmeasuredelim);a.dsmeasuredelimval.setValue(b.dsmeasuredelimval);a.dscsdatause.setValue(b.dscsdatause=="T");a.dscsdatafile.setValue(b.dscsdatafile);a.dscsdatafile.setVisible(b.dscsdatause=="T")}},_IFf:function(){var a=this,b=a.job;a.callParent(arguments);if(b){b.dsfname=a.dsfname.getValue();b.dscnames=a.dscnames.getValue();b.dsmname=a.dsmname.getValue();b.dsruntype=a.dsruntype.getValue();b.dsdelim=a.dsdelim.getValue();b.dsdelimval=a.dsdelimval.getValue();b.dstcube=a.dstcube.getValue();b.dstcubeuid=a.dstcubeuid;b.dsmeasuredelim=a.dsmeasuredelim.getValue();b.dsmeasuredelimval=a.dsmeasuredelimval.getValue();b.dscsdatause=a.dscsdatause.getValue()==true?"T":"F";b.dscsdatafile=a.dscsdatafile.getValue()}a._IG0()},m1:function(){var a=new IG$._I96({mode:"newitem"});a.callback=new IG$._I3d(this,this.rs_m1);IG$._I_5(this,a)},rs_m1:function(d){var a=this,b="<smsg><item></item></smsg>",c=new IG$._I3e();c.init(a,{ack:"31",payload:"<smsg><item address='"+d.nodepath+"/"+d.name+"' name='"+d.name+"' type='MCube' pid='"+d.uid+"' description=''/></smsg>",mbody:b},a,a.rs_m1b,a.rs_m1a,[d.name,d.nodepath,d.uid,b]);c.showerror=false;c._l()},rs_m1a:function(a,d){var b=this,h=d[0],g=d[1],e=d[2],c=d[3],f=IG$._I27(a);if(f=="0x12e0"){IG$._I55(ig$.appname,h+" already exist on the server. Would you overwrite existing item with this copy?",function(l){if(l=="yes"){var k=new IG$._I3e();k.init(b,{ack:"31",payload:"<smsg><item address='"+g+"/"+h+"' name='"+h+"' type='MCube' pid='"+e+"' description='' overwrite='T'/></smsg>",mbody:c},b,b.rs_m1b,null,[h,g]);k._l()}},b,b)}else{IG$._I51(a,b)}},rs_m1b:function(a,e){var b=this,d=IG$._I18(a,"/smsg/item"),c=(d?IG$._I1c(d):null);if(c){b.dstcube.setValue(c.nodepath||c.name);b.dstcubeuid=c.uid}},initComponent:function(){var a=this;a.title=IRm$.r1("T_BG_OP");a.moption=[{xtype:"fieldset",title:"Advanced Option",layout:"anchor",defaults:{anchor:"100%",labelAlign:"top"},items:[{xtype:"textfield",fieldLabel:"Data name",name:"dsfname"},{xtype:"combobox",name:"dsruntype",fieldLabel:"Run type",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value",],data:[{name:"Load in database",value:"R_LOAD_DB"},{name:"Create M-Cube",value:"R_M_CUBE"}]},listeners:{change:function(){var c=this,b=c.dsruntype;c.down("[name=opt_cube]").setVisible(b.getValue()=="R_M_CUBE")},scope:this}},{xtype:"fieldcontainer",fieldLabel:"Custom datafile",layout:{type:"hbox",align:"stretch"},items:[{xtype:"checkbox",boxLabel:"Enable",name:"dscsdatause",listeners:{change:function(){var b=this,d=b.dscsdatafile,c=b.dscsdatause;d.setVisible(c.getValue()==true)},scope:this}},{xtype:"textfield",flex:1,name:"dscsdatafile"}]},{xtype:"textarea",name:"dscnames",fieldLabel:"Extra column names",height:50},{xtype:"textfield",name:"dsmname",fieldLabel:"Measure column"},{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch"},items:[{xtype:"combobox",name:"dsdelim",fieldLabel:"Field delimiter",queryMode:"local",valueField:"value",displayField:"name",editable:false,autoSelect:true,labelAlign:"top",store:{xtype:"store",fields:["name","value"],data:[{name:"Comma",value:"comma"},{name:"Custom value",value:""},{name:"Tab",value:"tab"},{name:"New line",value:"newline"}]},listeners:{change:function(){var d=this,b=d.dsdelim,c=d.dsdelimval;c.setVisible(b.getValue()=="")},scope:this}},{xtype:"textfield",hidden:true,flex:1,name:"dsdelimval",fieldLabel:""}]},{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch",labelAlign:"top"},items:[{xtype:"combobox",name:"dsmeasuredelim",fieldLabel:"Measure delimiter",queryMode:"local",valueField:"value",displayField:"name",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"Comma",value:"comma"},{name:"Custom value",value:""},{name:"Tab",value:"tab"},{name:"New line",value:"newline"}]},listeners:{change:function(){var d=this,c=d.dsmeasuredelim,b=d.dsmeasuredelimval;b.setVisible(c.getValue()=="")},scope:this}},{xtype:"textfield",hidden:true,flex:1,name:"dsmeasuredelimval",fieldLabel:""}]},{xtype:"fieldcontainer",name:"opt_cube",fieldLabel:"Cube",labelAlign:"top",layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",name:"dstcube",flex:1},{xtype:"button",name:"btn_cube",text:"Create Cube",handler:function(){var b=this;b.m1()},scope:this}]}]}];IG$.BC$op.superclass.initComponent.apply(this,arguments)}});IG$.BC$mr=$s.extend(IG$.BC$base,{region:"center",layout:"fit",callback:null,_IFe:function(){var k=this,a=k.job,g,e,d=[],c,b,h=false,f=false;k.dsmapper=k.down("[name=dsmapper]");k.grdparams=k.down("[name=grdparams]");IG$.BC$mr.superclass._IFe.call(k,arguments);if(a){k.dsmapper.setValue(a.dsmapper);g=(a.confparams?a.confparams.split("|"):null);if(g){for(e=0;e<g.length;e++){c={};b=g[e].indexOf("=");c.name=b>-1?g[e].substring(0,b):"";c.value=b>-1?g[e].substring(b+1):"";if(c.name){if(c.name=="input"){h=true}else{if(c.name=="output"){f=true}}d.push(c)}}}if(!h){d.push({name:"input",value:""})}if(!f){d.push({name:"output",value:""})}k.grdparams.store.loadData(d)}},_IFf:function(){var c=this,d=c.job,a=c.grdparams,f,e=[],g,b;c.callParent(arguments);if(d){d.dsmapper=c.dsmapper.getValue();for(b=0;b<a.store.data.items.length;b++){f=a.store.data.items[b];if(f.get("name")){e.push(f.get("name")+"="+f.get("value"))}}d.confparams=e.join("|")}c._IG0()},initComponent:function(){var a=this;a.title=IRm$.r1("T_BG_MR");a.moption=[{xtype:"fieldset",title:"Advanced Option",layout:"anchor",defaults:{anchor:"100%",labelAlign:"top"},items:[{xtype:"fieldcontainer",fieldLabel:"MapRed",layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",name:"dsmapper",flex:1},{xtype:"button",text:"..",handler:function(){this.GG1(this.dsmapper)},scope:this}]},{xtype:"displayfield",value:"Configuration Parameters"},{xtype:"gridpanel",name:"grdparams",height:120,store:{xtype:"store",fields:["name","value"]},selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell"},plugins:[{ptype:"cellediting",clicksToEdit:false}],columns:[{xtype:"gridcolumn",text:"Name",width:200,dataIndex:"name",editor:{allowBlank:false}},{xtype:"gridcolumn",text:"Value",dataIndex:"value",flex:1,editor:{allowBlank:true}}],tbar:[{xtype:"button",text:"Add param",handler:function(){var b=this.grdparams;b.store.add({name:"",value:""})},scope:this},{xtype:"button",text:"Remove selected",handler:function(){var b=this.grdparams,c=b.getSelectionModel().getSelection();for(i=c.length-1;i>=0;i--){b.store.remove(c[i])}},scope:this}]}]}];IG$.BC$mr.superclass.initComponent.apply(this,arguments)}});IG$.BC$mr1=$s.extend(IG$.BC$base,{region:"center",layout:"fit",callback:null,_IFe:function(){var g=this,a=g.job,f,e,d=[],c,b,k,h;g.grdparams=g.down("[name=grdparams]");g.rowregex=g.down("[name=rowregex]");g.rowsample=g.down("[name=rowsample]");g.mrtype=g.down("[name=mrtype]");IG$.BC$mr1.superclass._IFe.call(g,arguments);if(a){g.mrtype.setValue(a.mrtype||"regex");g.rowregex.setValue(a.rowregex);g.rowsample.setValue(a.rowsample);f=(a.cfields?a.cfields.split("|"):null);if(f){for(e=0;e<f.length;e++){c={};b=f[e].indexOf("=");c.name=b>-1?f[e].substring(0,b):"";k=b>-1?f[e].substring(b+1):"";if(k.indexOf("^")>-1){h=k.split("^");c.value=h[0];if(h.length>1){c.isdate=h[1]=="T"}if(h.length>2){c.dformat=h[2]}}else{c.value=k}if(c.name){d.push(c)}}}g.grdparams.store.loadData(d)}},_IFf:function(){var d=this,e=d.job,a=d.grdparams,f,c=[],g,b;d.callParent(arguments);if(e){e.mrtype=d.mrtype.getValue();e.rowregex=d.rowregex.getValue();e.rowsample=d.rowsample.getValue();for(b=0;b<a.store.data.items.length;b++){f=a.store.data.items[b];if(f.get("name")){c.push(f.get("name")+"="+f.get("value")+"^"+(f.get("isdate")?"T":"F")+"^"+(f.get("dformat")||""))}}e.cfields=c.join("|")}d._IG0()},_g1:function(){var c=this,b=new IG$._I3e(),a;a="<smsg><info mrtype='"+c.mrtype.getValue()+"' option='regex'>";a+="<params>";a+="<param name='rowregex'><![CDATA["+c.rowregex.getValue()+"]]></param>";a+="<param name='rowsample'><![CDATA["+c.rowsample.getValue()+"]]></param>";a+="</params>";a+="</info></smsg>";b.init(c,{ack:"11",payload:IG$._I2d({}),mbody:a},c,function(d){var l=IG$._I18(d,"/smsg/results/fields"),k=IG$._I26(l),g,m=[],h,f,e=c.grdparams;for(g=0;g<k.length;g++){f=IG$._I24(k[g]);m.push({name:f,value:f})}e.store.loadData(m)});b._l()},_g2:function(d){var c=this,b=new IG$._I3e(),a="<smsg><info option='date_format'><date><![CDATA["+d.get("value")+"]]></date></info></smsg>";b.init(c,{ack:"11",payload:IG$._I2d({}),mbody:a},c,function(e){var l=IG$._I18(e,"/smsg/results"),k=IG$._I26(l),g,m=[],h,f;for(g=0;g<k.length;g++){f=IG$._I24(k[g]);m.push(f)}if(m.length){d.set("dformat",m[0])}});b._l()},initComponent:function(){var a=this;a.title=IRm$.r1("T_BG_MR");a.moption=[{xtype:"fieldset",title:"Advanced Option",layout:"anchor",defaults:{anchor:"100%",labelAlign:"top"},items:[{xtype:"combobox",name:"mrtype",fieldLabel:"Data Processor Type",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"RegEx",value:"regex",selected:1},{name:"Delimiter",value:"delimiter"}]},listeners:{change:function(b){var e=this,c=b.getValue(),f=e.down("[name=f_f1]"),d=e.down("[name=f_f2]");f.setVisible(c=="regex");d.setVisible(c!="regex")},scope:this}},{xtype:"fieldcontainer",layout:"anchor",name:"f_f1",hidden:true,defaults:{anchor:"100%",labelAlign:"top"},items:[{xtype:"textarea",name:"rowregex",height:80,fieldLabel:"Data Row RegEx"},{xtype:"displayfield",value:'Ex: ^(\\\\S+) (\\\\S+) (\\\\S+) \\\\[(.*?)\\\\] \\"(.*?)\\" (\\\\S+) (\\\\S+)( \\"(.*?)" \\"(.*?)\\")?'}]},{xtype:"fieldcontainer",layout:"anchor",name:"f_f2",hidden:true,defaults:{anchor:"100%",labelAlign:"top"},items:[{xtype:"textfield",name:"m_delim",fieldLabel:"Delimiter"}]},{xtype:"textarea",name:"rowsample",height:80,fieldLabel:"Sample Text"},{xtype:"fieldcontainer",layout:{type:"hbox",pack:"right"},items:[{xtype:"button",text:"Get",handler:function(){this._g1()},scope:this}]},{xtype:"displayfield",value:"Output Fields"},{xtype:"gridpanel",name:"grdparams",height:250,store:{xtype:"store",fields:["name","value","isdate","dformat"]},selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell"},plugins:[{ptype:"cellediting",clicksToEdit:false}],columns:[{text:"Name",minWidth:120,dataIndex:"name",editor:{allowBlank:false}},{text:"Value",dataIndex:"value",minWidth:120,editor:{allowBlank:true}},{xtype:"checkcolumn",text:"Date",dataIndex:"isdate",width:30,minWidth:30,listeners:{checkchange:function(b,c,e,f){var d=this,g=d.grdparams.store.data.items[c];if(e&&g&&!g.get("dformat")&&g.get("value")){d._g2(g)}},scope:this}},{text:"Format",minWidth:70,dataIndex:"dformat",editor:{allowBlank:true,listeners:{edit:function(c,b,d){},scope:this}}}],tbar:[{xtype:"button",text:"Add param",handler:function(){var b=this.grdparams;b.store.add({name:"",value:""})},scope:this},{xtype:"button",text:"Remove selected",handler:function(){var b=this.grdparams,c=b.getSelectionModel().getSelection();for(i=c.length-1;i>=0;i--){b.store.remove(c[i])}},scope:this}]}]}];IG$.BC$mr1.superclass.initComponent.apply(this,arguments)}});IG$.BC$mr2=$s.extend(IG$.BC$base,{region:"center",layout:"fit",autoHeight:true,callback:null,_IFe:function(){var c=this,e=c.job,a,b,d=[],f,g;c.grdparams=c.down("[name=grdparams]");c.doctmpl=c.down("[name=doctmpl]");c.mrnode=c.down("[name=mrnode]");c.mrdb=c.down("[name=mrdb]");c.mrcol=c.down("[name=mrcol]");c.mrdocname=c.down("[name=mrdocname]");c.mrsmode=c.down("[name=mrsmode]");IG$.BC$mr2.superclass._IFe.call(c,arguments);if(e){c.doctmpl.setValue(e.doctmpl);c.mrdb.setValue(e.mrdb);c.mrcol.setValue(e.mrcol);c.mrdocname.setValue(e.mrdocname);c.mrsmode.setValue(e.mrsmode||"");a=(e.confparams?e.confparams.split("|"):null);if(a){for(b=0;b<a.length;b++){f={};g=a[b].indexOf("=");f.name=g>-1?a[b].substring(0,g):"";f.value=g>-1?a[b].substring(g+1):"";if(f.name){d.push(f)}}}c.grdparams.store.loadData(d);c.l1()}},_IFf:function(){var c=this,d=c.job,a=c.grdparams,f,e=[],g,b;c.callParent(arguments);if(d){d.mrnode=c.mrnode.getValue();d.doctmpl=c.doctmpl.getValue();d.mrdb=c.mrdb.getValue();d.mrcol=c.mrcol.getValue();d.mrdocname=c.mrdocname.getValue();d.mrsmode=c.mrsmode.getValue();for(b=0;b<a.store.data.items.length;b++){f=a.store.data.items[b];if(f.get("name")){e.push(f.get("name")+"="+f.get("value"))}}d.confparams=e.join("|")}c._IG0()},l1:function(){var c=this,b=new IG$._I3e(),a=c.mrnode;b.init(c,{ack:"25",payload:IG$._I2d({uid:c.uid,dbtype:"mongodb",option:"nosqldb_node"},"uid;dbtype;option"),mbody:IG$._I2e({})},c,function(d){var h=IG$._I18(d,"/smsg"),g=IG$._I26(h),e,k=[{name:"Select",nodename:""}],f;for(e=0;e<g.length;e++){f=IG$._I1c(g[e]);f.nodename=f.nodename||f.name;k.push(f)}a.store.loadData(k);a.setValue(c.job.mrnode||"")},null);b._l()},m1:function(){var m=this,c=m._p,a,f,l=[],k,h,e,q,b,d,o,g=m.down("[name=doctmpl]");a=c.m2.call(c,m,"mongoreduce");if(a&&a.length){f=a[0].cfields;if(f){f=f.split("|");for(k=0;k<f.length;k++){e=f[k];h=e.indexOf("=");if(h>0){q=e.substring(h+1);e=e.substring(0,h);b=e.split("^");d={name:e,value:b[0]};if(b.length>1){d.is_date=b[1]=="T"}if(b.length>2){d.dateformat=b[2]}l.push(d)}}o="";for(k=0;k<l.length;k++){o=(k==0)?l[k].name:o+"\n"+l[k].name}o&&g.setValue(o)}}},initComponent:function(){var a=this;a.title=IRm$.r1("T_BG_MR");a.moption=[{xtype:"fieldset",title:"Advanced Option",layout:"anchor",defaults:{anchor:"100%",labelAlign:"top"},items:[{xtype:"combobox",name:"mrnode",fieldLabel:"MongoData",queryMode:"local",displayField:"name",valueField:"nodename",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","nodename","type"]},listeners:{change:function(b){},scope:this}},{xtype:"textfield",fieldLabel:"DB Name",name:"mrdb"},{xtype:"textfield",fieldLabel:"Collection Name",name:"mrcol"},{xtype:"textfield",fieldLabel:"Document Name",name:"mrdocname"},{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch"},items:[{xtype:"displayfield",value:"Document",flex:1},{xtype:"button",text:"..",handler:function(){this.m1()},scope:this}]},{xtype:"textarea",name:"doctmpl",height:200},{xtype:"combobox",name:"mrsmode",fieldLabel:"Synchronous Write Policy",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"Disabled",value:""},{name:"Cache-Flush",value:"cf"},{name:"Direct-Write",value:"dw"},{name:"Direct-Write-With-Cache",value:"dwc"}]}},{xtype:"gridpanel",name:"grdparams",height:120,store:{xtype:"store",fields:["name","value"]},selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell"},plugins:[{ptype:"cellediting",clicksToEdit:false}],columns:[{xtype:"gridcolumn",text:"Name",width:200,dataIndex:"name",editor:{allowBlank:false}},{xtype:"gridcolumn",text:"Value",dataIndex:"value",flex:1,editor:{allowBlank:true}}],tbar:[{xtype:"button",text:"Add param",handler:function(){var b=this.grdparams;b.store.add({name:"",value:""})},scope:this},{xtype:"button",text:"Remove selected",handler:function(){var b=this.grdparams,c=b.getSelectionModel().getSelection();for(i=c.length-1;i>=0;i--){b.store.remove(c[i])}},scope:this}]}]}];IG$.BC$mr2.superclass.initComponent.apply(this,arguments)}});IG$._Ia0=$s.extend($s.window,{modal:false,isWindow:true,region:"center",layout:"fit",closable:false,resizable:false,width:500,autoHeight:true,callback:null,_IFe:function(){var a=this;if(a.uid){a.rL()}},_IFf:function(){var a=this;a._IG0()},_IG0:function(){this.callback&&this.callback.execute(this.job);this.close()},rL:function(){var b=this;if(b.uid){var b=this,a=new IG$._I3e();a.init(b,{ack:"10",payload:IG$._I2d({uid:b.uid},"uid"),mbody:IG$._I2e({option:"loghistory"})},b,b.rs_rL,false);a._l()}},rs_rL:function(h){var n=this,c=IG$._I18(h,"/smsg"),k=(c?IG$._I26(c):null),g,b=[],e,p=n.down("[name=grdloghist]"),o,f,d,q,a;if(k){for(g=0;g<k.length;g++){e=IG$._I1c(k[g]);e.pstatus=parseInt(e.pstatus);e.created_desc=IG$._I40(e.created);e.updated_desc=IG$._I40(e.updated);f=Number(e.duration);f=isNaN(f)?null:f;e.duration=n.gg2(f);o=n.gg1(e.pstatus);e.pstatus_desc=o;b.push(e)}}p.store.loadData(b)},gg1:function(a){var b="Unknown";switch(a){case 1:b="Running";break;case 10:b="Completed";break;case 20:b="Error: No result";break;case 21:b="Error: Dataformat mismatch";break;case 29:b="Error: Execution failed";break}return b},gg2:function(e){var d=null,a,c,b;if(e!=null){a=Math.floor(e/(60*1000));e-=a*(60*1000);c=Math.floor(e/(1000));e-=c*(1000);b=e;d=(a>0?a+"m ":"")+(c>0?c+"s ":"")+(b>-1?b+"ms":"")}return d},g1:function(b){var c=this,a=new IG$._I3e();a.init(c,{ack:"10",payload:IG$._I2d({sid:b},"sid"),mbody:IG$._I2e({option:"logjoblist"})},c,c.rs_g1,false);a._l()},rs_g1:function(g){var k=this,a=IG$._I18(g,"/smsg"),h=(a?IG$._I26(a):null),e,d=[],f=k.down("[name=grdjobhist]"),b,m,c;if(h){for(e=0;e<h.length;e++){b=IG$._I1c(h[e]);b.pstatus=parseInt(b.pstatus);b.created_desc=IG$._I40(b.created);b.updated_desc=IG$._I40(b.updated);m=k.gg1(b.pstatus);c=Number(b.duration);c=isNaN(c)?null:c;b.duration=k.gg2(c);b.pstatus_desc=m;d.push(b)}}f.store.loadData(d)},initComponent:function(){var a=this,b;a.title=IRm$.r1("L_LOG_VIEW");$s.apply(this,{defaults:{bodyStyle:"padding:10px"},items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",title:"Execution History",layout:"fit",items:[{xtype:"gridpanel",name:"grdloghist",store:{type:"store",fields:["created","updated","sid","duration","pstatus","created_desc","updated_desc","pstatus_desc"]},height:120,columns:[{xtype:"gridcolumn",text:"Started time",dataIndex:"created_desc",flex:1},{xtype:"gridcolumn",text:"End time",dataIndex:"updated_desc",flex:1},{xtype:"gridcolumn",text:"Status",dataIndex:"pstatus_desc",width:120}],listeners:{itemclick:function(f,d,h,g,k){var c=d.get("sid");if(c){this.g1(c)}},scope:this}}]},{xtype:"fieldset",title:"Log detail",layout:"fit",items:[{xtype:"gridpanel",name:"grdjobhist",height:240,store:{xtype:"store",fields:["sid","duration","jobtype","pstatus","created","updated","pstatus_desc","created_desc","updated_desc"]},columns:[{xtype:"gridcolumn",text:"Job type",dataIndex:"jobtype",flex:1},{xtype:"gridcolumn",text:"Duration",width:50,dataIndex:"duration"},{xtype:"gridcolumn",text:"Started time",dataIndex:"created_desc",width:80},{xtype:"gridcolumn",text:"End time",dataIndex:"updated_desc",width:80},{xtype:"gridcolumn",text:"Status",dataIndex:"pstatus_desc",width:80}]}]}]}],buttons:["->",{text:IRm$.r1("B_CLOSE"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(d){var c=this;c._IFe()}}});IG$._Ia0.superclass.initComponent.apply(this,arguments)}});IG$._I9e=function(a){this.xdoc=a;this.P1()};IG$._I9e.prototype={P1:function(){var b=this,a=b.xdoc,c;if(b.xdoc){c=IG$._I18(a,"/smsg/item");if(c){b.iteminfo=IG$._I1c(c)}c=IG$._I18(a,"/smsg/item/SourceCode");if(c){b.javasource=IG$._I24(c);b.javasource=Base64.decode(b.javasource)}}},P2:function(){var c=this,b="",a=c.iteminfo.nodepath.split("/");a.splice(0,2);a.splice(a.length-1,1);b+="package "+a.join(".")+";\n\n";b+="public class "+c.iteminfo.name+"\n";b+="{ \n";b+="} \n";return b},l2:function(){var b=this,a=[];a.push("<smsg><item uid='"+b.iteminfo.uid+"'>");a.push("<SourceCode><![CDATA["+Base64.encode(b.javasource)+"]]></SourceCode>");a.push("</item></smsg>");return a.join("")}};IG$._I9d=$s.extend($s.panel,{closable:true,layout:"border",bodyPadding:0,_IFd:function(){var a=this;a.a2()},a2:function(){var a=this,b;b=new IG$._I3e();b.init(a,{ack:"5",payload:IG$._I2d({uid:a.uid}),mbody:IG$._I2e({option:"standard"})},a,a.rs_a2,false);b._l()},rs_a2:function(d){var f=this,l=new IG$._I9e(d),g,c,b,k,a;f.item=l;g=$(f.down("[name=javasrc]").el.dom);c=$(".idv-jcl-edtr",g);c.empty();k=IG$.x_10._w(g);a=IG$.x_10._h(g);b=$("<div class='idv-jcl-view'></div>").appendTo(c);IG$.x_10._w(b,k);IG$.x_10._h(b,a);if(!window.ace){IG$.x03(ig$.scmap.igcg,new IG$._I3d(f,function(){var h=ace.edit(b[0]);h.getSession().setMode("ace/mode/java");h.setValue(f.item.javasource||f.item.P2());f.scriptview=b;f.scripteditor=h}))}else{var e=ace.edit(b[0]);e.getSession().setMode("ace/mode/java");e.setValue(f.item.javasource||f.item.P2());f.scriptview=b;f.scripteditor=e}},a3:function(d){var a=this,c=new IG$._I3e(),b;a.item.javasource=a.scripteditor.getValue();b=a.item.l2.call(a.item);c.init(a,{ack:"31",payload:IG$._I2d({uid:a.uid}),mbody:b},a,a.rs_a3,null,d);c._l()},rs_a3:function(a,c){var b=this;if(c=="compile"){b.a4()}else{IG$._I54(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")}},a4:function(){var a=this,c=new IG$._I3e(),b;b=a.item.l2.call(a.item);c.init(a,{ack:"3",payload:IG$._I2d({uid:a.uid,option:"compile"},"uid;option"),mbody:b},a,a.rs_a4,null);c._l()},rs_a4:function(a){var b=this,c=IG$._I18(a,"/smsg/result/errormessage"),d;if(c){d=IG$._I24(c);d=Base64.decode(d);b.down("[name=compileres]").setValue(d)}else{b.down("[name=compileres]").setValue("Compiled Successfully")}},_t$:function(b){var a=this;switch(b){case"cmd_save":a.a3();break;case"cmd_compile":a.a3("compile");break}},initComponent:function(){var a=this;$s.apply(this,{items:[{name:"javasrc",region:"center",html:"<div class='idv-jcl-edtr'></div>",split:true,listeners:{resize:function(c,b,e,d,g,f){if(a.scriptview&&a.scripteditor){IG$.x_10._w(a.scriptview,b);IG$.x_10._h(a.scriptview,e);a.scripteditor.resize(true)}}}},{xtype:"panel",height:120,region:"south",split:true,layout:"fit",title:"Compile result",items:[{xtype:"textarea",name:"compileres",height:120,region:"south"}]}],tbar:[{iconCls:"icon-toolbar-save",name:"t_save",tooltip:IRm$.r1("L_SAVE_CONTENT"),handler:function(){this._t$("cmd_save")},scope:this},{iconCls:"icon-toolbar-saveas",name:"t_save_as",tooltip:IRm$.r1("L_SAVE_CONTENT_AS"),handler:function(){this._t$("cmd_compile")},scope:this}]});IG$._I9d.superclass.initComponent.call(this)},listeners:{afterrender:function(a){var b=this;b._IFd()}}});IG$._baN=function(a){if(a){this.p1(a)}};IG$._baN.prototype={p1:function(g){var f=this,d,e,c,b,a;IG$._I1f(f,g,"name;shape;sid;type;role","s");IG$._I1f(f,g,"x;y;w;h","i");e=IG$._I19(g,"label");f.text=(e)?IG$._I24(e):f.name;e=IG$._I19(g,"property");if(e){IG$._I1f(f,e,"dsname;dsignoreerror","s");c=IG$._I26(e);for(d=0;d<c.length;d++){f[IG$._I29(c[d])]=IG$._I24(c[d])}}e=IG$._I19(g,"comment");if(e){f.comment=IG$._I24(e)}e=IG$._I19(g,"additional_properties");if(e){f.additional_properties=[];c=IG$._I26(e);for(d=0;d<c.length;d++){f.additional_properties.push({name:IG$._I1b(c[d],"name"),value:IG$._I1b(c[d],"value")})}}e=IG$._I19(g,"states");if(e){f.states=[];c=IG$._I26(e);for(d=0;d<c.length;d++){f.states.push({name:IG$._I1b(c[d],"name")})}}e=IG$._I19(g,"precision");if(e){f.precision=IG$._I24(e)}e=IG$._I19(g,"unit");if(e){f.unit={};c=IG$._I26(e);for(d=0;d<c.length;d++){b=IG$._I1b(c[d],"name");a=IG$._I24(c[d]);f.unit[b]=a}}},c1:function(b){var d=this,e="name;shape;x;y;w;h;text;dsname;dsignoreerror;comment".split(";"),c,a;for(c=0;c<e.length;c++){d[e[c]]=b[e[c]]}if(b._cs){d._cs=[];for(c=0;c<b._cs.length;c++){d._cs.push(b._cs[c])}}if(b.additional_properties){a=b.additional_properties;d.additional_properties=[];for(c=0;c<a.length;c++){d.additional_properties.push({name:a[c].name,value:a[c].value})}}if(b.states){a=b.states;d.states=[];for(c=0;c<a.length;c++){d.states.push({name:a[c].name})}}d.precision=b.precision;if(b.unit){d.unit={};for(a in b.unit){d.unit[a]=b.unit[a]}}},paint:function(d,k){var c=this,b=c.box,e=$(".idv-flw-grp",b),a,h=d?d.visualstates:null,f=102;e.hide();e.empty();if(h&&k==1){b.width(150);e.show();a=$("<ul class='idv-visual-lst'></ul>").appendTo(e);$.each(h,function(s,o){var m=o.values,q,r,l,g,p;r=$("<li class='idv-visual-states'></li>").appendTo(a);l=$("<div class='idv-visual-area'></div>").appendTo(r);g=$("<div class='idv-visual-statname'><span id='statname'></span></div>").appendTo(l);$("#statname",g).text(o.name);if(m&&m.length){$.each(m,function(u,v){var t=$("<div class='idv-visual-graph'><div class='idv-visual-graphval'><span>-</span></div></div>").appendTo(l),w,x=""+v.barlength;if(x.indexOf(".")>-1){x=x.substring(0,x.indexOf(".")+3)}w=$(".idv-visual-graphval",t).css({width:Number(v.barlength)+"%"});$("span",w).text(x+" %");w.attr("title",x+" %");t.bind("click",function(){c.visualStateClick.call(c,d,{states:o,value:v})})})}})}else{b.width(100)}},visualStateClick:function(b,c){var a=this;a._bf.container.trigger("visual_state_click",{graphic:b,state:c})}};IG$._I99={hoverPaintStyle:{strokeStyle:"#7ec3d9"}};IG$._I9a=function(a){this.container=a};IG$._I9a.prototype={init:function(){var d=this,a=d.container,e=$(document),c;d.mwidth=0;d.mheight=0;a.empty();d.sid=0;d.a_boxes=[];d.m_boxes={};d.mainarea=c=$("<div class='idv-flw-mreg'></div>").appendTo(a);d.render=$("<div id='render'></div>").appendTo(c);d.plumb=jsPlumb.getInstance({Endpoint:["Dot",{radius:5}],HoverPaintStyle:{strokeStyle:"#42a62c",lineWidth:2},ConnectionOverlays:[["Arrow",{location:1,id:"arrow",length:14,foldback:0.8}],["Label",{label:"",id:"label"}]]});d.plumb.bind("connection",function(k,h){var n=k.connection,l=n.source,m=n.target;l=d.getBoxObject.call(d,l);m=d.getBoxObject.call(d,m);if(l&&m&&h){d.container.trigger("flow_changed",{item:{src:l.sid,tgt:m.sid},source:"link_node"})}});d.plumb.bind("connectionDetached",function(k,h){var n=k.connection,l=n.source,m=n.target;l=d.getBoxObject.call(d,l);m=d.getBoxObject.call(d,m);if(l&&m&&h){d.container.trigger("flow_changed",{item:{src:l.sid,tgt:m.sid},source:"link_detach"})}});d.plumb.bind("connectionMoved",function(o,n){var k=o.originalSourceId,h=o.newSourceId,m=o.originalTargetId,l=o.newTargetId;k=d.getBoxObject.call(d,k);h=d.getBoxObject.call(d,h);m=d.getBoxObject.call(d,m);l=d.getBoxObject.call(d,l);if(k&&h&&m&&l&&n){d.container.trigger("flow_changed",{item:{source_0:k.sid,source_1:h.sid,target_0:m.sid,target_1:l.sid},source:"move_link"})}});var b;var g=function(p){if(b){var r={x:p.pageX,y:p.pageY},m=0,l=0,n=IG$.x_10._w(d.container),h=IG$.x_10._h(d.container),v=IG$.x_10._w(d.mainarea),o=IG$.x_10._h(d.mainarea),q=b.om,k=d.container.offset(),w=q.left-k.left,u=q.top-k.top,t,s;if(v>n||o>h){m=r.x-b.x;l=r.y-b.y;s=u+l;t=w+m;if(s<(h-o)){s=h-o}else{if(s>0){s=0}}if(t<(n-v)){t=n-v}else{if(t>0){t=0}}d.mainarea.css({top:s,left:t})}}};var f=function(h){e.unbind("mousemove",g);e.unbind("mouseup",f)};c.bind({mousedown:function(h){if(h.srcElement&&h.srcElement==c[0]){b={x:h.pageX,y:h.pageY,om:d.mainarea.offset()};e.bind("mousemove",g);e.bind("mouseup",f)}},mouseup:function(h){e.unbind("mousemove",g);e.unbind("mouseup",f)}})},getID:function(a){var b=this;if(!a){a="uid_"+b.sid++}while(b.m_boxes[a]){a="uid_"+b.sid++}return a},s1:function(a){var c=this,b=c.m_boxes[a.lid];if(b&&b.statdv){b.statdv.removeClass("idv-flw-shp mec-stat-saved");b.statdv.removeClass("idv-flw-shp mec-stat-on");b.statdv.removeClass("idv-flw-shp mec-stat-err");switch(a.status){case 1:b.statdv.addClass("idv-flw-shp mec-stat-on");break;case 10:b.statdv.addClass("idv-flw-shp mec-stat-saved");break;default:b.statdv.addClass("idv-flw-shp mec-stat-err");break}}},s2:function(){var b=this,c=b.a_boxes,a;for(a=0;a<c.length;a++){if(c[a].statdv){c[a].statdv.removeClass("idv-flw-shp mec-stat-saved");c[a].statdv.removeClass("idv-flw-shp mec-stat-on");c[a].statdv.removeClass("idv-flw-shp mec-stat-err")}}},addBox:function(d,e,b){var c=this;c.a_boxes.push(d);if(IG$._I07(d.sid)==false){var c=this,a=new IG$._I3e();a.init(c,{ack:"11",payload:IG$._I2d({}),mbody:IG$._I2e({option:"newid"})},c,function(g){var h=IG$._I18(g,"/smsg/item"),f=(h?IG$._I1b(h,"uid"):null);if(f){d.sid=f;c.rs_addBox.call(c,d,e,b)}},false);a._l()}else{this.rs_addBox(d,e,b)}},rs_addBox:function(l,b,f){var g=this,a,d,m,k,c,e,h;a=$("<div class='idv-flw-shp'></div>").appendTo(g.mainarea);a.css({left:b.left,top:b.top});if(b.w&&b.h){a.width(b.w)}if(l._cs&&l._cs.length){for(e=0;e<l._cs.length;e++){a.addClass(l._cs[e])}}bg=$("#bgimg",a);IG$.x_10._w(bg,IG$.x_10._w(a));IG$.x_10._h(bg,IG$.x_10._h(a));l.box=a;l._bf=g;l.dv_dsname=$("<div class='idv-bd-dsnm'>"+(l.dsname||"")+"</div>").appendTo(a);d=$("<div class='ba_m_title_c'></div>").appendTo(a);k=$("<span class='ba_m_title' title='"+l.text+"'>"+l.text+"</span>").appendTo(d);$("<div class='mec-ep'></div>").appendTo(a);c=$("<div class='mec-rp'></div>").appendTo(a);l.statdv=$("<div class='mec-stat'></div>").appendTo(a);l.sid=l.sid||g.getID();l.__tL=k;k.bind("click",function(){g.container.trigger("boxClicked",l)});h=$("<div class='idv-flw-grp'></div>").appendTo(a).hide();g.plumb.draggable(a);g.plumb.makeSource(a,{filter:".mec-ep",anchor:"Continuous",connector:["StateMachine",{curviness:20}],connectorStyle:{strokeStyle:"#efefef",lineWidth:2},maxConnections:30,onMaxConnections:function(o,n){}});g.plumb.makeTarget(a,{dropOptions:{hoverClass:"dragHover"},anchor:"Continuous",allowLoopback:false});g.m_boxes[l.sid]=l;c.bind("click",function(){g.removeBox.call(g,l,true)});if(f){g.container.trigger("flow_changed",{item:l,source:"box_add"})}g.u1()},s4:function(d,a){var c=this,b=d.__tL;b.text(a);b.attr("title",a)},removeBox:function(b,c){var a=this;if(c==true){IG$._I55(ig$.appname,"Confirm to delete node!",function(d){if(d=="yes"){a.rs_removeBox.call(a,b)}})}else{a.rs_removeBox.call(a,b)}},rs_removeBox:function(c){var b=this,a;b.plumb.detachAllConnections(c.box);c.box.remove();for(a=0;a<b.a_boxes.length;a++){if(b.a_boxes[a].sid==c.sid){b.a_boxes.splice(a,1);break}}delete b.m_boxes[c.sid];b.u1()},u1:function(){var e=this,f=0,a=0,b=IG$.x_10._w(e.container),g=IG$.x_10._h(e.container),d,c=e.a_boxes;for(d=0;d<c.length;d++){f=Math.max(f,c[d].x+c[d].w);a=Math.max(a,c[d].y+c[d].h)}f=Math.max(f+20,b);a=Math.max(a+20,g);IG$.x_10._w(e.mainarea,f);IG$.x_10._h(e.mainarea,a)},addLink:function(f){var d=this,c=d.m_boxes[f.from]?d.m_boxes[f.from].box:null,b=d.m_boxes[f.to]?d.m_boxes[f.to].box:null,e="rgb(189,11,11)";if(!c||!b){return}var a=d.plumb.connect({source:c,target:b,paintStyle:{lineWidth:8,strokeStyle:e,outlineColor:"#666",outlineWidth:1,dashstyle:null},detachable:true,hoverPaintStyle:IG$._I99.hoverPaintStyle,anchors:[[0.3,1,0,1],"TopCenter"],overlays:[["DoubleLine",{fillStyle:"#09098e",width:15,length:15}]],endpoint:["Dot",{radius:5}],endpointStyles:{fillStyle:"#456"}});a.ptr_link=f},L1:function(d){var c=this,b,e,a;c.itemobj=d;c.init();$.each(d.nodes,function(f,g){c.addBox(g,{left:g.x,top:g.y,w:g.w,h:g.h})});for(a=0;a<d.links.length;a++){e=d.links[a];c.addLink(e)}},m1:function(c,b,e){var a,d=e.split(";");for(a=0;a<d.length;a++){if(b[d[a]]){c.push("<"+d[a]+"><![CDATA["+(b[d[a]]||"")+"]]></"+d[a]+">")}}},l2:function(f,t){var v=this,c=[],q,n,h,e,s,w,u,g,m=v.mainarea.offset();c.push("<nodes");if(f&&t){c.push(" type='"+f+"' typename='"+t+"'")}c.push(">");for(q=0;q<v.a_boxes.length;q++){w=v.a_boxes[q];e=w.box.offset();s={name:w.name,shape:w.shape||"",x:e.left-m.left,y:e.top-m.top,w:IG$.x_10._w(w.box),h:IG$.x_10._h(w.box),sid:w.sid,text:w.text,dsname:w.dsname,dsdesc:w.dsdesc,dstype:w.dstype,dsignoreerror:w.dsignoreerror,dsmapper:w.dsmapper,dsreducer:w.dsreducer,dstname:w.dstname,dsscript:w.dsscript,dsfname:w.dsfname,dsskipexist:w.dsskipexist,doctmpl:w.doctmpl,type:w.type,role:w.role,additional_properties:w.additional_properties,states:w.states,precision:w.precision,unit:w.unit,comment:w.comment};c.push("<node"+IG$._I20(s,"name;shape;sid;x;y;w;h;type;role","s")+">");c.push("<label><![CDATA["+s.text+"]]></label>");if(s.comment){c.push("<comment><![CDATA["+s.comment+"]]></comment>")}c.push("<property");c.push(IG$._I20(w,"dsname;dsignoreerror","s"));c.push(">");switch(s.name){case"datasource":v.m1(c,w,"dsdesc;dstype;dsmapper;dsreducer;dsfname;dstname;dsskipexist");break;case"shell":v.m1(c,w,"dsdesc;dsscript");break;case"hive":v.m1(c,w,"dsdesc;dsscript");break;case"mongoreduce":v.m1(c,w,"dsdesc;rowregex;rowsample;mrtype;m_delim;cfields");break;case"mongodoc":v.m1(c,w,"dsdesc;doctmpl;mrnode;mrdb;mrcol;mrdocname;mrsmode");break;case"mapreduce":v.m1(c,w,"dsdesc;dsmapper;dsreducer;confparams");break;case"output":v.m1(c,w,"dsdesc;dsfname;dscnames;dsruntype;dsdelim;dsdelimval;dstcube;dstcubeuid;dsmeasuredelim;dsmeasuredelimval;dsmname;dscsdatause;dscsdatafile");break;default:v.m1(c,w,"dsdesc");break}c.push("</property>");h=s.additional_properties;if(h&&h.length){c.push("<additional_properties>");for(n=0;n<h.length;n++){c.push("<property name='"+h[n].name+"' value='"+h[n].value+"'/>")}c.push("</additional_properties>")}h=s.states;if(h&&h.length){c.push("<states>");for(n=0;n<h.length;n++){c.push("<state name='"+h[n].name+"'/>")}c.push("</states>")}if(s.precision){c.push("<precision>"+s.precision+"</precision>")}if(s.unit){c.push("<unit>");for(n in s.unit){c.push("<property name='"+n+"'><![CDATA["+s.unit[n]+"]]></property>")}c.push("</unit>")}c.push("</node>")}c.push("</nodes>");var b=v.plumb.getConnections(),a,k;c.push("<links>");if(b&&b.length){for(q=0;q<b.length;q++){u=b[q];g=u.ptr_link;a=u.source;k=u.target;a=v.getBoxObject(a);k=v.getBoxObject(k);if(a&&k){var d=u.getPaintStyle();c.push("<link");c.push(IG$._I20({from:a.sid,to:k.sid,dashstyle:(d.dashstyle)?true:false,directed:g?g.directed:"T"},"from;to;dashstyle;directed","s"));c.push(">");if(g&&g.potential){c.push(g.potential.p2())}if(g&&g.revealing_condition){c.push("<revealing_condition>");if(g.revealing_condition.states){c.push("<states>");for(n=0;n<g.revealing_condition.states.length;n++){c.push("<state name='"+g.revealing_condition.states[n].name+"'></state>")}c.push("</states>")}c.push("</revealing_condition>")}c.push("</link>")}}}c.push("</links>");return c.join("")},getBoxObject:function(h){var g=this,d,f,c=g.a_boxes,b=typeof(h)=="string"?0:1,a=b?$(h).attr("id"):null,e;for(d=0;d<c.length;d++){if(!b&&c[d].sid==h){f=c[d];break}else{if(b){e=c[d].box.attr("id");if(e==a){f=c[d];break}}}}return f}};IG$._IB7=$s.extend($s.window,{modal:true,layout:"fit",closable:false,resizable:false,width:500,height:500,callback:null,_IFd:function(){},L1:function(){var d=this,a=this,c=new IG$._I3e(),b=[];b.push("<smsg><item uid='"+(d.uid||"")+"'>");b.push("<command><![CDATA["+Base64.encode(d.down("[name=txtcommand]").getValue())+"]]></command>");b.push("</item></smsg>");c.init(a,{ack:"3",payload:IG$._I2d({uid:a.uid,option:"command"},"uid;option"),mbody:b.join("")},a,a.rs_L1,null);c._l()},rs_L1:function(a){var b=this,d=IG$._I18(a,"/smsg/errormessage"),e,c;if(d){e=IG$._I24(d);e=Base64.decode(e);b.down("[name=txtconsole]").setValue(e)}else{d=IG$._I18(a,"/smsg/message");if(d){c=IG$._I24(d);c=Base64.decode(c);b.down("[name=txtconsole]").setValue(c)}}},initComponent:function(){var a=this;a.title=IRm$.r1("L_MAKEITEM");$s.apply(this,{defaults:{bodyStyle:"padding:10px"},items:[{xtype:"panel",layout:"border",autoHeight:true,defaults:{anchor:"100%"},items:[{xtype:"textarea",height:300,region:"center",name:"txtcommand"},{xtype:"panel",height:200,region:"south",title:"Console Output",layout:"fit",items:[{xtype:"textarea",name:"txtconsole"}]}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this.L1()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}]});IG$._IB7.superclass.initComponent.call(this)},listeners:{afterrender:function(a){var b=this;b._IFd()}}});IG$._IB8=function(a,b){var c=this;c.bf=b;a&&c.L1(a)};IG$._IB8.prototype={L1:function(g){var l=this,f,a,k,d,c,e,b,m,h;l.nodes=[];l.links=[];f=IG$._I18(g,"/smsg/item");if(f){l.item=IG$._I1c(f);a=IG$._I19(f,"nodes");if(a){k=IG$._I26(a);for(d=0;d<k.length;d++){b=new IG$._baN(k[d]);l.nodes.push(b)}}a=IG$._I19(f,"links");if(a){k=IG$._I26(a);for(d=0;d<k.length;d++){h={};IG$._I1f(h,k[d],"from;to;dashstyle","s");l.links.push(h)}}}l.bf.L1.call(l.bf,l)},L2:function(){var b=this,a=[];a.push("<smsg><item");b.item&&a.push(IG$._I20(b.item,"uid;nodepath;name","s"));a.push(">");a.push(b.bf.l2.call(b.bf));a.push("</item></smsg>");return a.join("")}};IG$._IB9=$s.extend($s.panel,{closable:true,layout:{type:"vbox",align:"stretch"},bodyPadding:0,sgap:1000,_IFd:function(){var g=this,d=g.topmenu,h=g.mainarea,c,b,f,a=[],k=g.__m,e;a=[{shape:"rect",name:"datasource",text:"Data source"},{shape:"ellipse",name:"mapreduce",text:"Map/Reduce",hidden:k},{shape:"ellipse",name:"mongoreduce",text:"Data Processing",hidden:!k},{shape:"ellipse",name:"mongodoc",text:"Update Document",hidden:!k},{shape:"ellipse",name:"hive",text:"Hive Job",hidden:k},{shape:"triangle",name:"shell",text:"Shell Command",hidden:k},{shape:"triangle",name:"dataprocess",text:"Data processing",hidden:k},{shape:"diamond",name:"output",text:"Output"}];b=g.farea=$("<div class='idv-flw-reg'></div>").appendTo(h);f=g.bf=new IG$._I9a(b);f.init.call(f);d.empty();c=$("<div class='idv-flw-mnu'></div>").appendTo(d);g.l1(c,a);e=new IG$._I3d(g,g.l4);f.container.bind("boxClicked",function(m,n){var o,l=g.down("[name=moption]");l.removeAll();switch(n.name){case"datasource":o=new IG$.BC$ds({job:n,_p:g,__m:k,callback:e});break;case"mapreduce":o=new IG$.BC$mr({job:n,_p:g,__m:k,callback:e});break;case"mongoreduce":o=new IG$.BC$mr1({job:n,_p:g,__m:k,callback:e});break;case"mongodoc":o=new IG$.BC$mr2({job:n,_p:g,__m:k,callback:e});break;case"shell":o=new BC$sc({job:n,_p:g,__m:k,callback:e});break;case"hive":o=new IG$.BC$hj({job:n,_p:g,__m:k,callback:e});break;case"output":o=new IG$.BC$op({job:n,_p:g,__m:k,callback:e});break}if(o){l.expand();l.add(o);o.on("close_dlg",function(p){l.remove(o);l.collapse()})}});if(g.uid){g.M1()}else{g.rs_M1(null)}},l4:function(a){a.dv_dsname.text(a.dsname)},M1:function(){var b=this,a=new IG$._I3e();if(b.uid){a.init(b,{ack:"5",payload:IG$._I2d({uid:b.uid}),mbody:IG$._I2e({option:"diagnostics"})},b,b.rs_M1,false);a._l()}else{b.itemobj=new IG$._IB8(null,b.bf)}},rs_M1:function(a){var b=this;b.itemobj=new IG$._IB8(a,b.bf)},m2:function(n,f){var l=this,h=l.bf,c=h.a_boxes,g,k,b=h.plumb.getConnections(),a,e,m=[],d=[];for(g=0;g<c.length;g++){if(c[g].sid==n.job.sid){k=c[g];break}}if(b&&b.length){for(g=0;g<b.length;g++){a=b[g].source;e=b[g].target;a=h.getBoxObject.call(h,a);e=h.getBoxObject.call(h,e);m.push({src:a,tgt:e});if(e&&e.sid==k.sid){if(a&&(f&&a.name==f||!f)){d.push(a)}}}}return d},l1:function(c,e){var d=this,a,f,h=10,g=h,b=d.bf;c.empty();$.each(e,function(p,o){var l,k;if(!o.hidden){var m=new IG$._baN();m.c1.call(m,o);l=$("<div class='idv-flw-shp-a'><div>"+m.text+"</div></div>").appendTo(c);l.css({left:g});m.div=l;g+=h+(IG$.x_10._w(l)||120);l.draggable({opacity:0.7,helper:"clone",stop:function(t,u){var v=u.position,q=d.farea,s=$(q.parent()).offset(),n=q.offset(),w=IG$.x_10._w(q),r=IG$.x_10._h(q);n.top-=s.top;n.left-=s.left;if(n.left<v.left&&v.left<n.left+w&&n.top<v.top&&v.top<n.top+r){b.addBox.call(b,m,v)}}})}})},_t$:function(c){var b=this;switch(c){case"cmd_save":if(!b.uid){b.fV7(false)}else{b.fV6(false)}break;case"cmd_saveas":b.fV7(false);break;case"cmd_run":b.lll();break;case"cmd_favorites":if(this.uid){var a=new IG$._I3e();a.init(b,{ack:"11",payload:IG$._I2d({uid:b.uid}),mbody:IG$._I2e({option:"addfavorites"})},b,b.rs_i1_2,null,null);a._l()}else{IG$._I54(ig$.appname,IRm$.r1("M_ERR_NSAVE"),null,b,1,"error")}break;case"cmd_schedule":if(b.uid){var e=[{ack:"3",payload:IG$._I2d({uid:b.uid,option:"execute"},"uid;option"),mbody:b.itemobj.L2.call(b.itemobj),jobkey:"0"}];IG$._I50(b,b.uid,b.itemtype,e,null)}break;case"cmd_log_view":if(this.uid){var d=new IG$._Ia0({uid:b.uid});IG$._I_5(this,d)}else{IG$._I54(ig$.appname,IRm$.r1("M_ERR_NSAVE"),null,b,1,"error")}break}},rs_i1_2:function(a){IG$._I54(ig$.appname,IRm$.r1("M_SAVED_FAV"),null,null,0,"success")},lll:function(){var a=this,d=a,c=new IG$._I3e(),b=a.itemobj.L2.call(a.itemobj);c.showerror=false;c.init(a,{ack:"3",payload:IG$._I2d({uid:d.uid,option:"execute",type:d.itemtype},"uid;option;type"),mbody:b},a,a.rs_lll,a.rs_lllE);c._l()},rs_lll:function(a){var b=this,c=IG$._I18(a,"/smsg/result");if(c){b.sid=IG$._I1b(c,"sid");b.ll4()}},ll4:function(){var a=this;if(a.stimer){clearTimeout(a.stimer)}a.stimer=setTimeout(function(){a.ll3.call(a)},a.sgap)},rs_lllE:function(a){var c=this,e=true,d=IG$._I27(a);if(d=="0x28a0"){e=false;var f=IG$._I18(a,"/smsg"),b=IG$._I24(f);if(b){IG$._I55(ig$.appname,"Already workflow is running on server. Would you like to stop service?",function(h){if(h=="yes"){var g=new IG$._I3e();g.init(c,{ack:"3",payload:IG$._I2d({uid:c.uid,sid:b,option:"cancelWorkflow"},"uid;sid;option"),mbody:IG$._I2e()},c,c.rs_ll2,null);g._l()}},c,c)}}return e},rs_ll2:function(a){var b=this;b.lll()},fV6:function(c){var a=this,b=a.itemobj.L2.call(a.itemobj);var d=new IG$._I3e();d.init(a,{ack:"31",payload:IG$._I2d({uid:a.uid}),mbody:b},a,a.rs_fV6,null,[c]);d._l()},rs_fV6:function(a,b){var d=this,c=(b?b[0]:false);if(c==true){d.close()}else{d._ILb_=false;IG$._I54(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")}},fV7:function(a){var b=this,c=new IG$._I96({mode:"newitem",initpath:b.nodepath,callback:new IG$._I3d(b,b.fV8,a)});IG$._I_5(b,c)},fV8:function(e,c){var a=this,b=a.itemobj.L2.call(a.itemobj),d=new IG$._I3e();d.init(a,{ack:"31",payload:"<smsg><item address='"+e.nodepath+"/"+e.name+"' name='"+e.name+"' type='"+(this.itemtype?this.itemtype:"BigData")+"' pid='"+e.uid+"' description=''/></smsg>",mbody:b},a,a._IO5,a._IO6,[e.name,c,e.nodepath,e.uid,b]);d.showerror=false;d._l()},_IO5:function(a,b){var c=this,e=c.itemobj,d;d=IG$._I18(a,"/smsg/item");if(d){e.item=IG$._I1c(d);c.setTitle(e.item.name);c.uid=e.item.uid}},_IO6:function(e,c){var b=this,g=c[0],k=c[1],d=c[2],h=c[3],f=c[4],a=IG$._I27(e);if(a=="0x12e0"){IG$._I55(ig$.appname,g+" already exist on the server. Would you overwrite existing item with this copy?",function(m){if(m=="yes"){var l=new IG$._I3e();l.init(b,{ack:"31",payload:"<smsg><item address='"+d+"/"+g+"' name='"+g+"' type='"+(this.itemtype?this.itemtype:"Report")+"' pid='"+h+"' description='' overwrite='T'/></smsg>",mbody:f},b,b._IO5,null,[g,k,d]);l._l()}},b,b)}else{IG$._I51(e,b)}},ll3:function(){var a=this,b=new IG$._I3e();b.init(a,{ack:"3",payload:IG$._I2d({uid:a.uid,sid:a.sid,option:"jobstatus"},"uid;sid;option"),mbody:IG$._I2e()},a,a.rs_ll3,null);b._l()},rs_ll3:function(a){var f=this,h=IG$._I18(a,"/smsg/item"),g,d,b,c={},e;if(h){b=IG$._I1b(h,"status");b=parseInt(b);g=IG$._I26(h);for(d=0;d<g.length;d++){e=IG$._I1c(g[d]);e.status=parseInt(e.status);c[e.lid]=e;f.bf.s1.call(f.bf,e)}if(b==1){f.ll4()}}},initComponent:function(){var a=this;a.__m=a.itemtype=="BigData"?0:1;$s.apply(this,{items:[{xtype:"container",name:"topmenu",height:40,border:1,style:{borderColor:"#efefef",borderStyle:"solid"}},{xtype:"container",flex:1,layout:"border",items:[{xtype:"container",name:"mainarea",region:"center",flex:1},{xtype:"panel",name:"moption",title:"Properties",split:true,collapsible:true,collapsed:true,collapseMode:"mini",region:"east",width:420,layout:"fit",items:[{xtype:"displayfield",value:"Click Item to set properties"}]}]}],tbar:[{iconCls:"icon-toolbar-save",name:"t_save",tooltip:IRm$.r1("L_SAVE_CONTENT"),handler:function(){this._t$("cmd_save")},scope:this},{iconCls:"icon-toolbar-saveas",name:"t_save_as",tooltip:IRm$.r1("L_SAVE_CONTENTAS"),handler:function(){this._t$("cmd_saveas")},scope:this},{iconCls:"icon-toolbar-runreport",name:"t_run",tooltip:IRm$.r1("L_RUN"),handler:function(){this._t$("cmd_run")},scope:this},{iconCls:"icon-toolbar-logview",name:"t_log",tooltip:IRm$.r1("L_LOG_VIEW"),handler:function(){this._t$("cmd_log_view")},scope:this},"->",{iconCls:"icon-toolbar-schedule",cls:"ig_r_sch",tooltip:IRm$.r1("B_SCHEDULE"),hidden:ig$.features&&!ig$.features.enable_scheduler?true:false,handler:function(){this._t$.call(this,"cmd_schedule")},scope:this},{iconCls:"icon-toolbar-favorites",tooltip:IRm$.r1("B_FAVORITES"),handler:function(){this._t$.call(this,"cmd_favorites")},scope:this}]});IG$._IB9.superclass.initComponent.call(this)},listeners:{afterrender:function(a){var b=this;b.topmenu=$(b.down("[name=topmenu]").el.dom);b.mainarea=$(b.down("[name=mainarea]").el.dom);b._IFd()}}});IG$.bA_5=$s.extend($s.window,{modal:true,isWindow:true,layout:"fit",closable:false,resizable:true,width:600,height:550,_r:{},_IFe:function(){var b=this,a=b.result_xml,d=a?IG$._I18(a,"/smsg/cost_effectiveness_results"):null,c;if(d){c=IG$._I26(d);$.each(c,function(e,f){b.d1.call(b,f)})}},d1:function(d){var c=this,a=IG$._I29(d),b;switch(a){case"tornado_spider":b=IG$._I18(d,"tornado");b&&c.d2(b);b=IG$._I18(d,"spider_chart");if(c._r.p_spider==0){b&&c.d3(b,"p_spider")}else{c._r.p_spider=b}break;case"plot":b=IG$._I18(d,"plot_chart");if(b){if(c._r.p_plot==0){b&&c.d3(b,"p_plot")}else{c._r.p_plot=b}}break}},d2:function(f){var n=this,d=n.down("[name=p_tornado]"),a=$(d.el.dom),c,k=[],p,m={chart:{type:"bar"},title:{text:"Tornado"},xAxis:[{reversed:false},{opposite:true,reversed:false,linkedTo:0,labels:{step:1}}],yAxis:{labels:{formatter:function(){return Math.abs(this.value)}}},plotOptions:{series:{stacking:"normal"}},series:[]},o,b,g,r=[],q=[],t,l,h;a.empty();c=$("<div></div>").appendTo(a);c.css({width:a.width(),height:a.height()});k=IG$._I1a(f,"category_key");k=k?k.split("\t"):[];m.xAxis[0].categories=k;m.xAxis[1].categories=k;m.chart.renderTo=c[0];o=IG$._I18(f,"reference_markers/reference");h=IG$._I1b(o,"value");h=Number(h);o=IG$._I18(f,"bars");b=IG$._I26(o);for(g=0;g<b.length;g++){t=IG$._I1b(b[g],"starts");l=IG$._I1b(b[g],"ends");r.push(Number(t)-h);q.push(Number(l)-h)}m.series.push({name:"Starts",data:r});m.series.push({name:"Ends",data:q});p=new Highcharts.Chart(m)},d3:function(d,e){var l=this,b=l.down("[name="+e+"]"),h=$(b.el.dom),c,g=[],p,k={chart:{type:"line"},title:{text:"Spider"},xAxis:{},yAxis:{labels:{formatter:function(){return Math.abs(this.value)}}},legend:{layout:"vertical",align:"right",verticalAlign:"middle",borderWidth:0},series:[]},n,a,f,q,o,m;h.empty();c=$("<div></div>").appendTo(h);c.css({width:h.width(),height:h.height()});n=IG$._I18(d,"series");if(n){a=IG$._I26(n);for(f=0;f<a.length;f++){q={name:IG$._I1b(a[f],"name"),data:[]};if(f==0){o=IG$._I1a(a[f],"xvalues");g=o.split("\t")}m=IG$._I1a(a[f],"yvalues");q.data=m.split("\t");for(j=0;j<q.data.length;j++){q.data[j]=Number(q.data[j])}k.series.push(q)}}k.xAxis.categories=g;k.chart.renderTo=c[0];n=IG$._I18(d,"reference_markers/reference");if(n){rval=IG$._I1b(n,"value");rval=Number(rval)}p=new Highcharts.Chart(k)},initComponent:function(){var a=this;a.title=IRm$.r1("T_TORSP_RS");$s.apply(this,{items:[{xtype:"panel",bodyPadding:10,layout:"fit",items:[{xtype:"tabpanel",defaults:{deferredRender:false},flex:1,items:[{xtype:"panel",title:"Tornado",layout:"fit",name:"p_tornado"},{xtype:"panel",title:"Spider",layout:"fit",name:"p_spider",listeners:{afterrender:function(b){if(a._r.p_spider){a.d3.call(a,a._r.p_spider,"p_spider")}a._r.p_spider=0}}},{xtype:"panel",title:"Plot",layout:"fit",name:"p_plot",listeners:{afterrender:function(b){if(a._r.p_plot){a.d3.call(a,a._r.p_plot,"p_plot")}a._r.p_plot=0}}}]}]}],buttons:["->",{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(c){var b=this;b._IFe()}}});IG$.bA_5.superclass.initComponent.apply(this,arguments)}});IG$.bA_4=$s.extend($s.window,{modal:true,isWindow:true,region:"center",layout:{type:"fit",align:"stretch"},closable:false,resizable:false,width:600,height:550,callback:null,atype:0,_IFe:function(){var b=this,d=ig$.b$Am,a=d.deterministic_axis_variation_type,c=b.down("[name=p3]");c.store.loadData(d.analysis_types);b.down("[name=p4]").store.loadData(a);b.down("[name=p5]").store.loadData(a);b.down("[name=p6]").store.loadData(d.scope_types);c.setValue("TORNADO_SPIDER")},_IFf:function(){var d=this,e=d.itemobj,b=d.atype,f=new IG$._I3e(),a=d.down("[name=p4]"),c=["<smsg><info"];c.push(" analysis_type='"+d.down("[name=p3]").getValue()+"'");if(b==1){c.push(" scope_type='"+d.down("[name=pb]").getValue()+"'");c.push(" decision='"+d.down("[name=pc]").getValue()+"'")}else{c.push(" scope_type='"+d.down("[name=p6]").getValue()+"'");c.push(" decision='"+d.down("[name=p7]").getValue()+"'")}c.push(">");c.push("<axis>");c.push("<horizontal_axis_parameter axitype='"+a.getValue()+"'>");c.push("</horizontal_axis_parameter>");c.push("</axis>");c.push("</info></smsg>");f.init(d,{ack:"77",payload:IG$._I2d({uid:d.uid,instanceid:e.instanceid,action:"cost_effectiveness",method:(b==0?"sensitivity":"determistic")},"uid;action;instanceid;method"),mbody:c.join("")},d,function(g){var h=new IG$.bA_5({result_xml:g});h.show()});f._l()},s1:function(d){var e=this,f=e.down("[name=p1]"),c=e.down("[name=p6]"),a=e.down("[name=p4]"),b="POPP";decision=e.down("[name=p7]"),p1v=false,decisionV=false;switch(d){case"TORNADO_SPIDER":c.setValue("GLOBAL");break;case"MAP":p1v=true;decisionV=true;break;case"PLOT":decisionV=true;break}f.setVisible(p1v);decision.setVisible(decisionV);a.setValue(b)},initComponent:function(){var a=this;a.title=IRm$.r1("T_COST_EFF");$s.apply(this,{defaults:{bodyStyle:"padding:0px"},items:[{xtype:"panel",layout:"fit",border:0,defaults:{bodyPadding:5},items:[{xtype:"panel",layout:"anchor",autoScroll:true,hidden:a.atype!=0,items:[{xtype:"fieldcontainer",layout:"anchor",items:[{xtype:"combobox",fieldLabel:"Analysis type",queryMode:"local",name:"p3",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]},listeners:{change:function(b){var c=b.getValue();this.s1(c)},scope:this}},{xtype:"fieldcontainer",fieldLabel:"Points per parameter",name:"p2",items:[{xtype:"numberfield",width:40}]}]},{xtype:"panel",layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",title:"Parameters",height:200,layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",name:"p0",flex:1,columns:[{text:"Name",flex:1}]},{xtype:"gridpanel",name:"p1",hidden:true,flex:1,columns:[{text:"Name",flex:1}]}]},{xtype:"fieldset",title:"Options",layout:"anchor",flex:1,bodyPadding:5,items:[{xtype:"fieldcontainer",fieldLabel:"Horizontal axis parameter",layout:"hbox",items:[{xtype:"combobox",queryMode:"local",name:"p4",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]}},{xtype:"numberfield",width:60,name:"p4a",labelWidth:20,fieldLabel:"%"}]},{xtype:"fieldcontainer",fieldLabel:"Vertical axis parameter",layout:"hbox",items:[{xtype:"combobox",queryMode:"local",name:"p5",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]}},{xtype:"numberfield",width:60,name:"p5a",labelWidth:20,fieldLabel:"%"}]},{xtype:"combobox",queryMode:"local",fieldLabel:"Scope",name:"p6",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]}},{xtype:"combobox",queryMode:"local",fieldLabel:"Decision",name:"p7",hidden:true,displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"Percentage of the 2nd order probability"},{name:"Percentage over reference value"},{name:"Ratio over reference value"},{name:"User defined interval"}]}},{xtype:"combobox",queryMode:"local",name:"p8",fieldLabel:"When a probability parameter is above 1",labelWidth:220,displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"Ignore case"},{name:"Throw error message",value:"dbc"}]}}]},{xtype:"fieldset",title:"Scenario",layout:"anchor",items:[{xtype:"combobox",queryMode:"local",fieldLabel:"Do test?",name:"p9",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"Yes"},{name:"No",value:"dbc"}]}},{xtype:"combobox",queryMode:"local",name:"pa",fieldLabel:"Result of test",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"not done"},{name:"done"}]}}]}]}]},{xtype:"panel",layout:"anchor",hidden:a.atype!=1,items:[{xtype:"combobox",queryMode:"local",name:"pb",fieldLabel:"Scope",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"Global"},{name:"One decision"}]}},{xtype:"combobox",queryMode:"local",name:"pc",fieldLabel:"Decision",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"Therapy"},{name:"Percentage over reference value"},{name:"Ratio over reference value"},{name:"User defined interval"}]}},{xtype:"fieldset",layout:"anchor",title:"Scenario",items:[{xtype:"combobox",queryMode:"local",name:"pd",fieldLabel:"Do test?",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"yes"},{name:"no"}]}},{xtype:"combobox",queryMode:"local",name:"pe",fieldLabel:"Result of test",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"not done"},{name:"no"}]}}]}]}]}],buttons:["->",{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(c){var b=this;b._IFe()}}});IG$.bA_4.superclass.initComponent.apply(this,arguments)}});IG$.bA_3=$s.extend($s.window,{modal:true,isWindow:true,region:"center",layout:{type:"fit",align:"stretch"},closable:false,resizable:false,width:400,autoHeight:true,callback:null,_IFe:function(){var a=this;a.down("[name=filetype]").setValue("csv")},_IFf:function(){var c=this,a=c.down("[name=num_cases]"),b=c.down("[name=filetype]");c.callback&&c.callback.execute({num_cases:a.getValue(),filetype:b.getValue()});c.close()},initComponent:function(){var a=this;a.title=IRm$.r1("T_DB_GEN");$s.apply(this,{defaults:{bodyStyle:"padding:0px"},items:[{xtype:"panel",layout:"fit",border:0,defaults:{bodyPadding:10},items:[{xtype:"panel",layout:"anchor",items:[{xtype:"combobox",fieldLabel:"File Type",queryMode:"local",name:"filetype",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"CSV File",value:"csv"},{name:"Elvira DB File",value:"dbc"},{name:"Excel File",value:"xls"},{name:"Weka DB File",value:"arff"}]}},{xtype:"numberfield",name:"num_cases",fieldLabel:"Number of cases",minValue:100,maxValue:100000,value:5000,step:10}]}]}],buttons:["->",{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(c){var b=this;b._IFe()}}});IG$.bA_3.superclass.initComponent.apply(this,arguments)}});IG$.bA_2=$s.extend($s.window,{modal:true,isWindow:true,region:"center",layout:{type:"fit",align:"stretch"},closable:false,resizable:false,width:500,height:450,callback:null,_IFe:function(){var b=this,c=b.jobid,a=new IG$._I3e();b.lP();if(c){b.setLoading(true);a.init(b,{ack:"20",payload:"<smsg><item uid='"+b.uid+"' jobid='"+c+"' type='csv' option='instanceload' appuse='T'/></smsg>",mbody:"<smsg></smsg>"},b,function(h){var m=IG$._I18(h,"/smsg/info"),e=m?IG$._I18(m,"headers"):null,n,k=b.down("[name=sheader]"),l=k.getSelectionModel(),g,f=[],d;if(m){b.__pfile=IG$._I1b(m,"downloadurl")}if(e){n=IG$._I26(e);for(g=0;g<n.length;g++){d={name:IG$._I24(n[g]),selected:true};f.push(d)}}k.store.loadData(f)});a._l()}},lP:function(){var b=this,a;if(!ig$.b$Am){a=new IG$._I3e();a.init(b,{ack:"77",payload:IG$._I2d({action:"get_var"},"action"),mbody:IG$._I2e({})},b,function(k){var m=this,h={},c,l,d,o,e,n,g,f;c=IG$._I18(k,"/smsg");if(c){l=IG$._I26(c);for(g=0;g<l.length;g++){o=IG$._I29(l[g]);e=h[o]=[];d=IG$._I26(l[g]);for(f=0;f<d.length;f++){n={value:IG$._I1b(d[f],"value")};n.name=n.name||n.value;e.push(n)}}ig$.b$Am=h}m._a1()},false);a._l()}else{b._a1()}},_a1:function(){var c=this,d=ig$.b$Am,a=c.down("[name=algorithm]"),b=c.down("[name=tmissing]");a.store.loadData(d.learn_algorithms);a.setValue(d.learn_algorithms[0].value);b.store.loadData(d.missing_names);b.setValue(d.missing_names[0].value)},_IFf:function(){var l=this,m=l.down("[name=sheader]"),h=m.store,f,k,g=l.down("[name=modelnet_gr]"),a=g.getValue().modelnet,c=null,d="BayesNet",e=IG$._I7d,b;if(!l.__pfile){return}if(a!="new_model"){}b=l.__learn_opt={pfile:l.__pfile,algorithm:l.down("[name=algorithm]").getValue(),alg_ind_test:l.down("[name=m_pc1]").getValue(),alg_metric:l.down("[name=m_pc2]").getValue(),alg_sig_level:l.down("[name=m_pc3]").getValue(),alg_alpha:l.down("[name=m_pc4]").getValue(),learn_mode:l.down("[name=learn_mode_gr]").getValue().learn_mode,model_net:a,use_model_net:l.down("[name=use_model_net]").getValue()?"T":"F",use_start_learn:l.down("[name=use_start_learn]").getValue()?"T":"F",allow_link_addition:l.down("[name=_a1]").getValue()?"T":"F",allow_link_removal:l.down("[name=_a2]").getValue()?"T":"F",allow_link_inversion:l.down("[name=_a3]").getValue()?"T":"F",descretize:l.down("[name=_a4]").getValue(),treat_missing_val:l.down("[name=tmissing]").getValue(),use_same_num_interval:l.down("[name=_a5]").getValue()?"T":"F",same_num_interval:l.down("[name=_a6]").getValue(),variable_use:l.down("[name=var_use_gr]").getValue().var_use,selected_header:[]};for(k=0;k<h.data.items.length;k++){f=h.data.items[k];b.selected_header.push({selected:f.get("selected")?"T":"F",name:f.get("name"),missing_value:f.get("missing_values"),discretization:f.get("discretization"),num_of_interval:f.get("num_of_interval")})}e&&e.m1$7.call(e,c,d.toLowerCase(),d,null,null,true,null,{__learn_opt:b});l.callback&&l.callback.execute(b);l.close()},initComponent:function(){var b=this,a=b.jobid?true:false;b.title=IRm$.r1("T_ML_LEARN");Ext.apply(this,{defaults:{bodyStyle:"padding:0px"},items:[{xtype:"panel",layout:"fit",border:0,defaults:{bodyPadding:5},items:[{xtype:"tabpanel",deferredRender:false,items:[{xtype:"panel",title:"General",layout:"anchor",autoScroll:true,items:[{xtype:"fieldset",title:"Database",layout:"anchor",items:[{xtype:"fieldcontainer",fieldLabel:"Database",layout:"anchor",items:[{xtype:"form",anchor:"100%",name:"mform",border:0,layout:"hbox",items:[{xtype:"filefield",name:"photo",hidden:a,allowBlank:false,msgTarget:"side",width:220,buttonText:"Select File..."},{xtype:"textfield",hidden:!a,disabled:true,name:"db_file",value:b.fname||""},{xtype:"button",text:"Upload",hidden:a,handler:function(){var d=this,c=d.down("[name=mform]");if(c.getForm().isValid()){c.getForm().submit({url:ig$.servlet,waitMsg:"Uploading your data file",success:function(e,h){IG$._I54("Success","Processed file on the server",null,null,0,"success");var g=IG$._I18(e.errorReader.xmlData,"/smsg/Result"),f=IG$._I1b(g,"uid");d.__pfile=f}})}},scope:this}]}]}]},{xtype:"fieldset",title:"Algorithm",layout:"anchor",items:[{xtype:"combobox",fieldLabel:"Algorithm",name:"algorithm",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]},listeners:{change:function(e,k,o,n){var m=this,d=m.down("[name=m_p1]"),h=m.down("[name=m_pc1]"),g=m.down("[name=m_pc2]"),f=m.down("[name=m_pc1]"),l=k=="PC";d.setTitle(k+" algorithm: Options");d.show();h.setVisible(l);g.setVisible(!l);f.setVisible(l)},scope:this}},{xtype:"textarea",anchor:"100%",height:60},{xtype:"fieldset",name:"m_p1",title:"Algorithm: Options",layout:"anchor",items:[{xtype:"combobox",fieldLabel:"Independence test",name:"m_pc1",hidden:true,queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"Cross entropy",value:""}]}},{xtype:"combobox",fieldLabel:"Metric",name:"m_pc2",hidden:true,queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"K2",value:""},{name:"Bayesian",value:""},{name:"BD",value:""},{name:"MDLM",value:""},{name:"Entropy",value:""},{name:"ALC",value:""}]}},{xtype:"numberfield",name:"m_pc3",hidden:true,fieldLabel:"Significance level"},{xtype:"numberfield",name:"m_pc4",fieldLabel:"Alpha parameter"},{xtype:"displayfield",value:"(Laplace-like correction)"}]}]},{xtype:"fieldset",title:"Learning type",items:[{xtype:"radiogroup",columns:1,name:"learn_mode_gr",vertical:true,items:[{boxLabel:"Interactive learning",name:"learn_mode",inputValue:"interactive"},{boxLabel:"Automatic Learning",name:"learn_mode",inputValue:"automatic",checked:true}]}]}]},{xtype:"panel",title:"Model network",layout:"anchor",items:[{xtype:"fieldset",title:"Choose Model Net",items:[{xtype:"radiogroup",name:"modelnet_gr",columns:1,vertical:true,items:[{boxLabel:"Make new model network",name:"modelnet",checked:true,inputValue:"new_model"},{boxLabel:"Select model network",name:"modelnet",inputValue:"modelnet"}]}]},{xtype:"fieldset",title:"Model network use",items:[{xtype:"checkbox",name:"use_model_net",boxLabel:"Use the information of the nodes"},{xtype:"checkbox",name:"use_start_learn",boxLabel:"Start learning from model network"},{xtype:"fieldcontainer",padding:"0 0 0 20",items:[{xtype:"checkbox",name:"_a1",boxLabel:"Allow link addition"},{xtype:"checkbox",name:"_a2",boxLabel:"Allow link removal"},{xtype:"checkbox",name:"_a3",boxLabel:"Allow link inversion"}]}]}]},{xtype:"panel",title:"Preprocessing",layout:{type:"vbox",align:"stretch"},items:[{xtype:"combobox",fieldLabel:"Discretize",name:"_a4",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"Specify for each variable"},{name:"Do not discretize"},{name:"Equal frequency intervals"},{name:"Equal with intervals"}]}},{xtype:"combobox",fieldLabel:"Treat missing values",queryMode:"local",name:"tmissing",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]}},{xtype:"fieldcontainer",fieldLabel:"Same number of intervals",layout:"hbox",items:[{xtype:"checkbox",name:"_a5",},{xtype:"numberfield",name:"_a6",labelWidth:120,labelAlign:"right",width:160,fieldLabel:"Number of intervals"}]},{xtype:"radiogroup",vertical:true,name:"var_use_gr",columns:1,items:[{boxLabel:"Use all variables",name:"var_use",inputValue:"all",checked:true},{boxLabel:"Use only the variables in the model network",name:"var_use",inputValue:"model"},{boxLabel:"Use selected variables",name:"var_use",inputValue:"selection"}]},{xtype:"gridpanel",name:"sheader",store:{xtype:"store",fields:["name","selected","missing_values","discretization","num_of_interval"]},flex:1,plugins:[{ptype:"cellediting",clicksToEdit:1}],columns:[{xtype:"checkcolumn",dataIndex:"selected",width:30},{text:"Preprocessing",dataIndex:"name",flex:1},{text:"Missing values",dataIndex:"missing_values",flex:1,editor:{xtype:"combobox",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"Specify for each variable"},{name:"Keep records with missing values"},{name:"Erase records with missing values"}]}}},{text:"Discretization",dataIndex:"discretization",flex:1,editor:{xtype:"combobox",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"Specify for each variable"},{name:"Keep records with missing values"},{name:"Erase records with missing values"}]}}},{text:"Number of intervals",dataIndex:"num_of_interval",width:40,editor:{xtype:"numberfield"}}]}]}]}]}],buttons:["->",{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(e){var d=this,c=d.down("[name=mform]");c.getForm().errorReader=new IG$.m2ER();d._IFe()}}});IG$.bA_2.superclass.initComponent.apply(this,arguments)}});IG$.bA_1=$s.extend($s.window,{modal:true,isWindow:true,region:"center",layout:{type:"fit",align:"stretch"},closable:false,resizable:false,width:500,height:450,callback:null,_IFe:function(){var e=this,f=ig$.b$Am,d=f.network_types,b=f.variable_types,c=e.down("[name=net_type]"),a=e.down("[name=var_type]");if(d){c.store.loadData(d)}if(b){a.store.loadData(b)}if(e.itemobj){c.setValue(e.itemobj.mtype||"");a.setValue(e.itemobj.variable_types||"")}},_IFf:function(){var b=this,a=b.down("[name=net_type]"),c=b.itemobj;a.clearInvalid();if(!a.getValue()){a.markInvalid("Empty");return}b.itemobj.mtype=a.getValue();b.itemobj.mtypename=a.getValue();b.callback&&b.callback.execute();b.close()},_IG0:function(b){var a=this;a.close()},initComponent:function(){var a=this;a.title=IRm$.r1("T_NET_PROP");$s.apply(this,{defaults:{bodyStyle:"padding:0px"},items:[{xtype:"panel",layout:"fit",border:0,defaults:{bodyPadding:5},items:[{xtype:"tabpanel",items:[{xtype:"panel",title:"Definition",layout:"anchor",items:[{xtype:"combobox",fieldLabel:"Network Type",name:"net_type",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]}},{xtype:"checkbox",disabled:true,fieldLabel:"Is Object Oriented"}]},{xtype:"panel",title:"Variables",layout:"anchor",items:[{xtype:"combobox",fieldLabel:"Variable Type",name:"var_type",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]}},{xtype:"combobox",fieldLabel:"Default States",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"Absent - Present"},{name:"No - Yes"},{name:"Negative - Positive"},{name:"Absent - Mild - Moderate - Severe"},{name:"Low - Medium - High"}]}}]}]}]}],buttons:["->",{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(c){var b=this;b._IFe()}}});IG$.bA_1.superclass.initComponent.apply(this,arguments)}});IG$.BY_1=$s.extend(IG$.BC$base,{region:"center",layout:"fit",autoHeight:true,callback:null,hide_ierr:1,s_hist:0,_IFe:function(){var g=this,b=g.job,d=ig$.b$Am,k=d.variable_types,c=d.purpose_types,l=d.potential_types,a=g._p,f=a.itemobj,e=f.instanceid,h;g.down("[name=variable_type]").store.loadData(k||[]);g.down("[name=purpose]").store.loadData(c||[]);g.down("[name=potential_type]").store.loadData(l||[]);IG$.BY_1.superclass._IFe.call(g,arguments);g._instanceid=e;if(b&&e){h=new IG$._I3e();g.setLoading(true);h.init(g,{ack:"77",payload:IG$._I2d({instanceid:e,action:"get_property"},"action;instanceid"),mbody:IG$._I2e({option:"node",name:b.text},"option;name")},g,function(I){var K=this,m=IG$._I18(I,"/smsg/item"),t,A,J,x,H,M,E,s,w,F,v,n,z,y,D,u,o,B,G,r,L=K.down("[name=g_p1]"),q,C;if(m){A=IG$._I1c(m);K.down("[name=dsname]").setValue(A.name);t=IG$._I18(m,"node_definition");if(t){A=IG$._I1c(t);K.down("[name=relavance]").setValue(A.relavance);K.down("[name=purpose]").setValue(A.purpose);J=IG$._I1a(t,"comment");K.down("[name=dsdesc]").setValue(J);J=IG$._I1a(t,"decision");K.down("[name=decision]").setValue(J)}t=IG$._I18(m,"domain_values_table");M=[];if(t){A=IG$._I1c(t);K.down("[name=variable_type]").setValue(A.variable_type);x=IG$._I18(t,"states");M=K.g1(x,"name".split(";"))}K.down("[name=domain_table]").store.loadData(M);t=IG$._I18(m,"node_parents");M=K.g1(t,"key;name".split(";"));K.down("[name=node_parent]").store.loadData(M);t=IG$._I18(m,"probability");if(t){s=IG$._I1b(t,"potential_type");K.down("[name=potential_type]").setValue(s);switch(s){case"TABLE":B=[];w=[];o=[];x=IG$._I18(t,"table_data");if(x){z=Number(IG$._I1b(x,"cols"));y=Number(IG$._I1b(x,"rows"));G=Number(IG$._I1b(x,"hc"));q=IG$._I1b(x,"uncertain_columns");q=q?q.split(","):[];C={};for(F=0;F<q.length;F++){C[Number(q[F])]=1}H=IG$._I26(x);for(F=0;F<H.length;F++){v=IG$._I24(H[F]).split("\t");if(F<G){for(D=0;D<v.length;D++){if(F==0){r={xtype:"gridcolumn",width:150,header:v[D],dataIndex:"c"+D,menuDisabled:true};r._lastcolumn=r;o.push(r);B.push("c"+D)}else{delete o[D]._lastcolumn.dataIndex;delete o[D]._lastcolumn.width;o[D]._lastcolumn.columns=o[D]._lastcolumn.columns||[];r={header:v[D],dataIndex:"c"+D,menuDisabled:true};o[D]._lastcolumn.columns.push(r);o[D]._lastcolumn=r}}}else{n={};for(D=0;D<v.length;D++){n["c"+D]=v[D]}w.push(n)}}if(o.length){u=Ext.create("Ext.data.ArrayStore",{fields:B});L.reconfigure(u,o);L.store.loadData(w)}}break}}}},false);h._l()}},g1:function(a,h){var d,c,g=[],b,f,e;if(a){b=IG$._I26(a);for(d=0;d<b.length;d++){f=IG$._I24(b[d]).split("\t");e={};for(c=0;c<h.length;c++){e[h[c]]=f[c]}g.push(e)}}return g},_IFf:function(){var a=this,b=a.job;if(b){}a.callParent(arguments)},_IG0:function(){var d=this,e=d.job,c,b="<smsg><item name='"+e.text+"' cname='"+e.dsname+"'>",a=d.down("[name=variable_type]").getValue();b+="<node_definition relavance='"+d.down("[name=relavance]").getValue()+"' purpose='"+d.down("[name=purpose]").getValue()+"'>";b+="<comment><![CDATA["+(e.dsdesc||"")+"]]></comment>";b+="<decision><![CDATA["+(d.down("[name=decision]").getValue()||"")+"]]></decision>";b+="</node_definition>";b+="<domain_values_table precision='"+d.down("[name=precision]").getValue()+"' unit='"+d.down("[name=unit]").getValue()+"' variable_type='"+a+"'>";switch(a){case"finitStates":break;case"numeric":case"descritized":break}b+="</domain_values_table>";b+="</item></smsg>";c=new IG$._I3e();c.init(d,{ack:"77",payload:IG$._I2d({instanceid:d._instanceid,action:"set_property",target:"node"},"action;instanceid;target"),mbody:b},d,function(f){d.callback&&d.callback.execute(d.job);d.fireEvent("close_dlg",d)});c._l()},_v1:function(b){var c=this,d=c.down("[name=domain_table]"),a=c.down("[name=state_num]");d.hide();a.hide();switch(b){case"finitStates":d.show();break;case"descritized":case"numeric":a.show();break}},initComponent:function(){var a=this,c=120,b=a.__m;a._job_name=IRm$.r1("T_BA_1");a.moption=[{xtype:"fieldset",title:"Definition",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"fieldcontainer",layout:"hbox",items:[{xtype:"combobox",fieldLabel:"Purpose",name:"purpose",labelWidth:60,width:180,queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]}},{xtype:"numberfield",labelWidth:50,width:160,name:"relavance",fieldLabel:"Relevance"}]},{xtype:"combobox",fieldLabel:"Decision criterion",name:"decision",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]}}]},{xtype:"fieldset",title:"Domain",layout:"anchor",items:[{xtype:"combobox",fieldLabel:"Variable type",name:"variable_type",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]},listeners:{change:function(d){this._v1(d.getValue())},scope:this}},{xtype:"gridpanel",hideHeaders:true,name:"domain_table",hidden:true,height:150,tbar:[{text:"Stanard domains"},{text:"Add"},{text:"Delete"},{text:"Up"},{text:"Down"}],store:{fields:["name"]},columns:[{text:"Name",flex:1,dataIndex:"name"}]},{xtype:"container",layout:"anchor",hidden:true,name:"state_num",items:[{xtype:"fieldcontainer",fieldLabel:"Precision",layout:"hbox",items:[{xtype:"numberfield",name:"precision",width:60},{xtype:"textfield",fieldLabel:"Unit",name:"unit",labelAlign:"right",labelWidth:60,width:120}]},{xtype:"gridpanel",hideHeaders:true,height:140,tbar:[{text:"Add"},{text:"Delete"}],columns:[{text:"Name",flex:1},{text:"Lower",width:25},{text:"Value",width:50},{text:"Higher",width:25},{text:"Value",width:50}]}]}]},{xtype:"fieldset",title:"Parents",layout:"anchor",items:[{xtype:"gridpanel",hideHeaders:true,name:"node_parent",height:100,tbar:[{text:"Add"},{text:"Delete"}],store:{fields:["name"]},columns:[{text:"Name",dataIndex:"name",flex:1}]}]},{xtype:"fieldset",layout:"anchor",title:"Other properties",tbar:[{text:"Add"},{text:"Delete"},{text:"Up"},{text:"Down"}]}];IG$.BY_1.superclass.initComponent.apply(this,arguments)}});IG$._IB8r=function(a){if(a){this.p1(a)}};IG$._IB8r.prototype={p1:function(d){var b=this,a,e,c;e=IG$._I18(d,"thresholds");if(e){b.thresholds=[];c=IG$._I26(e);for(a=0;a<c.length;a++){b.thresholds.push({value:IG$._I1b(c[a],"value"),belongs_to:IG$._I1b(c[a],"belongs_to")})}}e=IG$._I18(d,"states");if(e){b.states=[];c=IG$._I26(e);for(a=0;a<c.length;a++){b.states.push({name:IG$._I1b(c[a],"name")})}}e=IG$._I18(d,"label");if(e){b.label=IG$._I24(e)}e=IG$._I18(d,"reference");if(e){b.reference=IG$._I24(e)}e=IG$._I18(d,"potential");if(e){b.potential=new IG$._IB8p(e)}},p2:function(){var c=this,b="<branch>",a;if(c.thresholds&&c.thresholds.length){b+="<thresholds>";for(a=0;a<c.thresholds.length;a++){b+="<threshold value='"+c.thresholds[a].value+"' belongs_to='"+c.thresholds[a].belongs_to+"'></threshold>"}b+="</thresholds>"}if(c.states&&c.states.length){b+="<states>";for(a=0;a<c.states.length;a++){b+="<state name='"+c.states[a].name+"'></state>"}b+="</states>"}if(c.label){b+="<label>"+c.label+"</label>"}if(c.reference){b+="<reference>"+c.reference+"</reference>"}if(c.potential){b+=c.potential.p2()}b+="</branch>";return b}};IG$._IB8p=function(a){if(a){this.p1(a)}};IG$._IB8p.prototype={p1:function(d){var b=this,a,f,c,e;b.type=IG$._I1b(d,"type");b.role=IG$._I1b(d,"role");b.variables=[];f=IG$._I18(d,"variables");if(f){c=IG$._I26(f);for(a=0;a<c.length;a++){b.variables.push({name:IG$._I1b(c[a],"name")})}}b.values=IG$._I1a(d,"values");f=IG$._I18(d,"uncertain_values");if(f){b.uncertain_values=[];c=IG$._I26(f);for(a=0;a<c.length;a++){e=IG$._I1c(c[a]);e.value=IG$._I24(c[a]);b.uncertain_values.push(e)}}f=IG$._I18(d,"utility_variable");if(f){b.utility_variable={name:IG$._I1b(f,"name")}}f=IG$._I18(d,"top_variable");if(f){b.top_variable={name:IG$._I1b(f,"name"),timeslice:IG$._I1b(f,"timeslice")}}f=IG$._I18(d,"branches");if(f){b.branches=[];c=IG$._I26(f);for(a=0;a<c.length;a++){b.branches.push(new IG$._IB8r(c[a]))}}f=IG$._I18(d,"model");if(f){b.model=IG$._I24(f)}f=IG$._I18(d,"subpotentials");if(f){b.subpotentials=[];c=IG$._I26(f);for(a=0;a<c.length;a++){b.subpotentials.push(new IG$._IB8p(c[a]))}}f=IG$._I18(d,"time_variable");if(f){b.time_variable={name:IG$._I1b(f,"name"),timeslice:IG$._I1b(f,"timeslice")}}f=IG$._I18(d,"coefficients");if(f){b.coefficients=IG$._I24(f)}f=IG$._I18(d,"covariates");if(f){b.covariates=[];c=IG$._I26(f);for(a=0;a<c.length;a++){b.covariates.push(IG$._I24(c[a]))}}f=IG$._I18(d,"covariance_matrix");if(f){b.covariance_matrix=IG$._I24(f)}f=IG$._I18(d,"cholesky_decomposition");if(f){b.cholesky_decomposition=IG$._I24(f)}f=IG$._I18(d,"numeric_value");if(f){b.numeric_value=IG$._I24(f)}f=IG$._I18(d,"state");if(f){b.state=IG$._I24(f)}},p2:function(){var d=this,c="<potential type='"+(d.type||"")+"' role='"+(d.role||"")+"'>",b,e=d.variables,a=d.uncertain_values;if(e){c+="<variables>";for(b=0;b<e.length;b++){c+="<variable name='"+e[b].name+"'/>"}c+="</variables>"}c+="<values>"+(d.values||"")+"</values>";if(a&&a.length){c+="<uncertain_values>";for(b=0;b<a.length;b++){c+="<value "+(a[b].distribution?" distribution='"+a[b].distribution+"'":"")+(a[b].name?" name='"+a[b].name+"'":"")+">"+(a[b].value||"")+"</value>"}c+="</uncertain_values>"}if(d.utility_variable&&d.utility_variable.name){c+="<utility_variable name='"+d.utility_variable.name+"'></utility_variable>"}if(d.top_variable&&d.top_variable.name){c+="<top_variable name='"+d.top_variable.name+"'"+(d.top_variable.timeslice?" timeslice='"+d.top_variable.timeslice+"'":"")+"></top_variable>"}if(d.time_variable&&d.time_variable.name){c+="<time_variable name='"+d.time_variable.name+"'"+(d.time_variable.timeslice?" timeslice='"+d.time_variable.timeslice+"'":"")+"></time_variable>"}if(d.branches&&d.branches.length){c+="<branches>";for(b=0;b<d.branches.length;b++){c+=d.branches[b].p2()}c+="</branches>"}if(d.subpotentials&&d.subpotentials.length){c+="<subpotentials>";for(b=0;b<d.subpotentials.length;b++){c+=d.subpotentials[b].p2()}c+="</subpotentials>"}if(d.model){c+="<model>"+d.model+"</model>"}if(d.coefficients){c+="<coefficients>"+d.coefficients+"</coefficients>"}if(d.covariates&&d.covariates.length){c+="<covariates>";for(b=0;b<d.covariates.length;b++){c+="<covariate>"+d.covariates[b]+"</covariates>"}c+="</covariates>"}if(d.covariance_matrix){c+="<covariance_matrix>"+d.covariance_matrix+"</covariance_matrix>"}if(d.cholesky_decomposition){c+="<cholesky_decomposition>"+d.cholesky_decomposition+"</cholesky_decomposition>"}if(d.numeric_value){c+="<numeric_value>"+d.numeric_value+"</numeric_value>"}if(d.state){c+="<state>"+d.state+"</state>"}c+="</potential>";return c}};IG$._IB8b=function(a,b){var c=this;c.bf=b;c.nodes=[];c.links=[];c.potentials=[];a&&c.L1(a)};IG$._IB8b.prototype={L1:function(q){var u=this,p,c,r,o,n,g,l,e,s,f,k,h,t,m,a,d=[],b=[];u.nodes=[];u.links=[];u.potentials=[];u.decision_criteria=[];u.interactive_learning=null;p=IG$._I18(q,"/smsg/item");if(p){f=IG$._I1b(p,"uid");if(f){u.item=IG$._I1c(p)}m=IG$._I1b(p,"instanceid");if(m){u.instanceid=m}c=IG$._I19(p,"probnet");u.additional_properties=[];if(c){k=IG$._I19(c,"comment");if(k){u.comment=IG$._I24(k)}k=IG$._I19(c,"additional_properties");if(k){r=IG$._I26(k);for(o=0;o<r.length;o++){u.additional_properties.push({name:IG$._I1b(r[o],"name"),value:IG$._I1b(r[o],"value")})}}}c=IG$._I19(p,"nodes");if(c){u.mtype=IG$._I1b(c,"type");u.mtypename=IG$._I1b(c,"typename");r=IG$._I26(c);for(o=0;o<r.length;o++){l=new IG$._baN(r[o]);l.w=100;l.h=28;l._cs=["ba_base","ba_"+l.shape];u.nodes.push(l)}}c=IG$._I19(p,"links");if(c){r=IG$._I26(c);for(o=0;o<r.length;o++){s={};IG$._I1f(s,r[o],"from;to;dashstyle;directed","s");k=IG$._I19(r[o],"potential");if(k){s.potential=new IG$._IB8p(k)}k=IG$._I19(r[o],"revealing_condition");if(k){s.revealing_condition={};t=IG$._I19(k,"states");if(t){s.revealing_condition.states=[];snodes=IG$._I26(t);for(n=0;n<snodes.length;n++){s.revealing_condition.states.push({name:IG$._I1b(snodes[n],"name")})}}}u.links.push(s)}}c=IG$._I19(p,"potentials");if(c){r=IG$._I26(c);for(o=0;o<r.length;o++){h=new IG$._IB8p(r[o]);u.potentials.push(h)}}c=IG$._I19(p,"decision_criteria");if(c){r=IG$._I26(c);for(o=0;o<r.length;o++){criterion=IG$._I1c(r[o]);k=IG$._I19(r[o],"additional_properties");if(k){snodes=IG$._I26(k);for(n=0;n<snodes.length;n++){criterion[IG$._I1b(snodes[n],"name")]=IG$._I1b(snodes[n],"value")}}u.decision_criteria.push(criterion)}}c=IG$._I18(p,"interactive_learning");if(c){$.each([{name:"showable_edit_proposals",arr:d},{name:"blocked_edit_proposals",arr:b}],function(C,y){var B,x,w,A,z,v=y.arr;B=IG$._I18(c,y.name);if(B){A=IG$._I26(B);for(x=0;x<A.length;x++){z={};knodes=IG$._I26(A[x]);for(w=0;w<knodes.length;w++){vname=IG$._I29(knodes[w]);z[vname]=IG$._I24(knodes[w])}v.push(z)}}});if(d.length+b.length>0){u.interactive_learning={showable_edit_proposals:d,blocked_edit_proposals:b}}}}},L2:function(){var e=this,d=[],b,a=e.potentials,c=e.decision_criteria;d.push("<smsg><item");e.item&&d.push(IG$._I20(e.item,"uid;nodepath;name","s"));d.push(">");d.push("<probnet>");if(e.comment){d.push("<comment><![CDATA["+e.comment+"]]></comment>")}b=e.additional_properties;if(b&&b.length){d.push("<additional_properties>");for(i=0;i<b.length;i++){d.push("<property name='"+b[i].name+"' value='"+b[i].value+"'/>")}d.push("</additional_properties>")}d.push("</probnet>");d.push(e.bf.l2.call(e.bf,e.mtype,e.mtypename));if(a&&a.length){d.push("<potentials>");for(i=0;i<a.length;i++){d.push(a[i].p2())}d.push("</potentials>")}if(c&&c.length){d.push("<decision_criteria>");for(i=0;i<c.length;i++){d.push("<criterion name='"+c[i].name+"'>");d.push("<additional_properties>");$.each(c[i],function(f,g){if(f&&f!="name"){d.push("<property name='"+f+"' value='"+g+"'></property>")}});d.push("</additional_properties>");d.push("</criterion>")}d.push("</decision_criteria>")}d.push("</item></smsg>");return d.join("")}};IG$._IB9b=$s.extend($s.panel,{closable:true,layout:"fit",bodyPadding:0,sgap:1000,_IFd:function(){var g=this,d=g.topmenu,h=g.mainarea,c,b,f,a=[],e,k;a=[{shape:"circle",name:"chance",_cs:["ba_base","ba_circle"],text:IRm$.r1("L_ML_C1")},{shape:"rect",name:"decision",_cs:["ba_base","ba_rect"],text:IRm$.r1("L_ML_C2")},{shape:"rhombus",name:"utility",_cs:["ba_base","ba_rhombus"],text:IRm$.r1("L_ML_C3")}];b=g.farea=$("<div class='idv-flw-reg'></div>").appendTo(h);f=g.bf=new IG$._I9a(b);f.init.call(f);d.empty();c=$("<div class='idv-flw-mnu'></div>").appendTo(d);g.l1(c,a);e=new IG$._I3d(g,g.l4);f.container.bind("boxClicked",function(m,n){var o,l=g.down("[name=moption]");o=g.__dlg;if(!o){g.__dlg=o=new IG$.BY_1({job:n,_sustain:1,_vmode:n.name,_p:g,callback:e});l.add(o);o.on("close_dlg",function(p){l.collapse()})}else{o.job=n;o._vmode=n.name,o._IFe.call(o)}if(o){l.expand()}});f.container.bind("flow_changed",function(l,m){switch(m.source){case"box_add":case"link_node":case"move_link":case"link_detach":g.updateNetwork.call(g,m.source,m);break}});f.container.bind("visual_state_click",function(l,m){g.setNewFinding.call(g,m)});if(!ig$.b$Am){k=new IG$._I3e();k.init(g,{ack:"77",payload:IG$._I2d({action:"get_var"},"action"),mbody:IG$._I2e({})},g,function(r){var t=this,q={},l,s,m,v,n,u,p,o;l=IG$._I18(r,"/smsg");if(l){s=IG$._I26(l);for(p=0;p<s.length;p++){v=IG$._I29(s[p]);n=q[v]=[];m=IG$._I26(s[p]);for(o=0;o<m.length;o++){u={value:IG$._I1b(m[o],"value")};u.name=u.name||u.value;n.push(u)}}ig$.b$Am=q}t._a1()},false);k._l()}else{g._a1()}},_a1:function(){var a=this;if(a.uid){a.M1()}else{a.rs_M1(null)}},l4:function(c){var b=this,a=b.bf;c.text=c.dsname;a.s4(c,c.dsname)},M1:function(){var b=this,a=new IG$._I3e();if(b.uid){b.setLoading(true);a.init(b,{ack:"5",payload:IG$._I2d({uid:b.uid}),mbody:IG$._I2e({option:"diagnostics"})},b,b.rs_M1,false);a._l()}else{b.rs_M1(null)}},rs_M1:function(a,b){var d=this,c=d.bf,e;if(!d.itemobj){d.itemobj=new IG$._IB8b(a,c)}else{d.itemobj.L1(a)}if(d.__learn_opt&&d.bfirst){d.do1(d.__learn_opt)}if(b&&d.itemobj.interactive_learning){e=new IG$.bA_6({itemobj:d.itemobj,callback:new IG$._I3d(d,function(f){d.do1(null,{interactive_run:true})})});e.show()}d.A1()},A1:function(){var e=this,c=e.bf,f=e.itemobj,g=f.mtype;c.L1.call(c,f);if(!g){e.np(!e.bfirst)}else{if(!e.bfirst){var f=e.itemobj,b=f.instanceid,a=f.uid,d=new IG$._I3e();d.init(e,{ack:"77",payload:IG$._I2d({uid:a,instanceid:b,action:"restore_pgmx"},"uid;action;instanceid"),mbody:f.L2()},e,function(h){var l=e.down("[name=txtpgmx]"),m=IG$._I18(h,"/smsg/data"),k;e.bfirst=1;if(m){f.instanceid=IG$._I1b(m,"instanceid");if(e.__learn_opt){e.do1(e.__learn_opt)}}},false);d._l()}}switch(g){case"":break}},m2:function(n,f){var l=this,h=l.bf,c=h.a_boxes,g,k,b=h.plumb.getConnections(),a,e,m=[],d=[];for(g=0;g<c.length;g++){if(c[g].sid==n.job.sid){k=c[g];break}}if(b&&b.length){for(g=0;g<b.length;g++){a=b[g].source;e=b[g].target;a=h.getBoxObject.call(h,a);e=h.getBoxObject.call(h,e);m.push({src:a,tgt:e});if(e&&e.sid==k.sid){if(a&&(f&&a.name==f||!f)){d.push(a)}}}}return d},l1:function(c,e){var d=this,a,f,h=10,g=h,b=d.bf;c.empty();$.each(e,function(p,o){var m,l,k;if(!o.hidden){m=$("<div class='idv-flw-shp-a'><div>"+o.text+"</div></div>").appendTo(c);m.css({left:g});if(o._cs&&o._cs.length){for(k=0;k<o._cs.length;k++){m.addClass(o._cs[k])}}g+=h+(IG$.x_10._w(m)||120);m.draggable({opacity:0.7,helper:"clone",stop:function(n,w){var q=w.position,s=d.farea,r=$(s.parent()).offset(),v=s.offset(),x=IG$.x_10._w(s),u=IG$.x_10._h(s);var t=new IG$._baN();t.c1.call(t,o);t.w=100;t.h=28;v.top-=r.top;v.left-=r.left;q.w=t.w;q.h=t.h;if(v.left<q.left&&q.left<v.left+x&&v.top<q.top&&q.top<v.top+u){b.addBox.call(b,t,q,true)}}})}})},m1:function(d){var b=this,a=new IG$._I3e();b.lv(0);a.init(b,{ack:"77",payload:IG$._I2d({uid:b.uid,action:"load_pgmx"},"uid;action"),mbody:d},b,function(c){this.rs_M1(c)},false);a._l()},np:function(a){var b=this,c=new IG$.bA_1({itemobj:b.itemobj,callback:new IG$._I3d(b,function(d){b.updateNetwork("net_prop",null,a)})});c.show()},updateNetwork:function(m,a,f){var e=this,d=e.itemobj,b=d.instanceid,c=d.uid,g=new IG$._I3e(),h,k="uid;action;instanceid;actiontype",l={uid:c,instanceid:b,action:"update_network",actiontype:m};switch(m){case"box_add":k+=";sid";l.sid=a.item.sid;break;case"link_node":k+=";src;tgt";l.src=a.item.src;l.tgt=a.item.tgt;break;case"move_link":k+=";source_0;source_1;target_0;target_1";l.source_0=a.item.source_0;l.source_1=a.item.source_1;l.target_0=a.item.target_0;l.target_1=a.item.target_1;break;case"link_detach":k+=";src;tgt";l.src=a.item.src;l.tgt=a.item.tgt;break}h=IG$._I2d(l,k);g.init(e,{ack:"77",payload:h,mbody:d.L2()},e,function(o){if(!b){var p=IG$._I18(o,"/smsg/data"),n=(p)?IG$._I1b(p,"instanceid"):null;if(n){d.instanceid=n}if(e.__learn_opt&&f){e.do1(e.__learn_opt)}}},false);g._l()},setNewFinding:function(c){var b=this,d=b.itemobj,a=new IG$._I3e();a.init(b,{ack:"77",payload:IG$._I2d({uid:b.uid,action:"set_new_finding",instanceid:d.instanceid},"uid;action;instanceid"),mbody:IG$._I2e({target:c.graphic.name,state:c.state.states.name})},b,function(e){var f=this,g=IG$._I18(e,"/smsg/graphics");if(g){f.paint(g,f.emode)}},false);a._l()},_t$:function(e){var c=this,d=c.itemobj,g;switch(e){case"cmd_save":if(!c.uid){c.fV7(false)}else{c.fV6(false)}break;case"cmd_saveas":c.fV7(false);break;case"cmd_load_pgmx":g=new IG$._IB9c({itemobj:c.itemobj,callback:new IG$._I3d(c,function(h){c.m1(h)})});g.show();break;case"cmd_net_prop":c.np();break;case"cmd_favorites":if(this.uid){var b=new IG$._I3e();b.init(c,{ack:"11",payload:IG$._I2d({uid:c.uid}),mbody:IG$._I2e({option:"addfavorites"})},c,c.rs_i1_2,null,null);b._l()}else{IG$._I54(ig$.appname,IRm$.r1("M_ERR_NSAVE"),null,c,1,"error")}break;case"cmd_schedule":if(c.uid){var f=[{ack:"3",payload:IG$._I2d({uid:c.uid,option:"execute"},"uid;option"),mbody:c.itemobj.L2.call(c.itemobj),jobkey:"0"}];IG$._I50(c,c.uid,c.itemtype,f,null)}break;case"cmd_net_mode":c.setNewWorkingMode();break;case"cmd_decision_tree":c.toggleDecisionTree();break;case"cmd_learn":var g=new IG$.bA_2({callback:new IG$._I3d(c,function(h){c.do1(h)})});g.show();break;case"cmd_db_generator":var g=new IG$.bA_3({callback:new IG$._I3d(c,function(k){var h=new IG$._I3e();h.init(c,{ack:"77",payload:IG$._I2d({uid:c.uid,instanceid:d.instanceid,action:"db_gen"},"uid;action;instanceid"),mbody:IG$._I2e(k)},c,function(l){var o=IG$._I18(l,"/smsg/item"),n,m;if(o){n=IG$._I1b(o,"luid");m=IG$._I1b(o,"filename");if(n&&m){$.download(ig$.servlet,[{name:"ack",value:"35"},{name:"_mts_",value:IG$._g$a||""},{name:"payload",value:n},{name:"mbody",value:m}],"POST")}}});h._l()})});g.show();break;case"cmd_cost_effct_sen":case"cmd_cost_effct_det":var a=(e=="cmd_cost_effct_sen"?0:1),g=new IG$.bA_4({atype:a,uid:c.uid,itemobj:d,width:a==0?600:320,height:a==0?550:300,callback:new IG$._I3d(c,function(h){})});g.show();break}},do1:function(l,c){var g=this,f=g.itemobj,b=new IG$._I3e(),h="<smsg>",d,a,e;if(c&&c.interactive_run){h+="<learn_option interactive_do='T'>"}else{h+="<learn_option>";for(d in l){a=l[d];if(d=="selected_header"){h+="<option name='selected_header'>";for(e=0;e<a.length;e++){h+="<header>";h+="<selected>"+a[e].selected+"</selected>";h+="<name><![CDATA["+a[e].name+"]]></name>";h+="<missing_value>"+(a[e].missing_value||"")+"</missing_value>";h+="<discretization>"+(a[e].discretization||"")+"</discretization>";h+="<num_of_interval>"+(a[e].num_of_interval||"")+"</num_of_interval>";h+="</header>"}h+="</option>"}else{if(a){h+="<option name='"+d+"'>"+a+"</option>"}}}}h+="</learn_option></smsg>";g.setLoading();b.init(g,{ack:"77",payload:IG$._I2d({uid:g.uid,instanceid:f.instanceid,action:"learn_network",pfile:(l?l.pfile:null)},"uid;action;instanceid;pfile"),mbody:h},g,function(k){g.__learn_opt=null;g.rs_M1(k,1)});b._l()},toggleDecisionTree:function(){var b=this,a=new IG$._I3e(),c=b.itemobj;if(c&&c.instanceid){b.lv(1);a.init(b,{ack:"77",payload:IG$._I2d({uid:b.uid,action:"set_decision_tree",instanceid:c.instanceid},"uid;action;instanceid"),mbody:IG$._I2e()},b,function(d){var e=this,f=IG$._I18(d,"/smsg/decision_tree");if(f){e.paint_decision_tree(f)}},false);a._l()}},paint_decision_tree:function(f){var d=this,e=d.down("[name=m_decision_tree]"),c,a,b=d.dnd_viewer,g={};if(!b){c=$(e.el.dom);a=$("<div class='ba-decision-viewer'></div>").appendTo(c);a.width(c.width()).height(c.height());b=new node_tree_viewer(a);d.dnd_viewer=b}g=d.build_decision_data(f);if(g&&g.length>0){b.loadTreeData(g[0])}},build_decision_data:function(d){var m=this,l=IG$._I26(d),e,g,k,h,b,a,f=[],c={};for(k=0;k<l.length;k++){a=IG$._I29(l[k]);switch(a){case"decision_branch":case"decision_treenode":c={};e=IG$._I19(l[k],"property");if(e){g=IG$._I26(e);for(h=0;h<g.length;h++){b=IG$._I1b(g[h],"name");c[b]=IG$._I24(g[h])}if(a=="decision_branch"){c.name=c.branch_state||"top"}else{c.name=c.nodename}}e=IG$._I19(l[k],"children");if(e){c.children=m.build_decision_data(e)}f.push(c);break}}return f},setNewWorkingMode:function(){var b=this,a=new IG$._I3e(),c=b.itemobj,d=b.emode?0:1;b.emode=d;if(c&&c.instanceid){b.lv(0);if(b.emode){a.init(b,{ack:"77",payload:IG$._I2d({uid:b.uid,action:"set_working_mode",instanceid:c.instanceid},"uid;action;instanceid"),mbody:IG$._I2e()},b,function(e){var f=this,g=IG$._I18(e,"/smsg/graphics");if(g){f.paint(g,f.emode)}},false);a._l()}else{b.paint(null,b.emode)}}},paint:function(f,w){var y=this,h=f?IG$._I18(f,"visualnodes"):null,x,n,t,v,m,u={},s,r,q,l,o,e,d,c,b,a=y.itemobj;if(h){x=IG$._I26(h);for(s=0;s<x.length;s++){t=x[s];n={name:IG$._I1b(t,"name"),visualstates:[]};v=IG$._I18(t,"innerbox/visualstates");if(v){l=IG$._I26(v);for(r=0;r<l.length;r++){e=l[r];o=IG$._I1c(e);o.position=parseInt(o.position);o.ispropagationactive=o.ispropagationactive=="T";o.values=[];d=IG$._I18(e,"values");if(d){c=IG$._I26(d);for(q=0;q<c.length;q++){b=c[q];o.values.push({barlength:IG$._I1a(b,"barlength"),formatvalue:IG$._I1a(b,"formatvalue")})}}n.visualstates.push(o)}}u[n.name]=n}}$.each(a.nodes,function(g,k){k.paint.call(k,u[k.text],w)});y.bf.plumb.repaintEverything()},rs_i1_2:function(a){IG$._I54(ig$.appname,IRm$.r1("M_SAVED_FAV"),null,null,0,"success")},ll4:function(){var a=this;if(a.stimer){clearTimeout(a.stimer)}a.stimer=setTimeout(function(){a.ll3.call(a)},a.sgap)},rs_lllE:function(a){var c=this,e=true,d=IG$._I27(a);if(d=="0x28a0"){e=false;var f=IG$._I18(a,"/smsg"),b=IG$._I24(f);if(b){IG$._I55(ig$.appname,"Already workflow is running on server. Would you like to stop service?",function(h){if(h=="yes"){var g=new IG$._I3e();g.init(c,{ack:"3",payload:IG$._I2d({uid:c.uid,sid:b,option:"cancelWorkflow"},"uid;sid;option"),mbody:IG$._I2e()},c,c.rs_ll2,null);g._l()}},c,c)}}return e},rs_ll2:function(a){var b=this;b.lll()},fV6:function(c){var a=this,b=a.itemobj.L2.call(a.itemobj);var d=new IG$._I3e();d.init(a,{ack:"31",payload:IG$._I2d({uid:a.uid}),mbody:b},a,a.rs_fV6,null,[c]);d._l()},rs_fV6:function(a,b){var d=this,c=(b?b[0]:false);if(c==true){d.close()}else{d._ILb_=false;IG$._I54(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")}},fV7:function(a){var b=this,c=new IG$._I96({mode:"newitem",initpath:b.nodepath,callback:new IG$._I3d(b,b.fV8,a)});IG$._I_5(b,c)},fV8:function(e,c){var a=this,b=a.itemobj.L2.call(a.itemobj),d=new IG$._I3e();d.init(a,{ack:"31",payload:"<smsg><item address='"+e.nodepath+"/"+e.name+"' name='"+e.name+"' type='"+(this.itemtype)+"' pid='"+e.uid+"' description=''/></smsg>",mbody:b},a,a._IO5,a._IO6,[e.name,c,e.nodepath,e.uid,b]);d.showerror=false;d._l()},_IO5:function(a,b){var c=this,e=c.itemobj,d;d=IG$._I18(a,"/smsg/item");if(d){e.item=IG$._I1c(d);c.setTitle(e.item.name);c.uid=e.item.uid}},_IO6:function(e,c){var b=this,g=c[0],k=c[1],d=c[2],h=c[3],f=c[4],a=IG$._I27(e);if(a=="0x12e0"){IG$._I55(ig$.appname,g+" already exist on the server. Would you overwrite existing item with this copy?",function(m){if(m=="yes"){var l=new IG$._I3e();l.init(b,{ack:"31",payload:"<smsg><item address='"+d+"/"+g+"' name='"+g+"' type='"+(this.itemtype?this.itemtype:"Report")+"' pid='"+h+"' description='' overwrite='T'/></smsg>",mbody:f},b,b._IO5,null,[g,k,d]);l._l()}},b,b)}else{IG$._I51(e,b)}},lv:function(c){var b=this,a=b.m_main_card;a.getLayout().setActiveItem(c)},initComponent:function(){var a=this;$s.apply(this,{items:[{xtype:"panel",layout:"card",name:"m_main_card",items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",name:"topmenu",height:40,border:1,style:{borderColor:"#efefef",borderStyle:"solid"}},{xtype:"container",flex:1,layout:"border",items:[{xtype:"container",name:"mainarea",region:"center",flex:1},{xtype:"panel",name:"moption",title:"Properties",split:true,collapsible:true,collapsed:true,collapseMode:"mini",region:"east",width:420,layout:"fit",items:[{xtype:"displayfield",value:"Click Item to set properties"}]}]}]},{xtype:"container",name:"m_decision_tree",listeners:{resize:function(c,b,e){var f=this,d=f.dnd_viewer;if(d){d.setSize.call(d,b,e)}},scope:this}}]}],tbar:[{iconCls:"icon-toolbar-save",name:"t_save",tooltip:IRm$.r1("L_SAVE_CONTENT"),handler:function(){this._t$("cmd_save")},scope:this},{iconCls:"icon-toolbar-saveas",name:"t_save_as",tooltip:IRm$.r1("L_SAVE_CONTENTAS"),handler:function(){this._t$("cmd_saveas")},scope:this},{text:"NetProp",handler:function(){this._t$("cmd_net_prop")},scope:this},{text:IRm$.r1("L_ML_C7"),handler:function(){this._t$("cmd_load_pgmx")},scope:this},"-",{text:IRm$.r1("L_ML_C4a"),handler:function(){this._t$("cmd_net_mode")},scope:this},{text:IRm$.r1("L_ML_C5"),handler:function(){this._t$("cmd_decision_tree")},scope:this},"-",{text:IRm$.r1("L_ML_C6"),handler:function(){this._t$("cmd_cases")},scope:this},{text:IRm$.r1("L_ML_C6a"),handler:function(){this._t$("cmd_cases_new")},scope:this},{text:IRm$.r1("L_ML_C6b"),handler:function(){this._t$("cmd_cases_rm")},scope:this},"-",{text:IRm$.r1("L_ML_LEARN"),handler:function(){this._t$("cmd_learn")},scope:this},{text:"Tools",menu:{xtype:"menu",items:[{text:"Database generator",handler:function(){this._t$("cmd_db_generator")},scope:this},{text:IRm$.r1("L_ML_CEFF_S"),handler:function(){this._t$("cmd_cost_effct_sen")},scope:this},{text:IRm$.r1("L_ML_CEFF_D"),handler:function(){this._t$("cmd_cost_effct_det")},scope:this}]}},"->",{iconCls:"icon-toolbar-schedule",cls:"ig_r_sch",tooltip:IRm$.r1("B_SCHEDULE"),hidden:ig$.features&&!ig$.features.enable_scheduler?true:false,handler:function(){this._t$.call(this,"cmd_schedule")},scope:this},{iconCls:"icon-toolbar-favorites",tooltip:IRm$.r1("B_FAVORITES"),handler:function(){this._t$.call(this,"cmd_favorites")},scope:this}]});IG$._IB9b.superclass.initComponent.call(this)},listeners:{afterrender:function(a){var b=this;b.m_main_card=b.down("[name=m_main_card]");b.topmenu=$(b.down("[name=topmenu]").el.dom);b.mainarea=$(b.down("[name=mainarea]").el.dom);b._IFd()},beforeclose:function(b,c){if(b.itemobj&&b.itemobj.instanceid){var a=new IG$._I3e();a.init(b,{ack:"77",payload:IG$._I2d({uid:b.uid,action:"ref_down",instanceid:b.itemobj.instanceid},"uid;action;instanceid"),mbody:IG$._I2e()},b,function(d){},false);a._l()}}}});