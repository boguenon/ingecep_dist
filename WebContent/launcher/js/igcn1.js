IG$.M$dao=function(a){var e=this,f=IG$._I18(a,"/smsg/item"),d=IG$._I1c(f),b=IG$._I18(a,"/smsg/item/objinfo"),c=(b)?IG$._I1c(b):null;e.metainfo=d||{};e.objinfo=c||{};e.dateitems=[];e.datecustom=""};IG$.M$dao.prototype={gx:function(){var b=this,a="<smsg><item ";a+=IG$._I20(b.objinfo,"memo;name;type;uid","s")+">";a+="<objinfo ";a+=IG$._I20(b.objinfo,"cubeuid;dateformat;fieldid;fieldname;dbtype","s");a+=IG$._I20(b.objinfo,"issql;isdatetype;removeblank","b");a+="/>";a+="</item></smsg>";return a}};IG$.M$dam=$s.extend($s.window,{modal:false,isWindow:true,region:"center",layout:"fit",closable:false,resizable:false,width:520,autoHeight:true,callback:null,_IFd:function(){var a=this;a.setTitle(IRm$.r1("T_DM")+(a.name?" ("+a.name+")":""));if(a.uid){a.sK5()}},sK5:function(){var a=this,b=new IG$._I3e();b.init(a,{ack:"5",payload:IG$._I2d({uid:this.uid}),mbody:IG$._I2e({option:"diagnostics"})},a,a.rs_sK5,null);b._l()},rs_sK5:function(a){var d=this,b,c;d.mobj=new IG$.M$dao(a);b=d.mobj.objinfo;b.issql=b.issql=="T"?true:false;c=d.down("[name=rg_dateformatting]");c.setValue({dateformatting:(b.issql?"sqlfunc":"formatting")});d.down("[name=dateformat]").setValue(b.dateformat||"");d.down("[name=fieldname]").setValue(b.fieldname||"");if(!b.cubeuid){d.k2()}else{d.k1()}},k2:function(){var a=this,b=new IG$._I3e();b.init(a,{ack:"11",payload:"<smsg><item uid='"+this.uid+'\' parenttype="Cube;MCube;DataCube;SQLCube" read="F"/></smsg>',mbody:IG$._I2e({option:"parentcontent"})},a,a.rs_k2,null);b._l()},rs_k2:function(b){var c=this,d=IG$._I18(b,"/smsg/item"),a=IG$._I1c(d);c.mobj.objinfo.cubeuid=a.uid;c.k1()},k1:function(){var a=this,b=new IG$._I3e();b.init(a,{ack:"5",payload:IG$._I2d({uid:this.uid}),mbody:IG$._I2e({subfolder:"T",itemtype:"CustomMetric",readcontent:"T"})},a,a.rs_k1,null);b._l()},rs_k1:function(f){var n=this,a=IG$._I18(f,"/smsg/item"),l=IG$._I26(a),e,q,p,c=n.mobj.objinfo,j,g,d={},h={},b,o;for(e=0;e<l.length;e++){p=IG$._I1c(l[e]);q=IG$._I18(l[e],"Fields/item");if(q){q=IG$._I1c(q);j=IG$._I18(l[e],"CustomMetricInfo");if(j){g=IG$._I1c(j);g.uid=p.uid;g.name=p.name;g.nodepath=p.nodepath;d[g.datedivision]=g;if(g.datedivision=="CUSTOM"){n.down("[name=customdatetype]").setValue(g.customdatetype)}}}}n.custominfo=d;for(b in d){n.down("[name=datediv_"+b+"]").setValue(true)}},l1:function(){var d=this,a=d.down("[name=dateformatting]").getGroupValue(),f=(a=="sqlfunc"?true:false),g=d.down("[name=ex_format1]"),e=d.down("[name=ex_format2]"),b,c;for(b=0;b<g.menu.items.length;b++){c=g.menu.items.items[b];c.setVisible(!c.issql||(c.issql==true&&f==true))}for(b=0;b<e.menu.items.length;b++){c=e.menu.items.items[b];c.setVisible(!c.issql||(c.issql==true&&f==true))}},_IG0:function(){this.close();this.callback&&this.callback.execute()},_IFf:function(){var j=this,g=j.down("[name=fieldname]");g.clearInvalid();if(!j.mobj){return}if(!g.getValue()){g.markInvalid(IRm$.r1("B_REQUIRED"));return}var e,n=j.down("[name=dateformat]"),h={},f=[],d,a,b=j.down("[name=dateformatting]"),l=b.getGroupValue(),p=(l=="sqlfunc"?true:false),q=j.mobj,c=q.objinfo,o=j.down("[name=dbtype]");c.issql=p;c.dateformat=n.getValue();c.dbtype="auto";b.clearInvalid();if(!c.dateformat){b.markInvalid(IRm$.r1("B_REQUIRED"));return}var k=new IG$._I3e();j.setLoading(true);k.init(j,{ack:"31",payload:"<smsg><item uid='"+q.metainfo.uid+"' name='"+q.metainfo.name+"' type='"+q.metainfo.type+"' memo='"+c.cubeuid+"' description=''/></smsg>",mbody:q.gx.call(q)},j,j.rs_f1);k._l()},rs_f1:function(u){var v=this,e=IG$._I4c,o=this.down("[name=dateformat]"),j,t,q,p,c=[],l=[],g=0,s,k=v.mobj,d=v.custominfo,b=v.down("[name=dateformatting]").getGroupValue(),h=(b=="sqlfunc"?true:false);for(p=0;p<e.length;p++){e[p].rname=e[p].rname||e[p].name;e[p].dname=IRm$.r1("B_"+e[p].rname)}c.push("<smsg>");l.push("<smsg>");for(p=0;p<e.length;p++){j=e[p].name;t=e[p].dname||j;cdatetype="";if(v.down("[name=datediv_"+j+"]").getValue()==true){s=d[j];t=s?s.name||t:t;if(j=="CUSTOM"){cdatetype=v.down("[name=customdatetype]").getValue()}c.push("<item "+IG$._I30({uid:(s&&s.uid?s.uid:k.metainfo.nodepath+"/"+t),pid:v.uid,name:t,type:"CustomMetric"})+"/>");l.push("<item "+IG$._I30({uid:(s&&s.uid?s.uid:k.metainfo.nodepath+"/"+t),pid:v.uid,name:t,type:"CustomMetric"})+">");l.push("<Fields>");if(k.objinfo&&k.objinfo.fieldid){l.push("<item "+IG$._I30({uid:k.objinfo.fieldid,name:k.objinfo.fieldname,nodepath:k.objinfo.fieldpath||"",type:"Metric"})+"></item>")}else{l.push("<item "+IG$._I30({uid:k.metainfo.uid,name:k.metainfo.name,nodepath:k.metainfo.nodepath,type:k.metainfo.type})+"></item>")}l.push("</Fields>");l.push("<CustomMetricInfo "+IG$._I30({datedivision:j.toUpperCase(),dateformat:k.objinfo.dateformat,predefinetype:(h==true?"DATE":""),type:(h==true?"CUSTOM_FIELD":"PREDEFINED_FIELD"),customdatetype:cdatetype})+"></CustomMetricInfo>");l.push("<Expression>");l.push((h==true?v.gg(j):""));l.push("</Expression>");l.push("</item>");g++}else{if(d[j]){s=d[j];c.push("<item "+IG$._I30({uid:s.uid,name:s.name,nodepath:s.nodepath})+"/>");l.push("<info "+IG$._I30({option:"delete"})+"/>");g++}}}c.push("</smsg>");l.push("</smsg>");if(g>0){var f=this,a=new IG$._I3e();a.init(f,{ack:"30",payload:c.join(""),mbody:l.join("")},f,f.rs_f2);a._l()}else{this.setLoading(false)}},rs_f2:function(a){var b=this;b.setLoading(false);IG$._I54(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success");b.sK5()},gg:function(h){var e=this,d="",a="auto",g=h.toLowerCase(),c=IG$._I4d[a.toLowerCase()],b=this.down("[name=dateformat]").getValue(),f="";if(c&&c[g]){d=c[g];f="["+e.mobj.objinfo.fieldname+"]";if(b=="EPOCH"){f="FROM_UNIXTIME("+f+")"}d=d.replace(/_date_/g,f)}return d},s1:function(){var b=this,a=b.mobj.objinfo;var c=new IG$._I96({visibleItems:"workspace;folder;metric;custommetric;measuregroupdimension",u5x:{cubebrowse:true,rootuid:a.cubeuid}});c.callback=new IG$._I3d(this,this.P2C);IG$._I_5(this,c)},P2C:function(c){var b=this,a=b.mobj.objinfo;a.fieldid=c.uid;a.fieldname=c.name;b.down("[name=fieldname]").setValue(a.fieldname)},initComponent:function(){var b=this,a=b;b.title=IRm$.r1("T_DM");$s.apply(this,{items:[{xtype:"panel",bodyStyle:"padding:10px",border:0,layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",title:"Date Type",layout:{type:"vbox",align:"stretch"},items:[{xtype:"radiogroup",name:"rg_dateformatting",fieldLabel:"",vertical:true,items:[{boxLabel:"Date Formatting",name:"dateformatting",inputValue:"formatting"},{boxLabel:"SQL Functions",name:"dateformatting",inputValue:"sqlfunc"}],listeners:{change:function(){this.l1()},scope:this}}]},{xtype:"fieldset",layout:"vbox",title:"Input Format",items:[{xtype:"fieldcontainer",layout:"hbox",fieldLabel:"Date Metric",items:[{xtype:"textfield",name:"fieldname",readOnly:true},{xtype:"button",name:"btn_search",text:"..",handler:function(){this.s1()},scope:this}]},{xtype:"combobox",name:"dbtype",hidden:true,fieldLabel:"Database type",valueField:"value",displayField:"label",queryMode:"local",editable:false,store:{xtype:"store",fields:[{name:"label"},{name:"value"}],data:[{label:"Select",value:""},{label:"Auto",value:"auto"},{label:"MySQL",value:"mysql"},{label:"Oracle",value:"oracle"}]}},{xtype:"fieldcontainer",fieldLabel:"Date format",layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",name:"dateformat"},{xtype:"button",text:"Example",name:"ex_format1",menu:{items:[{text:"2001.07.04 AM 12:08:56",value:"yyyy.MM.dd a HH:mm:ss",handler:function(){var c=a.down("[name=dateformat]");c.setValue(this.value)}},{text:"2001-07-04 AM 12:08:56",value:"yyyy-MM-dd a HH:mm:ss",handler:function(){var c=a.down("[name=dateformat]");c.setValue(this.value)}},{text:"Wed, Jul 4, '01",value:"EEE, MMM d, ''yy",handler:function(){var c=a.down("[name=dateformat]");c.setValue(this.value)}},{text:"20010704120856",value:"yyyyMMddHHmmss",handler:function(){var c=a.down("[name=dateformat]");c.setValue(this.value)}},{text:"DATE",value:"DATE",issql:true,hidden:true,handler:function(){var c=a.down("[name=dateformat]");c.setValue(this.value)}},{text:"DATETIME",value:"DATETIME",issql:true,hidden:true,handler:function(){var c=a.down("[name=dateformat]");c.setValue(this.value)}},{text:"TIMESTAMP",value:"TIMESTAMP",issql:true,hidden:true,handler:function(){var c=a.down("[name=dateformat]");c.setValue(this.value)}},{text:"EPOCH time value",value:"EPOCH",issql:true,hidden:true,handler:function(){var c=a.down("[name=dateformat]");c.setValue(this.value)}}]}}]},{xtype:"fieldcontainer",fieldLabel:IRm$.r1("L_GROUP_LEVEL"),name:"datedivision",layout:{type:"vbox",align:"stretch"},defaults:{border:0},border:0,items:[{xtpe:"fieldcontainer",layout:{type:"hbox",align:"stretch"},defaults:{width:120},items:[{xtype:"checkbox",boxLabel:IRm$.r1("B_YEAR"),name:"datediv_YYYY",inputValue:"YYYY"},{xtype:"checkbox",boxLabel:IRm$.r1("B_QUARTER"),name:"datediv_QUARTER",inputValue:"QUARTER"},{xtype:"checkbox",boxLabel:IRm$.r1("B_MONTH"),name:"datediv_MM",inputValue:"MM"}]},{xtpe:"fieldcontainer",layout:{type:"hbox",align:"stretch"},defaults:{width:120},items:[{xtype:"checkbox",boxLabel:IRm$.r1("B_DAY"),name:"datediv_DD",inputValue:"DD"},{xtype:"checkbox",boxLabel:IRm$.r1("B_WEEKMONTH"),name:"datediv_WM",inputValue:"WM"},{xtype:"checkbox",boxLabel:IRm$.r1("B_WEEK"),name:"datediv_WEEK",inputValue:"WEEK"}]},{xtpe:"fieldcontainer",layout:{type:"hbox",align:"stretch"},defaults:{width:120},items:[{xtype:"checkbox",boxLabel:IRm$.r1("B_AMPM"),name:"datediv_AMPM",inputValue:"AMPM"},{xtype:"checkbox",boxLabel:IRm$.r1("B_HOUR"),name:"datediv_HH",inputValue:"HH"},{xtype:"checkbox",boxLabel:IRm$.r1("B_MINUTE"),name:"datediv_MI",inputValue:"MI"}]},{xtpe:"fieldcontainer",layout:{type:"hbox",align:"stretch"},defaults:{width:120},items:[{xtype:"checkbox",boxLabel:IRm$.r1("B_CUSTOM"),name:"datediv_CUSTOM",inputValue:"CUSTOM",listeners:{change:function(g,h,f,c){var e=g.getValue(),d=this.down("[name=customdatetypecontainer]");d.setVisible((e==true?true:false))},scope:this}}]}]},{xtype:"fieldcontainer",fieldLabel:IRm$.r1("B_CUSTOM"),name:"customdatetypecontainer",layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",name:"customdatetype"},{xtype:"button",text:"Example",name:"ex_format2",menu:{items:[{text:"2001.07.04 AM 12:08:56",value:"yyyy.MM.dd a HH:mm:ss",handler:function(){var c=a.down("[name=customdatetype]");c.setValue(this.value)}},{text:"2001-07-04 AM 12:08:56",value:"yyyy-MM-dd a HH:mm:ss",handler:function(){var c=a.down("[name=customdatetype]");c.setValue(this.value)}},{text:"Wed, Jul 4, '01",value:"EEE, MMM d, ''yy",handler:function(){var c=a.down("[name=customdatetype]");c.setValue(this.value)}},{text:"20010704120856",value:"yyyyMMddHHmmss",handler:function(){var c=a.down("[name=customdatetype]");c.setValue(this.value)}}]}}]}]}]}],buttons:["->",{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CLOSE"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(c){this._IFd()},scope:this}});IG$.M$dam.superclass.initComponent.apply(this,arguments)}});IG$._If8=function(){};IG$._If8.prototype={m1$17:function(q){var w=this,a,h,x,o,l,d,c,k,u,t;w.group={groupmin:0,groupmax:0,stepinterval:10,groupminlabel:"Under %MIN",groupmaxlabel:"Over %MAX",grouplabel:"%MIN - %MAX",groupformat:"#,###"};w.lnk={l_tp:"DRILL",l_nm:null,l_elnk:null,l_elnk_tgt:null,l_rpt_name:null,l_rpt_uid:null,l_rpt_tmpl:null};w.objectinfo={};w.cubeinfo={styles:[]};a=IG$._I18(q,"/smsg/item");w.iteminfo=IG$._I1c(a);h=IG$._I18(q,"/smsg/item/objinfo");if(h){w.objectinfo=IG$._I1c(h)}h=IG$._I18(q,"/smsg/item/Fields");w.fields=[];d=IG$._I26(h);for(o=0;o<d.length;o++){w.fields.push(IG$._I1c(d[o]))}c=IG$._I18(q,"/smsg/item/cubeinfo");if(c){u=IG$._I18(c,"AppStyle/Default");if(u){t=IG$._I26(u);for(o=0;o<t.length;o++){w.cubeinfo.styles.push({name:IG$._I1b(t[o],"name"),type:"appbase"})}}u=IG$._I18(c,"AppStyle/Custom");if(u){t=IG$._I26(u);for(o=0;o<t.length;o++){w.cubeinfo.styles.push({name:IG$._I1b(t[o],"name"),type:"appcustom"})}}u=IG$._I18(c,"CubeStyle/Custom");if(u){t=IG$._I26(u);for(o=0;o<t.length;o++){w.cubeinfo.styles.push({name:IG$._I1b(t[o],"name"),type:"cubestyle"})}}}c=IG$._I18(a,"CustomMetricInfo");w.groupfilter=[];if(c){w.metrictype=IG$._I1b(c,"type");w.predefinetype=IG$._I1b(c,"predefinetype");w.dateformat=IG$._I1b(c,"dateformat");w.datedivision=IG$._I1b(c,"datedivision");w.customdatetype=IG$._I1b(c,"customdatetype");var b=IG$._I18(c,"Filters");if(b){var s=IG$._I26(b);for(o=0;o<s.length;o++){var e={};e.name=IG$._I1b(s[o],"title");e.operator=IG$._I1b(s[o],"operator");e.values=[];e.value="";var g=IG$._I18(s[o],"Values");if(g){var p=IG$._I26(g);for(l=0;l<p.length;l++){var f={code:null,value:null};var n=IG$._I18(p[l],"code");if(n){f.code=IG$._I24(n)}n=IG$._I18(p[l],"text");if(n){f.text=IG$._I24(n)}if(l==0){e.value=f.text||f.code}else{e.value+=","+(f.text||f.code)}e.values.push(f)}}w.groupfilter.push(e)}}b=IG$._I18(c,"OtherGroupValue");w.othergroupvalue=IG$._I24(b);var n=IG$._I18(a,"Expression");w.expression=IG$._I24(n);b=IG$._I18(c,"geocode");if(b){k=IG$._I18(b,"geolat");w.geolat=k?IG$._I1c(k):null;k=IG$._I18(b,"geolng");w.geolng=k?IG$._I1c(k):null}b=IG$._I18(c,"grouping");if(b){IG$._I1f(w.group,b,"groupmin;groupmax;stepinterval","i");IG$._I1f(w.group,b,"groupminlabel;groupmaxlabel;grouplabel;groupformat","s")}b=IG$._I18(c,"link");if(b){w.lnk.l_tp=IG$._I1b(b,"type")||"DRILL";$.each(["l_nm","l_rpt_tmpl","l_elnk","l_elnk_tgt","l_rpt_name","l_rpt_uid"],function(v,j){w.lnk[j]=IG$._I1a(b,j)})}}},TX:function(){var e=this,c,a,b,d;d="<smsg><item uid='"+e.iteminfo.uid+"' name='"+e.iteminfo.name+"' type='"+e.iteminfo.type+"'>";if(e.objectinfo){d+="<objinfo"+IG$._I21(e.objectinfo)+"/>"}d+="<Fields>";for(c=0;c<e.fields.length;c++){d+="<item name='"+e.fields[c].name+"' uid='"+e.fields[c].uid+"' type='"+e.fields[c].type+"' nodepath='"+e.fields[c].nodepath+"'/>"}d+="</Fields>";d+="<CustomMetricInfo type='"+(e.metrictype||"")+"'";d+=" predefinetype='"+(e.predefinetype||"")+"'";d+=" dateformat='"+(e.dateformat||"")+"'";d+=" datedivision='"+(e.datedivision||"")+"'";d+=" customdatetype='"+(e.customdatetype||"")+"'";d+=">";if(e.groupfilter&&e.groupfilter.length>0){d+="<Filters>";for(c=0;c<e.groupfilter.length;c++){b=e.groupfilter[c];d+="<Filter title='"+b.name+"' operator='"+b.operator+"'>";d+="<Values>";for(a=0;a<b.values.length;a++){if(b.values[a].code||b.values[a].text){d+="<Value>";if(b.values[a].code){d+="<code><![CDATA["+b.values[a].code+"]]></code>"}if(b.values[a].text){d+="<text><![CDATA["+b.values[a].text+"]]></text>"}d+="</Value>"}}d+="</Values>";d+="</Filter>"}d+="</Filters>"}d+="<OtherGroupValue>"+(e.othergroupvalue||"")+"</OtherGroupValue>";d+="<geocode>";if(e.geolat&&e.geolat.uid){d+="<geolat"+IG$._I21(e.geolat,"uid;type;name")+"/>"}if(e.geolng&&e.geolng.uid){d+="<geolng"+IG$._I21(e.geolng,"uid;type;name")+"/>"}d+="</geocode>";if(e.group){d+="<grouping ";d+=IG$._I20(e.group,"groupmin;groupmax;stepinterval","i");d+=IG$._I20(e.group,"groupminlabel;groupmaxlabel;grouplabel;groupformat","s");d+="></grouping>"}if(e.lnk){d+="<link type='"+(e.lnk.l_tp||"DRILL")+"'>";$.each(["l_nm","l_rpt_tmpl","l_elnk","l_elnk_tgt","l_rpt_name","l_rpt_uid"],function(g,f){if(e.lnk[f]){d+="<"+f+"><![CDATA["+e.lnk[f]+"]]></"+f+">"}});d+="</link>"}d+="</CustomMetricInfo>";d+="<Expression><![CDATA["+(e.expression||"")+"]]></Expression>";d+="</item></smsg>";return d}};IG$._Ifa=$s.extend($s.formpanel,{uid:this.uid,bodyBorder:false,layout:"fit",lX:{},_ILa:this._ILa,cdt:function(){var d=this,b=d.down("[name=optdateformat]"),a=d.down("[name=dateformat]"),c=b.getValue();a.setValue(c)},_IFe:function(){var b=this,d=new IG$._I3e(),a=b.down("[name=optdateformat]"),c=b.down("[name=metrictype]");a.on("change",function(h,e,g,f){b.cdt.call(b)});c.setValue("CUSTOM_FIELD");c.on("change",function(k,f,j){var g=b.ownerCt.down("[name=meT]"),e=b.down("[name=metrictype]"),h=e.getValue();if(g&&h){switch(h){case"CUSTOM_FIELD":g.getLayout().setActiveItem(0);break;case"GROUP_FIELD":g.getLayout().setActiveItem(1);break;case"PREDEFINED_FIELD":g.getLayout().setActiveItem(2);b.mu$10();break;case"GEO_FIELD":g.getLayout().setActiveItem(3);break;case"RANGE_FIELD":g.getLayout().setActiveItem(4);break;case"LINK_FIELD":g.getLayout().setActiveItem(5);break}}});d.init(b,{ack:"5",payload:IG$._I2d({uid:this.uid}),mbody:IG$._I2e({option:"diagnostics"})},b,b.rs_sK5,null);d._l()},rs_sK5:function(b){var e=this,f=[],c,d,a=e.down("[name=optstyle]");d=e.clItem=new IG$._If8();e.clItem.m1$17(b);f.push({disp:"--- select ---",name:"",type:""});for(c=0;c<d.cubeinfo.styles.length;c++){f.push({disp:d.cubeinfo.styles[c].name,name:d.cubeinfo.styles[c].name,type:d.cubeinfo.styles[c].type})}a.store.loadData(f);a.setValue(d.objectinfo.itemstyle||"");e.m1$18();if(d.lnk.l_rpt_uid){e.rL(d.lnk.l_rpt_uid)}},rL:function(a){var c=this,b=new IG$._I3e();b.init(c,{ack:"5",payload:IG$._I2d({uid:a}),mbody:IG$._I2e({option:"diagnostics"})},c,function(k){var l=this,f=IG$._I18(k,"/smsg/item"),j=IG$._I18(k,"/smsg/item/ExportOption/otmpl"),d,h,e,n=l.down("[name=l_rpt_tmpl]"),g=[{disp:"Select Item",seq:""}];if(j){d=IG$._I26(j);for(h=0;h<d.length;h++){e=IG$._I1c(d[h]);e.disp=e.name+(e.description?"-"+e.description+" ":" ")+(e.export_type?"("+e.export_type+")":"");e.seq=""+h;g.push(e)}}n.store.loadData(g);n.setValue(l.clItem&&l.clItem.lnk?l.clItem.lnk.l_rpt_tmpl||"":"")},null);b._l()},mu$10:function(){var f=this,b=f,a=(f.clItem)?f.clItem.fields:null,c=f.down("[name=metrictype]"),g=c.getValue(),e=new IG$._I3e(),d;if(a&&a.length>0&&g&&g=="PREDEFINED_FIELD"){if(f.lX&&f.lX[a[0].uid]){f.mU$10(f.lX[a[0].uid])}else{e.init(b,{ack:"5",payload:IG$._I2d({uid:a[0].uid,type:a[0].type,nodepath:a[0].nodepath}),mbody:IG$._I2e()},b,b.rs_mu$10,null);e._l()}}},rs_mu$10:function(a){var e=this,d=IG$._I18(a,"/smsg/item"),f=IG$._I18(a,"/smsg/item/objinfo"),b,c;if(f){c=IG$._I1b(d,"uid");b=IG$._I1b(f,"dateformat");e.lX[c]={uid:c,dateformat:b};e.mU$10(e.lX[c])}},mU$10:function(d){var c=this,a=c.down("[name=dateformat]"),b=a.getValue();if(d.dateformat!=""&&(b==""||b!=d.dateformat)){a.setValue(d.dateformat)}},m1$18:function(){var a=this,b=new IG$._I3e();b.init(a,{ack:"11",payload:"<smsg><item uid='"+this.uid+"' parenttype='Cube;MCube;DataCube;SQLCube' read='F'/></smsg>",mbody:IG$._I2e({option:"parentcontent"})},a,a.rs_getParentcube,null);b._l()},rs_getParentcube:function(f){var l=this,c=IG$._I18(f,"/smsg"),h;if(c){h=IG$._I17(c);if(h){l.cubeuid=IG$._I1b(h,"uid")}}switch(l.clItem.metrictype){case"CUSTOM_FIELD":l.down("[name=metrictype]").setValue("CUSTOM_FIELD");break;case"GROUP_FIELD":l.down("[name=metrictype]").setValue("GROUP_FIELD");break;case"PREDEFINED_FIELD":l.down("[name=metrictype]").setValue("PREDEFINED_FIELD");break;case"GEO_FIELD":l.down("[name=metrictype]").setValue("GEO_FIELD");break;case"RANGE_FIELD":l.down("[name=metrictype]").setValue("RANGE_FIELD");break;case"LINK_FIELD":l.down("[name=metrictype]").setValue("LINK_FIELD");break}IG$._I2c(l,"expression","s",l.clItem.expression||"");IG$._I2c(l,"datagrid","dg",l.clItem.fields);IG$._I2c(l,"groupdatagrid","dg",l.clItem.groupfilter);IG$._I2c(l,"groupfielditem","s",(l.clItem.fields.length>0)?l.clItem.fields[0].name:"");IG$._I2c(l,"predefinefield","s",(l.clItem.fields.length>0)?l.clItem.fields[0].name:"");IG$._I2c(l,"rangefield","s",(l.clItem.fields.length>0)?l.clItem.fields[0].name:"");var j=l.clItem.objectinfo.sortorder||"",b=l.clItem.objectinfo.sorttype||"",k=l.down("[name=optsortdir]"),e=l.down("[name=optsorttype]");k.setValue({cb_sortdir:[j]});e.setValue({cb_sorttype:[b]});var n=l.down("[name=dateformat]"),o=l.down("[name=optdateformat]"),a=l.down("[name=datedivision]"),g=l.down("[name=customdatetype]"),d=l.down("[name=othergroupvalue]");o.setValue(l.clItem.dateformat||"");n.setValue(l.clItem.dateformat||"");a.setValue({datediv:l.clItem.datedivision});g.setValue(l.clItem.customdatetype||"");d.setValue(l.clItem.othergroupvalue);l.down("[name=geolat]").setValue(l.clItem.geolat?l.clItem.geolat.name:"");l.down("[name=geolng]").setValue(l.clItem.geolng?l.clItem.geolng.name:"");l.down("[name=cmap_disp]").setValue(l.clItem.objectinfo.cmap_disp||"");l.f_="groupmin;groupmax;stepinterval;groupminlabel;groupmaxlabel;grouplabel;groupformat".split(";");$.each(l.f_,function(q,p){var s=l.down("[name="+p+"]");s.setValue(l.clItem.group[p])});if(l.clItem.lnk){$.each(["l_tp","l_nm","l_rpt_tmpl","l_elnk","l_elnk_tgt","l_rpt_name","l_rpt_uid"],function(q,p){var s=l.down("[name="+p+"]");s.setValue(l.clItem.lnk[p])})}},_IFf:function(){var n=this,e=n.clItem,l=n.down("[name=cb_sortdir]"),k=l.getGroupValue(),o=n.down("[name=cb_sorttype]"),a=n.down("[name=cb_sorttype]").getGroupValue(),g,f,s=n.down("[name=groupdatagrid]"),q=n.down("[name=datagrid]"),h=s.store,c,u,b,t,j,p;e.objectinfo.sortorder=(k=="")?null:k;e.objectinfo.sorttype=(a=="")?null:a;e.expression=n.down("[name=expression]").getValue();e.metrictype=n.down("[name=metrictype]").getValue();e.dateformat=n.down("[name=dateformat]").getValue();e.datedivision=n.down("[name=datedivision]").getValue().datediv;e.othergroupvalue=n.down("[name=othergroupvalue]").getValue();e.customdatetype=n.down("[name=customdatetype]").getValue();e.objectinfo.itemstyle=n.down("[name=optstyle]").getValue();e.groupfilter=[];for(f=0;f<h.data.items.length;f++){c=h.data.items[f];u={name:c.get("name"),values:[]};u.operator=c.get("operator");u.values=c.data.values;e.groupfilter.push(u)}if(e.metrictype=="CUSTOM_FIELD"){n.clItem.fields=[];for(f=0;f<q.store.data.items.length;f++){j=q.store.data.items[f].data;p={uid:j.uid,name:j.name,nodepath:j.nodepath,memo:j.memo,type:j.type};n.clItem.fields.push(p)}}$.each(n.f_,function(v,d){var w=n.down("[name="+d+"]");n.clItem.group[d]=w.getValue()});n.clItem.lnk=n.clItem.lnk||{};$.each(["l_tp","l_nm","l_rpt_tmpl","l_elnk","l_elnk_tgt","l_rpt_name","l_rpt_uid"],function(v,d){var w=n.down("[name="+d+"]");n.clItem.lnk[d]=w.getValue()});g=n.clItem.TX();n.sK6(n.uid,g)},sK6:function(b,d){var a=this;var c=new IG$._I3e();c.init(a,{ack:"31",payload:IG$._I2d({uid:b}),mbody:d},a,a.rs_sK6,null);c._l()},rs_sK6:function(a){var b=this;IG$._I54(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success");b.wd._IG0.call(b.wd)},selectItem:function(a){var b=this,c=new IG$._I96({multiselect:a=="customfield"?1:0,visibleItems:a=="codemap"?"workspace;folder;codemap":"workspace;folder;metric;tabdimension;measuregroupdimension;custommetric",u5x:{cubebrowse:true,rootuid:a=="codemap"?"/SYS_Lookup":b.cubeuid},callback:new IG$._I3d(b,b.P2C,a)});IG$._I_5(b,c)},s2:function(a){var b=this,c=new IG$._I96({multiselect:0,visibleItems:"workspace;folder;report",u5x:{rootuid:null},callback:new IG$._I3d(b,function(e){var d=this;if(a=="l_rpt"){d.down("[name=l_rpt_uid]").setValue(e.uid);d.down("[name=l_rpt_name]").setValue(e.name);d.rL(e.uid)}})});IG$._I_5(b,c)},P2C:function(b,a){var f=this,e=(a=="customfield"?null:b);if(a=="geolat"||a=="geolng"){if(a=="geolat"){f.clItem.geolat={uid:e.uid,name:e.name};f.down("[name=geolat]").setValue(e.name)}else{if(a=="geolng"){f.clItem.geolng={uid:e.uid,name:e.name};f.down("[name=geolng]").setValue(e.name)}}}else{if(a=="customfield"){var d=f.down("[name=datagrid]"),c,h,g=false;$.each(b,function(j,n){var l,p,o=false;for(l=0;l<d.store.data.items.length;l++){p=d.store.data.items[l];if(p.get("uid")==n.uid){o=true;break}}if(o==false){d.store.add(n)}})}else{if(a=="codemap"){f.clItem.objectinfo.cmap_uid=e.uid;f.clItem.objectinfo.cmap_disp=e.name;f.down("[name=cmap_disp]").setValue(e.name)}else{if(f.clItem.fields.length>0){f.clItem.fields[0]=e}else{f.clItem.fields.push(e)}IG$._I2c(f,a,"s",e.name);f.mu$10()}}}},m1$19:function(){var c=this,a={},b=c.down("[name=groupdatagrid]"),d=b.store;d.add(a)},m1$20:function(b,a){var c=this;if(c.clItem.fields.length>0){var d=c.clItem.fields[0];var e=new IG$._Iac({field:d,callback:new IG$._I3d(c,c.rs_m1$20,[b,a])});e.show()}},rs_m1$20:function(c,f){var d=f[0],a=f[1],e="",b;d.values=c;for(b=0;b<c.length;b++){e+=(b==0)?(c[b].text||c[b].code):", "+(c[b].text||c[b].code)}a.set("value",e)},mU$1:function(d){var f=this,e=f.down("[name=expression]"),b=e.inputEl.dom,j=e.getRawValue(),h=-1,g=-1,a,c;d="["+d+"]";if(j.length>0){var l=-1,k=-1;a=$(b).getSelection();if(a.length==0){for(c=a.start;c>=0;c--){if(j.charAt(c)=="["){l=c;break}else{if(j.charAt(c)=="]"||j.charAt(c)==")"||j.charAt(c)=="("){break}}}if(l>-1){for(c=a.end;c<j.length;c++){if(j.charAt(c)=="]"){k=c+1;break}else{if(j.charAt(c)=="["||j.charAt(c)==")"||j.charAt(c)=="("){break}}}}}else{if(a.start-1>-1&&a.end<j.length&&j.charAt(a.start-1)=="["&&j.charAt(a.end)=="]"){a.start-=1;a.end+=1}}if(l==-1||k==-1){l=a.start;k=a.end}j=j.substring(0,l)+d+j.substring(k,j.length);h=l;g=l+d.length}else{j=d;h=0;g=j.length}e.setValue(j);if(h>-1&&g>h){e.selectText(h,g)}},initComponent:function(){this.items=[{xtype:"tabpanel",items:[{xtype:"form",layout:{type:"vbox",align:"stretch"},title:"General Options",bodyStyle:"padding: 5px",items:[{name:"metrictype",xtype:"combobox",fieldLabel:"Metric Type",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:IRm$.r1("L_CUSTOM_FIELD"),value:"CUSTOM_FIELD"},{name:IRm$.r1("L_GROUP_FIELD"),value:"GROUP_FIELD"},{name:IRm$.r1("L_PREDEFINED_FIELD"),value:"PREDEFINED_FIELD"},{name:IRm$.r1("L_GEO_FIELD"),value:"GEO_FIELD"},{name:IRm$.r1("L_RANGE_FIELD"),value:"RANGE_FIELD"},{name:IRm$.r1("L_LINK_FIELD"),value:"LINK_FIELD"}]}},{xtype:"panel",name:"meT",activeTab:0,flex:1,headerPosition:"right",tabPosition:"bottom",preventHeader:true,plain:true,layout:"card",activeItem:0,defaults:{bodyPadding:10},items:[{xtype:"panel",border:false,defaultType:"textfield",layout:{type:"vbox",align:"stretch"},defaults:{anchor:"100%"},fieldDefaults:{labelWidth:60},items:[{name:"expression",labelWidth:60,fieldLabel:IRm$.r1("L_SYNTAX"),xtype:"textarea"},{xtype:"displayfield",value:IRm$.r1("L_CM_DISP_1")},{xtype:"gridpanel",flex:1,store:{fields:[{name:"name"},{name:"type"},{name:"delete"},{name:"nodepath"},{name:"uid"},{name:"memo"}]},name:"datagrid",stateful:true,height:120,columns:[{text:IRm$.r1("B_NAME"),flex:1,sortable:false,dataIndex:"name"},{text:IRm$.r1("B_TYPE"),flex:1,sortable:false,dataIndex:"type"},{xtype:"actioncolumn",width:50,items:[{iconCls:"icon-grid-delete",tooltip:"Delete item",handler:function(c,e,b){var a=c.store,d=a.getAt(e);a.removeAt(e)}}]}],viewConfig:{stripeRows:true,plugins:{ptype:"gridviewdragdrop",ddGroup:"_I$RD_G_"},listeners:{beforedrop:function(c,e,h,l,k){var b=false,g,f,j=false,a=(e.records&&e.records.length>0)?e.records[0]:null,d=(a)?a.get("type"):null,n;(this==e.view)?e.copy=false:e.copy=true;g=(h)?this.panel.store.indexOf(h):0;if(d=="Metric"){for(f=0;f<this.store.data.items.length;f++){n=this.store.data.items[f];if(n.get("uid")==a.data.uid){j=true;break}}if(j==false){this.store.add(a.data)}}return b},drop:function(c,d,e,a){var b=e?" "+a+" "+e.get("name"):" on empty view";return false}}},listeners:{itemdblclick:function(b,a,f,c,e,d){this.mU$1(a.data.name)},scope:this}},{xtype:"container",layout:{type:"hbox"},items:[{xtype:"displayfield",flex:1,value:IRm$.r1("L_CD_DISP_2")},{xtype:"button",text:"Add",handler:function(){this.selectItem("customfield")},scope:this}]}]},{xtype:"panel",border:false,layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch"},fieldLabel:IRm$.r1("L_BASE_METRIC"),items:[{xtype:"textfield",hideLabel:true,flex:1,name:"groupfielditem",allowBlack:false},{xtype:"button",text:"..",handler:function(){this.selectItem("groupfielditem")},scope:this}]},{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"grid",flex:1,store:{fields:[{name:"name"},{name:"operator"},{name:"opname"},{name:"value"},{name:"values"},{name:"delete"}]},name:"groupdatagrid",stateful:true,plugins:[{ptype:"cellediting",clicksToEdit:1}],columns:[{text:IRm$.r1("B_NAME"),flex:1,sortable:false,dataIndex:"name",field:{allowBlank:false}},{text:IRm$.r1("L_CONDITION"),flex:1,sortable:false,dataIndex:"operator",field:{xtype:"combobox",queryMode:"local",displayField:"name",labelField:"name",valueField:"value",editable:false,autoSelect:true,store:{fields:["name","value"],data:[{name:"Like",value:"like"},{name:"=",value:"eq"},{name:">",value:"gt"},{name:"<",value:"lt"},{name:">=",value:"gte"},{name:"<=",value:"lte"},{name:"In",value:"in"},{name:"Except",value:"except"}]}}},{text:IRm$.r1("B_VALUE"),flex:1,sortable:false,dataIndex:"value",editor:{clickToEdit:false,isvalue:true}},{xtype:"actioncolumn",width:50,items:[{iconCls:"icon-grid-delete",tooltip:IRm$.r1("L_REMOVE"),handler:function(c,e,b){var a=c.store,d=a.getAt(e);a.removeAt(e)},scope:this},{iconCls:"icon-grid-config",tooltip:IRm$.r1("L_EDIT"),handler:function(c,e,b){var a=c.store,d=a.getAt(e);this.m1$20(d.data,d)},scope:this}]}],viewConfig:{stripeRows:true},listeners:{itemdblclick:function(b,a,f,c,e){var d=a.data,g=a.get("operator");if(d&&(g=="in"||g=="except")){this.m1$20(d,a)}},edit:function(f,h){var b=f.grid,a=b.store.data.items[h.rowIdx],d,c,g;if(h.colIdx==2){a.data.values=[];g=h.value.split(",");for(d=0;d<g.length;d++){c=IG$.trim12(g[d]);if(c){a.data.values.push({code:c,text:c})}}}},scope:this}},{xtype:"fieldcontainer",layout:{type:"vbox",pack:"center"},items:[{xtype:"button",iconCls:"icon-toolbar-add",tooltip:IRm$.r1("L_ADD_CONDITION"),handler:function(){this.m1$19()},scope:this},{xtype:"button",iconCls:"icon-toolbar-moveup",tooltip:"Move Up",handler:function(){var b=this.down("[name=groupdatagrid]"),c=b.getSelectionModel().getSelection(),d,a;if(c&&c.length==1){d=c[0];a=b.store.indexOf(d);if(a>0){b.store.remove(d);b.store.insert(a-1,d)}}},scope:this},{xtype:"button",iconCls:"icon-toolbar-movedown",tooltip:"Move Down",handler:function(){var b=this.down("[name=groupdatagrid]"),c=b.getSelectionModel().getSelection(),d,a;if(c&&c.length==1){d=c[0];a=b.store.indexOf(d);if(a+1<b.store.data.items.length){b.store.remove(d);b.store.insert(a+1,d)}}},scope:this}]}]},{xtype:"textfield",name:"othergroupvalue",fieldLabel:IRm$.r1("L_OTHER_VALUE")}]},{xtype:"panel",border:false,defaultType:"textfield",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"fieldcontainer",layout:{type:"hbox"},fieldLabel:IRm$.r1("L_BASE_METRIC"),items:[{xtype:"textfield",hideLabel:true,name:"predefinefield",allowBlack:false},{xtype:"button",text:"..",handler:function(){this.selectItem("predefinefield")},scope:this}]},{xtype:"fieldcontainer",title:IRm$.r1("L_DATE_OPTION"),defaultType:"textfield",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"combobox",name:"optdateformat",fieldLabel:"Date format example",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"Select",value:""},{name:"2001.07.04 AM 12:08:56",value:"yyyy.MM.dd a HH:mm:ss"},{name:"2001-07-04 12:08:56",value:"yyyy-MM-dd HH:mm:ss"},{name:"2001-07-04 AM 12:08",value:"yyyy-MM-dd a HH:mm"},{name:"Wed, Jul 4, '01",value:"EEE, MMM d, ''yy"},{name:"20010704120856",value:"yyyyMMddHHmmss"}]}},{name:"dateformat",fieldLabel:IRm$.r1("L_DATE_FORMAT"),xtype:"textfield",value:""},{fieldLabel:IRm$.r1("L_GROUP_LEVEL"),name:"datedivision",xtype:"radiogroup",columns:3,$h:120,plain:true,items:[{boxLabel:IRm$.r1("B_YEAR"),name:"datediv",inputValue:"YYYY",checked:true},{boxLabel:IRm$.r1("B_QUARTER"),name:"datediv",inputValue:"QUARTER"},{boxLabel:IRm$.r1("B_MONTH"),name:"datediv",inputValue:"MM"},{boxLabel:IRm$.r1("B_DAY"),name:"datediv",inputValue:"DD"},{boxLabel:IRm$.r1("B_WEEKMONTH"),name:"datediv",inputValue:"WM"},{boxLabel:IRm$.r1("B_WEEK"),name:"datediv",inputValue:"WEEK"},{boxLabel:IRm$.r1("B_AMPM"),name:"datediv",inputValue:"AMPM"},{boxLabel:IRm$.r1("B_HOUR"),name:"datediv",inputValue:"HH"},{boxLabel:IRm$.r1("B_MINUTE"),name:"datediv",inputValue:"MI"},{boxLabel:IRm$.r1("B_CUSTOM"),name:"datediv",inputValue:"CUSTOM"}],listeners:{change:function(e,f,d,a){var c=e.getValue().datediv,b=this.down("[name=customdatetype]");b.setVisible((c=="CUSTOM"?true:false))},scope:this}},{fieldLabel:IRm$.r1("B_CUSTOM"),name:"customdatetype",xtype:"textfield",hidden:true}]}]},{xtype:"panel",border:false,defaultType:"textfield",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"fieldcontainer",fieldLabel:IRm$.r1("L_LATITUDE"),layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",flex:1,name:"geolat"},{xtype:"button",text:"..",handler:function(){this.selectItem("geolat")},scope:this}]},{xtype:"fieldcontainer",fieldLabel:IRm$.r1("L_LONGITUDE"),layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",flex:1,name:"geolng"},{xtype:"button",text:"..",handler:function(){this.selectItem("geolng")},scope:this}]}]},{xtype:"panel",layout:"anchor",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"fieldcontainer",layout:{type:"hbox"},fieldLabel:IRm$.r1("L_BASE_METRIC"),items:[{xtype:"textfield",hideLabel:true,name:"rangefield",allowBlack:false},{xtype:"button",text:"..",handler:function(){this.selectItem("rangefield")},scope:this}]},{xtype:"fieldset",title:"Grouping",layout:"anchor",padding:"3 5",items:[{name:"groupmin",fieldLabel:"Start minimum",xtype:"numberfield",value:-1,minValue:-1,maxValue:100000000,allowDecimals:true,decimalPrecision:2,step:1},{name:"groupmax",fieldLabel:"End Maximum",xtype:"numberfield",value:-1,minValue:-1,maxValue:100000000,allowDecimals:true,decimalPrecision:2,step:1},{name:"stepinterval",fieldLabel:"Step Interval",xtype:"numberfield",value:-1,minValue:-1,maxValue:10,allowDecimals:true,decimalPrecision:2,step:1},{name:"groupminlabel",fieldLabel:"Under minimum",xtype:"textfield"},{name:"groupmaxlabel",fieldLabel:"Over maximum",xtype:"textfield"},{name:"grouplabel",fieldLabel:"Label text",xtype:"textfield"},{xtype:"displayfield",value:"Use keyword %MIN %MAX for range labeling"},{xtype:"textfield",name:"groupformat",fieldLabel:"Numeric Format"}]}]},{xtype:"panel",layout:"anchor",autoScroll:true,items:[{xtype:"combobox",name:"l_tp",fieldLabel:IRm$.r1("L_LNK_TP"),queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:IRm$.r1("L_LNK_DRILL"),value:"DRILL"},{name:IRm$.r1("L_LNK_DOC"),value:"DOC"},{name:IRm$.r1("L_LNK_EXT"),value:"EXTERNAL"}]},listeners:{change:function(c){var f=this,d=f.down("[name=l_nm]"),b=f.down("[name=l_tr]"),a=f.down("[name=l_elnk]"),j=f.down("[name=l_elnk_tgt]"),g=f.down("[name=l_rpt_tmpl]"),h=c.getValue(),e=h=="EXTERNAL";b.setVisible(!e);g.setVisible(h=="DOC");a.setVisible(e);j.setVisible(e)},scope:this}},{xtype:"textfield",name:"l_nm",fieldLabel:"Display Name"},{xtype:"fieldcontainer",fieldLabel:"Target Report",name:"l_tr",hidden:true,layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",hidden:true,name:"l_rpt_uid"},{xtype:"textfield",name:"l_rpt_name",flex:1},{xtype:"button",name:"..",handler:function(){this.s2("l_rpt")},scope:this}]},{xtype:"combobox",name:"l_rpt_tmpl",fieldLabel:IRm$.r1("L_LNK_TMPL"),queryMode:"local",displayField:"disp",valueField:"seq",editable:false,autoSelect:true,store:{xtype:"store",fields:["disp","seq"]}},{xtype:"textfield",name:"l_elnk_tgt",fieldLabel:IRm$.r1("L_LNK_TGT"),hidden:true},{xtype:"textarea",fieldLabel:IRm$.r1("L_LNK_URL"),anchor:"100%",hidden:true,name:"l_elnk"}]}]},{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch"},fieldLabel:IRm$.r1("L_CODE_FIELD"),items:[{xtype:"textfield",name:"cmap_disp",readOnly:true,flex:1},{xtype:"button",text:"..",handler:function(){this.selectItem("codemap")},scope:this},{xtype:"button",text:IRm$.r1("B_CLEAR"),handler:function(){var a=this;a.down("[name=cmap_disp]").setValue("");a.clItem.objectinfo.cmap_disp="";a.clItem.objectinfo.cmap_uid=""},scope:this}]},{xtype:"fieldset",title:IRm$.r1("L_STYLE_OPTION"),layout:"anchor",padding:"3 5",items:[{xtype:"combobox",name:"optstyle",fieldLabel:IRm$.r1("L_BASE_STYLE"),queryMode:"local",displayField:"disp",valueField:"name",editable:false,autoSelect:true,store:{xtype:"store",fields:["disp","name","type"]}}]}]},{xtype:"panel",title:IRm$.r1("L_OTHER_OPTION"),bodyStyle:"padding: 5px",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"fieldset",title:IRm$.r1("L_SORT_SEL"),layout:"anchor",padding:"0 5",defaults:{anchor:"100%"},items:[{xtype:"radiogroup",name:"optsortdir",fieldLabel:IRm$.r1("L_SORT_ORD"),padding:"0 5",plain:true,items:[{boxLabel:IRm$.r1("B_DEFAULT"),name:"cb_sortdir",inputValue:"",checked:true},{boxLabel:IRm$.r1("B_ASC"),name:"cb_sortdir",inputValue:"asc"},{boxLabel:IRm$.r1("B_DSC"),name:"cb_sortdir",inputValue:"desc"}]},{xtype:"radiogroup",name:"optsorttype",fieldLabel:IRm$.r1("L_SORT_TP"),padding:"0 5",plain:true,items:[{boxLabel:IRm$.r1("B_DEFAULT"),name:"cb_sorttype",inputValue:"",checked:true},{boxLabel:IRm$.r1("B_STRING"),name:"cb_sorttype",inputValue:"VARCHAR"},{boxLabel:IRm$.r1("B_NUMERIC"),name:"cb_sorttype",inputValue:"NUMBER"}]},{xtype:"fieldcontainer",name:"optdispitem",fieldLabel:IRm$.r1("L_F_DISP"),hidden:true,layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",name:"optdispitemname",flex:1},{xtype:"button",text:"..",handler:function(){this.P2C("optdispitemname")},scope:this},{xtype:"button",text:IRm$.r1("B_CLEAR"),handler:function(){var a=this;a.optdispitemname=null;a.optdispitemuid=null;a.down("[name=optdispitemname]").setValue("")},scope:this}]},{xtype:"fieldcontainer",name:"optsortitem",fieldLabel:IRm$.r1("L_F_SORT"),hidden:true,layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",name:"optsortitemname",flex:1},{xtype:"button",text:"..",handler:function(){this.P2C("optsortitemname")},scope:this},{xtype:"button",text:IRm$.r1("B_CLEAR"),handler:function(){var a=this;a.optsortitemname=null;a.optsortitemuid=null;a.down("[name=optsortitemname]").setValue("")},scope:this}]}]}]}]}];IG$._Ifa.superclass.initComponent.apply(this)},listeners:{afterrender:function(b){var a=this;setTimeout(function(){a._IFe.call(a)},100)}}});IG$._Ie0=$s.extend($s.window,{modal:false,isWindow:true,region:"center",layout:{type:"fit",align:"stretch"},closable:false,resizable:false,width:500,height:480,callback:null,_IG0:function(){this.close();this.callback&&this.callback.execute()},_IFf:function(){this._IH1._IFf.call(this._IH1);this._IG0()},initComponent:function(){this._IH1=new IG$._Ifa({uid:this.uid,writable:this.writable,wd:this});this.title=IRm$.r1("T_CUSTOM_METRIC");$s.apply(this,{defaults:{bodyStyle:"padding:10px"},items:[this._IH1],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}]});IG$._Ie0.superclass.initComponent.apply(this,arguments)}});IG$._I73=$s.extend(IG$._I57,{scroll:false,initialized:false,closable:true,layout:"fit",bodyPadding:5,iconCls:"icon-ing-docdef",curnode:null,cursop:null,_IFd:function(){var a=this;a._m2={};a._m1=false;a.curnode=null;a.cursop=null;a.l1()},l1:function(){var b=this,a=new IG$._I3e();a.init(b,{ack:"25",payload:IG$._I2d({address:"/"}),mbody:IG$._I2e({option:"standard"})},b,b.rs_l1,false);a._l()},rs_l1:function(f){var j=this,c=[],e,h=IG$._I18(f,"/smsg/item"),d,b,l=false,k=j.down("[name=fpool]"),g=j.down("[name=fschema]"),a=j.down("[name=fschema_st]");c.push({name:"Select Database Instance",poolname:""});if(h){d=IG$._I26(h);l=IG$._I83.jS2;for(e=0;e<d.length;e++){b=IG$._I1c(d[e]);if(l==true||(l==false&&b.name.toUpperCase()!="IGCBASE")){c.push({name:b.disp,poolname:b.name,uid:b.uid||"",dbtype:b.dbtype,isuserdb:(b.isuserdb=="T"?true:false),savepwd:(b.isuserdb=="T"&&b.savepwd=="F"?false:true)})}}}k.store.loadData(c);k.setValue("");g.store.loadData([{name:"Select Item",uid:""}]);g.setValue("");a.store.loadData([{name:"Select Item",uid:""}]);a.setValue("");j.fschema_st_=null},l2:function(a,b){var d=this,c=new IG$._I3e(),e={address:"/"+a};if(b){e.uid=b;if(IG$.dbp&&IG$.dbp[a]){e.pwd=IG$.dbp[a]}}d.setLoading(true);c.init(d,{ack:"25",payload:IG$._I2d(e,"uid;address;pwd"),mbody:IG$._I2e({option:"standard"})},d,d.rs_l2,false,a);c._l()},rs_l2:function(f,j){var h=this,a=IG$._I18(f,"/smsg/item"),g=h.down("[name=fschema]"),d,e,b,c=[];if(a){d=IG$._I26(a);for(e=0;e<d.length;e++){b=IG$._I1c(d[e]);b.uid=b.name;c.push(b)}g.store.loadData(c);g.setValue("")}h.l3(j)},l3:function(a){var d=this,c=new IG$._I3e(),b={address:"/"+a,option:"StoredContent"};d.curnode=null;d.cursop=null;d.l99();if(IG$.dbp[a]){b.pwd=IG$.dbp[a]}c.init(d,{ack:"25",payload:IG$._I2d(b,"address;option;pwd"),mbody:IG$._I2e(b)},d,d.rs_l3,false,a);c._l()},rs_l3:function(a){var e=this,f=IG$._I18(a,"/smsg/item"),c=e.down("[name=fschema_st]"),h,b,g=[{name:"Select Item",uid:""}],d;e.down("[name=btn_sname]").setDisabled(true);if(f){e.fschema_st_=IG$._I1c(f);h=IG$._I26(f);for(b=0;b<h.length;b++){d=IG$._I1c(h[b]);g.push(d)}}c.store.loadData(g);c.setValue("")},l4:function(f,c,a){var e=this,g=f.get("nodepath"),d=new IG$._I3e(),h=g.split("/"),b={address:g,option:c,search:a};if(h.length>1&&IG$.dbp[h[1]]){b.pwd=IG$.dbp[h[1]]}e.setLoading(true);d.init(e,{ack:"25",payload:IG$._I2d(b,"address;option;pwd;search"),mbody:IG$._I2e(b)},e,e.rs_l4,false,[f,c]);d._l()},rs_l4:function(j,c){var k=this,d=c[0],h=c[1],b=IG$._I18(j,"/smsg/item"),e,g,f,l=[],a=(h==null?k.down("[name=grid_sc]"):k.down("[name=grid_st]"));k.setLoading(false);if(b){e=IG$._I26(b);for(g=0;g<e.length;g++){f=IG$._I1c(e[g]);f.uid=f.uid||(""+g);f.allow_insert=f.objinfo&&f.objinfo.indexOf("allow_insert=T")>-1;f.allow_insert_desc=f.allow_insert?"Yes":"";l.push(f)}}a.store.loadData(l)},l5:function(b,g,j){var k=this,o=k.down("[name=pnldetail]"),h=b.get("uid"),d=b.get("nodepath"),l=new IG$._I3e(),e=(d?d.split("/"):null),a={address:h,option:g},n={},f,c;o.setVisible(true);h=(g==null)?d:h;a.address=h;if(e&&e.length>1&&IG$.dbp[e[1]]){a.pwd=IG$.dbp[e[1]]}if(j){for(f=0;f<o.store.data.items.length;f++){c=o.store.data.items[f];if(c.get("alias")){n[c.get("name")]=c.get("alias")}}}l.init(k,{ack:"25",payload:IG$._I2d(a,"address;option;pwd"),mbody:IG$._I2e(a)},k,k.rs_l5,false,[b,n,j]);l._l()},rs_l5:function(w,g){var x=this,n=g[0],j=g[1],e=g[2],f=IG$._I18(w,"/smsg/item"),y=IG$._I18(w,"/smsg/item/objinfo"),b,t,s,l=[],c,q=x.down("[name=pnldetail]"),o=n.get("nodepath"),p,z,k,a,v=x.down("[name=allow_insert]"),h=x.down("[name=file_field]"),d=x.down("[name=seq_field]"),u=[{name:"Select Field",value:""}];if(o&&o.indexOf("/")>-1){o=o.substring(o.lastIndexOf("/")+1)}x.setLoading(false);if(y){b=IG$._I1c(y)}q.setTitle("Field Info ["+o+"]");x.curnode=null;x.cursop=null;if(f){x.curnode=n;p=IG$._I1c(f);x.down("[name=edit_sql]").setVisible(p.type=="InlineView");if(p.type=="InlineView"){a=new IG$._Icf();a.sqloption={columns:[],prompts:[]};a.uid=p.uid;a.viewname=p.name;z=IG$._I19(f,"ExecuteSQL");if(z){a.sqloption.dbpool=IG$._I1b(z,"dbpool");k=IG$._I19(z,"SQL");if(k){a.sqloption.sql=IG$._I24(k)}}x.cursop=a}t=IG$._I26(f,"Field");for(s=0;s<t.length;s++){c=IG$._I1c(t[s]);c.dispname=c.name;if(e&&j&&j[c.name]){c.alias=j[c.name]}c.iskey=c.iskey=="T"?true:false;u.push({name:c.name,value:c.name});l.push(c);a&&a.sqloption&&a.sqloption.columns.push(c)}x.curnode.set("fields",l);q.store.loadData(l);v.setValue(p.type!="Table"?false:p.objinfo&&p.objinfo.indexOf("allow_insert=T")>-1);v.setDisabled(p.type!="Table");h.store.loadData(u);h.setValue(b?b.file_field:"");d.store.loadData(u);d.setValue(b?b.seq_field:"")}},l6:function(){var j=this,b=j.down("[name=grid_sc]"),l="<smsg><item option='register'>",e,d,c,h=j._m2,k=new IG$._I3e(),g=0,a=j.down("[name=fschema_st]"),f=a.getValue();j.l99();d=b.getSelectionModel().selected;a.clearInvalid();if(!f){a.markInvalid("Select Item");IG$._I54(ig$.appname,"Select target schema name to register to.",null,null,0,"error");return}if(d.length==0){IG$._I54(ig$.appname,"Search and check table to register.",null,null,0,"error");return}for(e=0;e<d.length;e++){c=d.items[e].get("name");l+="<item pid='"+f+"' name='"+c+"' option='register'";l+="/>"}l+="</item>";if(j._m2){l+="<alias>";$.each(j._m2,function(n,o){l+="<n name='"+n+"'><![CDATA["+o+"]]></n>"});l+="</alias>"}l+="</smsg>";j.setLoading(true);k.init(j,{ack:"25",payload:l,mbody:IG$._I2e()},j,function(n){this._t$("cmd_refresh_table");IG$._I54(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")},false);k._l()},_s1:function(){var e=this,b=e.down("[name=src_keyword]"),f=e.down("[name=fschema]"),a=f.getValue(),c,d;if(!e._c1()){return}for(c=0;c<f.store.data.items.length;c++){if(f.store.data.items[c].get("uid")==a){d=f.store.data.items[c]}}e.l4(d,null,b.getValue())},l7:function(){var e=this,b="<smsg>",g,d=new IG$._I3e(),a=e.down("[name=grid_st]"),g=a.getSelectionModel().selected,c,f=0;e.l99();if(g&&g.length>0){for(c=0;c<g.length;c++){if(g.items[c].get("type")=="Table"||g.items[c].get("type")=="InlineView"){b+="<item address='"+g.items[c].get("uid")+"' option='Clear'/>";f++}}b+="</smsg>";if(f>0){e.setLoading(true);d.init(e,{ack:"25",payload:b,mbody:IG$._I2e()},e,function(h){var j;for(j=g.length-1;j>=0;j--){a.store.remove(g.items[j])}IG$._I54(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")},false);d._l()}}},l8:function(b){var e=this,a,d=e.l98(),c=new IG$._I3e();if(!e.curnode){IG$._I54(ig$.appname,"Click table item to continue.",null,null,1,"alert");return}c.init(e,{ack:"25",payload:IG$._I2d({address:e.curnode.get("uid"),option:"UpdateContent"},"address;option"),mbody:d},e,e.rs_l8,false,b);c._l()},rs_l8:function(a,b){if(!b){this._t$("cmd_refresh_table")}IG$._I54(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")},l98:function(){var f=this,c,b=f.down("[name=pnldetail]").store,a=f.down("[name=allow_insert]").getValue(),d=f.down("[name=file_field]").getValue(),g=f.down("[name=seq_field]").getValue(),e="<smsg><item uid='"+f.curnode.get("uid")+"'>";e+="<objinfo allow_insert='"+(a?"T":"F")+"' file_field='"+(d||"")+"' seq_field='"+(g||"")+"'/>";for(c=0;c<b.data.items.length;c++){e+="<Field "+IG$._I22(b.data.items[c],"nodepath;datasize;datatype;decimaldigits;name;alias;tablename;type")+" iskey='"+(b.data.items[c].get("iskey")==true?"T":"F")+"'/>"}e+="</item></smsg>";return e},l99:function(){var b=this,a=b.down("[name=pnldetail]");a.setVisible(false)},_c1:function(b){var c=this,a=c.down("[name=fpool]"),d=c.down("[name=fschema]");a.clearInvalid();d.clearInvalid();if(!a.getValue()){a.markInvalid("Select Item");return 0}if(!b&&!d.getValue()){d.markInvalid("Select Item");return 0}return 1},_t$:function(t){var x=this,a,v,j,s,b,o,v,a,d,u,n,l,f;switch(t){case"cmd_add_sc":if(!x._c1()){return}if(x.fschema_st_){g=new IG$._I6e({itemtype:"Schema",parentnodepath:x.fschema_st_.nodepath,parentuid:x.fschema_st_.uid,callback:new IG$._I3d(x,function(){x._t$.call(x,"cmd_refresh")})});IG$._I_5(this,g)}break;case"cmd_remove_sc":l=x.down("[name=fschema_st]");if(l.getValue()){IG$._I55(IRm$.r1("B_CONFIRM"),IRm$.r1("B_CD_CHS"),function(z){if(z=="yes"){var y=new IG$._I3e();y.init(x,{ack:"30",payload:IG$._I2d({uid:l.getValue()},"uid"),mbody:IG$._I2e({option:"delete"})},x,function(A){var B=this;B._t$.call(B,"cmd_refresh")},null);y._l()}})}break;case"cmd_save":break;case"cmd_save_field":x.l8(t=="cmd_save_field");break;case"cmd_refresh_field":if(x.curnode){x.l5(x.curnode,null,1)}break;case"cmd_refresh_table":s=x.down("[name=grid_st]");l=x.down("[name=fschema_st]");s.store.loadData([]);x.down("[name=btn_sname]").setDisabled(true);var e=l.getValue();if(e){for(u=0;u<l.store.data.items.length;u++){if(l.store.data.items[u].get("uid")==e){o=l.store.data.items[u];break}}if(o){x.down("[name=btn_sname]").setDisabled(false);x.l4(o,"StoredContent")}}break;case"cmd_refresh":var h=x.down("[name=fpool]").getValue();if(h){x.l3(h)}break;case"cmd_alias":var v=new IG$.A2Tw({callback:new IG$._I3d(x,function(y){x._m2=y;x._m1=true;x.down("[name=m2]").show()})});IG$._I_5(this,v);break;case"cmd_change_schema":var l=x.down("[name=fschema_st]"),p=l.getValue(),f,k,g,u;if(p){for(u=0;u<l.store.data.items.length;u++){if(l.store.data.items[u].get("uid")==p){f=l.store.data.items[u];break}}if(f){g=new IG$._Icd({itemname:f.get("name"),uid:f.get("uid"),itemtype:f.get("type"),_IO5:function(y){var z=this,A=this.down("[name=fitemname]").getValue();z._IG0.call(z);if(z.callback){z.callback.execute({name:A})}},callback:new IG$._I3d(x,function(y){if(y&&y.name){var z=f.get("nodepath");z=z.substring(0,z.lastIndexOf("/"));f.set("name",y.name);f.set("nodepath",z+"/"+y.name);l.setValue(f.get("uid"))}else{x._t$.call(x,"cmd_refresh")}})});IG$._I_5(this,g)}}break;case"cmd_config":break;case"cmd_inlineview":j=x.down("[name=fpool]");s=x.down("[name=grid_st]");d=j.getValue();l=x.down("[name=fschema_st]");var c=l.getValue();if(c){for(u=0;u<l.store.data.items.length;u++){if(l.store.data.items[u].get("uid")==c){f=l.store.data.items[u];break}}}if(d&&f){a=new IG$._Icf();a.sqloption={prompts:[]};a.sqloption.dbpool=d;a.sqloption.schemauid=f.get("uid");a.sqloption.schemaname=f.get("name");v=new IG$._Ib1({wmode:"inlineview",uid:null,_ILb:a,columns:[],callback:new IG$._I3d(x,x.rs_SOp)});IG$._I_5(this,v)}break;case"cmd_edit_sql":if(x.curnode&&x.cursop){a=x.cursop;v=new IG$._Ib1({wmode:"inlineview",uid:x.curnode.get("uid"),_ILb:a,columns:[],callback:new IG$._I3d(x,x.rs_SOp)});IG$._I_5(this,v)}break;case"cmd_rel_field":v=new IG$._I72({uid:x.curnode.get("uid"),isdown:true});IG$._I_5(this,v);break;case"cmd_ref_alias":var q=x.down("[name=pnldetail]"),u,f,w;if(!x._m1){return}for(u=0;u<q.store.data.items.length;u++){f=q.store.data.items[u];w=f.get("name");if(!f.get("alias")&&x._m2[w]){f.set("alias",x._m2[w])}}break;case"cmd_build_model":x._b1();break;case"cmd_export_meta":if(!x._c1(true)){return}IG$._I55(IRm$.r1("T_EXP_MC"),IRm$.r1("T_EXP_MC_Q"),function(F){var y=x,D=[],A=y.down("[name=fschema_st]"),B=new IG$._I3e(),z,E,C;for(z=0;z<A.store.data.items.length;z++){E=A.store.data.items[z];if(E.get("uid")){D.push({uid:E.get("uid"),name:E.get("name"),nodepath:E.get("nodepath"),type:E.get("type")})}}if(D&&D.length&&F=="yes"){C="<smsg>";for(z=0;z<D.length;z++){C+="<item"+IG$._I20(D[z],"uid;nodepath;name;type","s")+"/>"}C+="</smsg>";B.init(y,{ack:"5",payload:C,mbody:IG$._I2e({output:"file"})},y,function(G){var J=IG$._I18(G,"/smsg/item"),I,H;if(J){I=IG$._I1b(J,"luid");H=IG$._I1b(J,"filename");if(I&&H){$.download(ig$.servlet,[{name:"ack",value:"35"},{name:"payload",value:I},{name:"mbody",value:H},{name:"_mts_",value:(IG$._g$a||"")}],"POST")}}},null);B._l()}},x,x);break}},_b1:function(){var e=this,a=e.down("[name=grid_st]"),f=a.getSelectionModel().selected,d,g,b,c;if(!e._c1(true)){return}if(f&&f.length){c="<smsg><info option='build_model'>";c+="<tables>";for(b=0;b<f.length;b++){g=f.items[b];c+="<table name='"+g.get("name")+"' uid='"+g.get("uid")+"'/>"}c+="</tables>";c+="</info></smsg>";d=new IG$._I3e();d.init(e,{ack:"6",payload:IG$._I2d({}),mbody:c},e,function(h){var j=IG$._I7d;j&&j.m1$7.call(j,null,"cubemodel".toLowerCase(),"new model",null,false,true,{_c$:h})},false);d._l()}},rs_SOp:function(k){var l=this,f=k._ILb,j=f.sqloption,n=new IG$._I3e(),b,h="<smsg><item",o="<smsg>",c,a,g=k.uid,e="UpdateContent",d;if(!g){e="UpdateView";d=f.sqloption.schemauid}b="/"+f.sqloption.dbpool+"/"+f.sqloption.schemaname+"/"+f.viewname;h+=" name='"+f.viewname+"'>";if(j.sql&&j.columns.length>0){l.l99();h+="<ExecuteSQL dbpool='"+(j.dbpool||"")+"'>";h+="<SQL><![CDATA["+(j.sqlquery||"")+"]]></SQL>";h+="</ExecuteSQL>";for(c=0;c<j.columns.length;c++){a=j.columns[c];a.nodepath=b+"/"+a.sqlfield;h+="<Field "+IG$._I20(a,"fieldname;nodepath;datasize;datatype;decimaldigits;name;alias;tablename;type","s")+"/>"}h+="</item></smsg>";n.init(l,{ack:"25",payload:IG$._I2d({address:k.uid||b,option:e,pid:d,name:f.viewname},"address;option;pid;name"),mbody:h},l,l.rs_l8,false);n._l()}},r_IMa:function(d,e){var b=this,c=e[0],a=e[1];IG$.dbp[c]=d;b.l2(c,a)},initComponent:function(){var a=this;a.items=[{xtype:"panel",layout:{type:"vbox",align:"stretch"},border:false,items:[{xtype:"container",layout:{type:"vbox"},defaults:{labelWidth:120},items:[{xtype:"combobox",name:"fpool",fieldLabel:"Database Instances",valueField:"poolname",displayField:"name",queryMode:"local",editable:false,store:{fields:["name","poolname","uid","isuserdb","savepwd","dbtype"]},listeners:{change:function(u,f,c,n){var s=this,g=u.getValue();if(g){var v=u.store,l,b,k,j,q;for(k=0;k<v.data.items.length;k++){j=v.data.items[k];if(j.get("poolname")==g){l=j.get("uid");b=j.get("savepwd");q=j;break}}s.__dL=q&&q.get("dbtype")=="57"?1:0;s.down("[name=b_m1]").setVisible(s.__dL==0);s.down("[name=b_m2]").setVisible(s.__dL==0);s.down("[name=allow_insert]").setVisible(s.__dL==0);if(b==false){if(!IG$.dbp[g]){var t=new IG$._Ice({poolname:g,callback:new IG$._I3d(s,s.r_IMa,[g,l])});IG$._I_5(this,t)}else{s.l2(g,l)}}else{s.l2(g,l)}}else{s.__dL=0;s.l99();s.curnode=null;var e=s.down("[name=grid_sc]"),h=s.down("[name=grid_st]"),o=s.down("[name=fschema]"),d=s.down("[name=fschema_st]");e.store.loadData([]);h.store.loadData([]);o.store.loadData([{name:"Select Item",uid:""}]);o.setValue("");d.store.loadData([{name:"Select Item",uid:""}]);d.setValue("");s.fschema_st_=null}},scope:this}},{xtype:"combobox",queryMode:"local",fieldLabel:"Schema",name:"fschema",displayField:"name",valueField:"uid",emptyText:"Select Item",typeAhead:true,forceSelection:false,autoSelect:true,autoScroll:true,store:{fields:["name","uid","nodepath","type"]}}]},{xtype:"panel",flex:1,border:false,layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",name:"grid_sc",flex:1,title:"Database table content",emptyText:IRm$.r1("M_S_S1"),selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell",mode:"MULTI"},store:{fields:["name","type","nodepath","uid","schemaname","dispname","checked"]},tbar:[{xtype:"textfield",name:"src_keyword",fieldLabel:"Search",labelWidth:60,width:160,enableKeyEvents:true,listeners:{keyup:function(c,d,b){if(d.keyCode==13){this._s1()}},scope:this}},{xtype:"button",text:"..",handler:function(){this._s1()},scope:this},"->",{xtype:"button",text:"Register",handler:function(){this.l6()},scope:this}],columns:[{text:IRm$.r1("B_NAME"),flex:1,sortable:true,dataIndex:"name"}]},{xtype:"container",width:10},{xtype:"panel",flex:2,border:false,lselect:false,layout:{type:"vbox",align:"stretch"},items:[{xtype:"gridpanel",name:"grid_st",flex:1,title:"Registered Table",showcheckselect:true,emptyText:IRm$.r1("M_S_S2"),plain:true,store:{showcheckselect:true,fields:["name","type","uid","nodepath","dispname","checked","allow_insert","allow_insert_desc"]},selType:"checkboxmodel",selModel:{mode:"MULTI"},columns:[{text:IRm$.r1("B_NAME"),flex:2,sortable:false,dataIndex:"name",tdCls:"igc-td-link"},{text:"Allow Insert",dataIndex:"allow_insert_desc",width:80},{text:"Alias",flex:1,sortable:false,dataIndex:"alias"}],listeners:{itemclick:function(b,c,l,g,h,j){var k=this,d=c.get("type"),f=k.down("[name=btn_sname]");k.curnode=null;if(d=="Table"||d=="InlineView"){k.l5(c,"StoredContent")}},scope:this},dockedItems:[{xtype:"toolbar",dock:"top",items:[{iconCls:"icon-toolbar-alias",tooltip:"Load alias information",handler:function(){this._t$("cmd_alias")},scope:this},"-",{xtype:"combobox",queryMode:"local",fieldLabel:"Schema",labelAlign:"right",labelWidth:50,name:"fschema_st",editable:false,displayField:"name",valueField:"uid",store:{fields:["name","uid","nodepath","type"],data:[{name:"Select Item",uid:""}]},listeners:{change:function(e,b,d,c){this._t$("cmd_refresh_table")},scope:this}},{iconCls:"icon-grid-add",tooltip:"Add",handler:function(){this._t$("cmd_add_sc")},scope:this},{text:IRm$.r1("L_REN_SCH"),name:"btn_sname",disabled:true,handler:function(){this._t$("cmd_change_schema")},scope:this},{iconCls:"icon-grid-delete",tooltip:"Remove Schema",handler:function(){this._t$("cmd_remove_sc")},scope:this},{iconCls:"icon-refresh",tooltip:"Refresh",handler:function(){this._t$("cmd_refresh")},scope:this}]},{xtype:"toolbar",dock:"top",items:[{xtype:"button",text:"Unregister",handler:function(){var b=this;IG$._I55(IRm$.r1("B_CONFIRM"),IRm$.r1("B_CD_CHS"),function(c){if(c=="yes"){b.l7.call(b)}})},scope:this},"-",{text:"Inline view",name:"b_m2",handler:function(){this._t$("cmd_inlineview")},listeners:{afterrender:function(b){IG$.r___.a(b,"inline_view")}},scope:this},{iconCls:"icon-refresh",tooltip:"Refresh",handler:function(){this._t$("cmd_refresh_table")},scope:this},"->",{text:IRm$.r1("L_BUILD_MODEL"),name:"b_m1",handler:function(){this._t$("cmd_build_model")},scope:this},{text:IRm$.r1("L_EXPORT_META"),handler:function(){this._t$("cmd_export_meta")},scope:this}]}]},{xtype:"gridpanel",name:"pnldetail",hidden:true,flex:1,title:"Field Info",store:{fields:["name","datatype","datasize","alias","decimaldigits","tablename","type","iskey"]},plugins:[{ptype:"cellediting",clicksToEdit:false,listeners:{beforeedit:function(c,h,g){var f=this,b=f.__dL==1,d=true,j=h.colIdx;if(j==0&&!b){d=false}return d},edit:function(o,p,f){var q=this,h=p.grid,s=h.store,g=p.record,k=p.colIdx,c=p.rowIdx,t=p.originalValue,n=p.value,j,l=0,b,d;if(k==0){for(j=0;j<s.data.items.length;j++){if(j!=c){b=s.data.items[j];d=b.get("name");if(d.indexOf(t)>-1){l=1;break}}}if(l){IG$._I55(IRm$.r1("B_CONFIRM"),IRm$.r1("L_TB_BN"),function(v){if(v=="yes"){var e,u,w;for(e=0;e<s.data.items.length;e++){if(e!=c){u=s.data.items[e];d=u.get("name");w=d.indexOf(t);if(w>-1){d=d.substring(0,w)+n+d.substring(w+t.length);u.set("name",d)}}}}})}}},scope:this}}],defaults:{sortable:false,hideable:false},columns:[{header:"Name",dataIndex:"name",editor:{allowBlank:false},flex:1},{header:"Alias",dataIndex:"alias",flex:1,editor:{allowBlank:true}},{header:"Key",xtype:"checkcolumn",dataIndex:"iskey",width:40},{header:"DataType",dataIndex:"datatype",width:80},{header:"Size",dataIndex:"datasize",width:80}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{iconCls:"icon-toolbar-save",tooltip:"Save and close field",handler:function(){this._t$("cmd_save_field")},scope:this},{iconCls:"icon-refresh",tooltip:"Refresh",handler:function(){this._t$("cmd_refresh_field")},scope:this},{text:"Edit SQL",name:"edit_sql",hidden:true,handler:function(){this._t$("cmd_edit_sql")},scope:this},{xtype:"checkbox",fieldLabel:"Allow Insert",name:"allow_insert",labelAlign:"right",boxLabel:IRm$.r1("B_ENABLE"),disabled:true,listeners:{change:function(b){var d=this,c=d.down("[name=t2]");c.setVisible(b.getValue())},scope:this}},"->",{text:"Relations",handler:function(){this._t$("cmd_rel_field")},scope:this},{text:"Update Alias",name:"m2",hidden:true,handler:function(){this._t$("cmd_ref_alias")},scope:this}]},{xtype:"toolbar",dock:"top",name:"t2",hidden:true,items:[{xtype:"combobox",name:"file_field",labelAlign:"right",fieldLabel:"File Field",valueField:"value",displayField:"name",queryMode:"local",editable:false,store:{fields:["name","value"]}},{xtype:"combobox",name:"seq_field",labelAlign:"right",fieldLabel:"Unique Field",valueField:"value",displayField:"name",queryMode:"local",editable:false,store:{fields:["name","value"]}}]}]}]}]}]}];this.listeners={afterrender:function(b){b._IFd.call(b)}};IG$._I73.superclass.initComponent.call(this)}});IG$.A2Tw=$s.extend($s.window,{title:"Alias Loader",modal:true,region:"center",layout:"fit",closable:false,resizable:false,width:500,autoHeight:true,plain:true,callback:null,_IG0:function(){this.close()},l1:function(){var b=this,a=new IG$._I3e();a.init(b,{ack:"11",payload:IG$._I2d({uid:""},"uid;dbtype;option"),mbody:IG$._I2e({option:"aliaslist"})},b,b.rs_l1,null);a._l()},rs_l1:function(a){var f=this,h=IG$._I18(a,"/smsg"),g=IG$._I26(h),d,b=[],e,c=f.down("[name=grdalias]");for(d=0;d<g.length;d++){e=IG$._I1c(g[d]);b.push(e)}c.store.loadData(b)},l2:function(){var j=this,l=new IG$._I3e(),h=j.down("[name=grdalias]"),k=h.getSelectionModel(),d=k.getSelection(),b=[],g,c,n,a,e,f;if(j._md){g={};f=j.down("[name=v_1]").getValue();f=f.split("\n");for(e=0;e<f.length;e++){a=f[e].indexOf(",");if(f[e]&&a>-1){c=f[e].substring(0,a);n=f[e].substring(a+1);if(c&&n){g[c]=n}}}if(j.callback){j.callback.execute(g);this.close()}}else{if(d&&d.length>0){for(e=0;e<d.length;e++){b.push(d[e].get("name"))}l.init(j,{ack:"11",payload:IG$._I2d({filenames:b.join("")},"filenames"),mbody:IG$._I2e({option:"aliasnames"})},j,j.rs_l2,null);l._l()}else{if(j.callback){j.callback.execute({});this.close()}}}},rs_l2:function(a){var e=this,h=IG$._I18(a,"/smsg"),g=IG$._I26(h),d,c={},b,f;for(d=0;d<g.length;d++){b=IG$._I1b(g[d],"name");f=IG$._I24(g[d]);c[b]=f}if(e.callback){e.callback.execute(c);this.close()}},c1:function(b){var a=this;a._md=b;a.down("[name=b_1]").setText(b?"Select File":"Input Values");a.down("[name=m_1]").getLayout().setActiveItem(b)},initComponent:function(){var a=this;$s.apply(this,{border:0,items:[{xtype:"panel",border:0,name:"m_1",layout:"card",bodyPadding:10,height:300,items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"displayfield",value:"Select alias file"}]},{xtype:"gridpanel",flex:1,name:"grdalias",selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell"},store:{xtype:"store",fields:["name"]},columns:[{xtype:"gridcolumn",text:"Name",dataIndex:"name",flex:1}]}]},{xtype:"panel",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"displayfield",value:"Type values with ColumnName,AliasName"}]},{xtype:"textarea",flex:1,name:"v_1"}]}]}],buttons:[{text:"Input Values",name:"b_1",handler:function(){a.c1(a._md?0:1)},scope:this},"->",{text:IRm$.r1("B_CONFIRM"),handler:function(){a.l2()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(b){a.l1()}}});IG$.A2Tw.superclass.initComponent.apply(this,arguments)}});IG$._I72=$s.extend($s.window,{modal:true,closable:false,resizable:true,layout:"fit",width:600,autoHeight:true,layout:{type:"fit"},bodyPadding:0,_1:function(c,b){var d=this,a=new IG$._I3e();a.init(d,{ack:"11",payload:IG$._I2d({uid:c||d.uid}),mbody:IG$._I2e({option:"relations",isdown:(d.isdown?"T":"F"),detail:"info"})},d,function(k){var o=this,h=o.down("[name="+(b||"grd_rel")+"]"),e=IG$._I18(k,"/smsg/item"),l=IG$._I26(e),g,n,j,p=o.down("[name=txtrel]"),f=[];if(!c){j=IG$._I1c(e);p.setValue("Relations : "+j.name+"("+j.nodepath+")")}for(g=0;g<l.length;g++){n=IG$._I1c(l[g]);n.iconcls=IG$._I11(n.type.toLowerCase());f.push(n)}h.store.loadData(f)},false);a._l()},initComponent:function(){var a=this;$s.apply(this,{title:IRm$.r1("T_Resources"),items:[{xtype:"panel",bodyPadding:10,minHeight:500,layout:{type:"vbox",align:"stretch"},items:[{xtype:"displayfield",name:"txtrel",value:"Relations"},{xtype:"gridpanel",name:"grd_rel",flex:1,store:{xtype:"store",fields:["name","nodepath","uid","type","iconcls"]},columns:[{xtype:"templatecolumn",text:IRm$.r1("B_NAME"),menuDisabled:true,flex:1,minWidth:160,tdCls:"ig-navi-namecol",tpl:"<div class='ig-navi-itemicon {iconcls}'></div><span title='{name} ({type})'>{name}</span>"},{text:"Location",flex:1,minWidth:200,dataIndex:"nodepath"}],listeners:{cellclick:function(c,d,n,f,l,o,h,j){var k=this,b=k.down("[name=png_rel_sub]"),g=f.get("uid");if(n==0){b.show();k._1(g,"grd_rel_sub")}},scope:this}},{xtype:"panel",name:"png_rel_sub",flex:1,hidden:true,layout:{type:"vbox",align:"stretch"},items:[{xtype:"displayfield",value:"Sub relations"},{xtype:"gridpanel",flex:1,name:"grd_rel_sub",store:{xtype:"store",fields:["name","nodepath","uid","type","iconcls"]},columns:[{xtype:"templatecolumn",text:IRm$.r1("B_NAME"),menuDisabled:true,flex:1,minWidth:160,tdCls:"ig-navi-namecol",tpl:"<div class='ig-navi-itemicon {iconcls}'></div><span title='{name} ({type})'>{name}</span>"},{text:"Location",flex:1,minWidth:200,dataIndex:"nodepath"}]}]}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this.close()},scope:this},{text:IRm$.r1("B_CLOSE"),handler:function(){this.close()},scope:this}]});IG$._I72.superclass.initComponent.call(this)},listeners:{afterrender:function(a){a._1()}}});IG$.c$sm7=function(){};IG$.c$sm7.prototype={m1$17:function(a){var e=this,f,d,c,b,h,g;f=IG$._I18(a,"/smsg/item");e.iteminfo=IG$._I1c(f);e.fields=null;e.option={};b=IG$._I18(a,"/smsg/item/options");if(b){e.option.usesum=IG$._I1b(b,"usesum");e.option.expandall=IG$._I1b(b,"expandall")}b=IG$._I18(a,"/smsg/item/Fields");h=IG$._I26(b);if(h&&h.length>0){e.fields=IG$._I1c(h[0])}b=IG$._I18(a,"/smsg/item/Data");e.data=[];e.storedata=[];if(b){e.m1$a(b,e.data,e.storedata)}},m1$a:function(f,k,h){var b,g,e,p,o,l,n,d,c,a;b=IG$._I26(f);if(b&&b.length>0){for(g=0;g<b.length;g++){p=IG$._I1c(b[g]);l=IG$._I19(b[g],"values");d=l?IG$._I1b(l,"mode"):null;a=p.ctype;if(a=="formula"){p.values=[];p.syntax=IG$._I1a(b[g],"syntax")}else{if(d=="1"){p.values=[];c=IG$._I26(l);for(e=0;e<c.length;e++){p.values.push(IG$._I24(c[e]))}}else{p.values=IG$._I24(l).split(";")}}n=IG$._I19(b[g],"children");k.push(p);o={leaf:true,gname:p.gname,ctype:p.ctype,values:p.values.join("$^"),valuedesc:a=="formula"?p.syntax:p.values.join(","),syntax:p.syntax,checked:false};h.push(o);if(n&&n.hasChildNodes()==true){p.children=[];o.children=[];o.leaf=false;delete o.checked;this.m1$a(n,p.children,o.children)}}}},tmx:function(a,f){var e=this,d,b,c;for(d=0;d<a.length;d++){f.push("<child");c=a[d];f.push(" gname='"+c.gname+"'");f.push(" ctype='"+(c.ctype||"")+"'>");if(c.ctype=="formula"){f.push("<syntax><![CDATA["+(c.syntax||"")+"]]></syntax>")}else{f.push("<values mode='1'>");for(b=0;b<c.values.length;b++){f.push("<v><![CDATA["+c.values[b]+"]]></v>")}f.push("</values>")}if(c.children&&c.children.length>0){f.push("<children>");e.tmx(c.children,f);f.push("</children>")}f.push("</child>")}},TX:function(){var g=this,e,b,d,f=[],c=g.iteminfo,a=g.fields,h=g.data;f.push('<smsg><item uid="'+c.uid+'" name="'+c.name+'" type="'+c.type+'">');f.push("<options");f.push(" usesum='"+(g.option.usesum||"T")+"'");f.push(" expandall='"+(g.option.expandall||"F")+"'");f.push(">");f.push("</options>");f.push("<Fields>");if(a){f.push('<item name="'+a.name+'" uid="'+a.uid+'" type="'+a.type+'" nodepath="'+a.nodepath+'"/>')}f.push("</Fields>");f.push("<Data>");if(h&&h.length>0){g.tmx(h,f)}f.push("</Data>");f.push("</item></smsg>");return f.join("")}};IG$._Iab=$s.extend($s.panel,{uid:this.uid,bodyBorder:false,layout:"fit",fieldDefaults:{labelWidth:160},lX:{},_IFe:function(){var a=this,b=new IG$._I3e();b.init(a,{ack:"5",payload:IG$._I2d({uid:this.uid}),mbody:IG$._I2e({})},a,a.rs_sK5,null);b._l()},rs_sK5:function(c){var f=this;f.clItem=new IG$.c$sm7();f.clItem.m1$17(c);var b=f.down("[name=targetitem]"),e=f.down("[name=udgtree]"),d=f.down("[name=usesum]"),a=f.down("[name=expandall]");b.setValue(f.clItem&&f.clItem.fields?f.clItem.fields.name:"");d.setValue(f.clItem&&f.clItem.option&&f.clItem.option.usesum=="F"?false:true);a.setValue(f.clItem&&f.clItem.option&&f.clItem.option.expandall=="T"?true:false);f.m1$a(f.clItem.storedata);f.m1$18()},m1$a:function(e){var d=this,c=this.clItem,b=this.down("[name=udgtree]"),a={gname:"User defined group",expanded:true,leaf:false,children:(e||[])};b.store.setRootNode(a)},m1$18:function(){var a=this,b=new IG$._I3e();b.init(a,{ack:"11",payload:"<smsg><item uid='"+this.uid+'\' parenttype="Cube;MCube;DataCube;SQLCube" read="F"/></smsg>',mbody:IG$._I2e({option:"parentcontent"})},a,a.rs_getParentcube,null);b._l()},rs_getParentcube:function(a){var c=IG$._I18(a,"/smsg"),b;if(c){b=IG$._I17(c);if(b){this.cubeuid=IG$._I1b(b,"uid")}}},_IFf:function(){var f=this,c=f.clItem,e,d,b=f.down("[name=udgtree]"),a=f.down("[name=usesum]"),k=f.down("[name=expandall]"),h=b.store,g=h.getRootNode(),j;c.data=[];c.option.usesum=(a.getValue())?"T":"F";c.option.expandall=(k.getValue())?"T":"F";f.skm(g,c.data);e=f.clItem.TX();f.sK6(f.uid,e)},skm:function(d,b){var f=this,c,e,a,g;for(c=0;c<d.childNodes.length;c++){e=d.childNodes[c];g=e.get("values").split("$^");a={gname:e.get("gname"),ctype:e.get("ctype"),syntax:e.get("syntax"),values:g};b.push(a);if(e.childNodes&&e.childNodes.length>0){a.children=[];f.skm(e,a.children)}}},sK6:function(b,d){var a=this;var c=new IG$._I3e();c.init(a,{ack:"31",payload:IG$._I2d({uid:b}),mbody:d},a,a.rs_sK6,null);c._l()},rs_sK6:function(a){IG$._I54(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success");this.wd._IG0.call(this.wd)},selectItem:function(a){var b=this,c=new IG$._I96({visibleItems:"workspace;folder;metric;tabdimension;measuregroupdimension",u5x:{cubebrowse:true,rootuid:b.cubeuid},callback:new IG$._I3d(b,b.P2C,a)});IG$._I_5(b,c)},P2C:function(c,a){var b=this;b.clItem.fields=c;IG$._I2c(b,a,"s",c.name)},Mex:function(){var j=this,b=j.down("[name=udgtree]"),l=b.store,k=b.getSelectionModel(),n,h,c,d,e,g,a=0,f;if(k.selected.items.length>0){c=k.selected.items[0]}else{c=b.getRootNode()}n=c.get("valuedesc");h=c.get("values");c.set("valuedesc","");c.set("values","");c.set("leaf",false);g="new item ";for(e=0;e<c.childNodes.length;e++){f=c.childNodes[e].get("gname");if(f.substring(0,g.length)==g){f=f.substring(g.length);f=Number(f);if(isNaN(f)==false){a=Math.max(a,Number(f)+1)}}}g+=a;d={gname:g,values:h||"",valuedesc:n||"",leaf:true,checked:false};c.appendChild(d);c.expand()},Mrx:function(){var e=this,c=e.down("[name=udgtree]"),b=c.store,a=b.getRootNode(),d;e.mrx(a)},mrx:function(b){var f=this,c,e,g,d,a;for(c=b.childNodes.length-1;c>=0;c--){e=b.childNodes[c];if(e.get("checked")==true){b.removeChild(e)}else{if(e.childNodes&&e.childNodes.length>0){f.mrx(e)}}}if(b.isRoot()==false&&b.hasChildNodes()==false){g=b.parentNode;d=b.get("gname");a=0;for(c=0;c<g.childNodes.length;c++){if(g.childNodes[c]==b){a=c;break}}g.insertChild(a,{gname:d,values:"",valuedesc:"",leaf:true,checked:false});g.removeChild(b,false,false,false)}},Mkx:function(d,a){var e=this,c=e.down("[name=udgtree]"),b=c.store;if(e.clItem&&e.clItem.fields){if(a.isRoot()==false){var f=e.clItem.fields;var g=new IG$._IacU({field:f,rec:a,callback:new IG$._I3d(e,e.rs_m1$20,[a])});g.show()}}else{IG$._I52("Select target item before change data items.",this)}},rs_m1$20:function(b,c){var g=c[0],h="",j="",k,a=b.selection,e=b.selmode,d=b.syntax,f;if(e==2){g.set("ctype","formula");g.set("syntax",d);g.set("valuedesc",d)}else{g.set("ctype","");for(f=0;f<a.length;f++){k=a[f].code||a[f].text;h+=(f==0)?k:"$^"+k;j+=(f==0)?k:","+k}g.set("values",h);g.set("valuedesc",j)}},lx:function(){var a=this;if(a.clItem&&a.clItem.fields){}else{IG$._I52("Select target item before loading external data files.",this)}},initComponent:function(){var a=this;$s.apply(this,{items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},bodyStyle:"padding: 5px",items:[{xtype:"fieldset",title:"Target options",items:[{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",name:"targetitem",fieldLabel:"Target Metric Item"},{xtype:"button",text:"..",handler:function(){this.selectItem("targetitem")},scope:this}]},{xtype:"button",text:"Import from excel file",hidden:true,handler:function(){this.lx()},scope:this},{xtype:"checkbox",fieldLabel:"Use SUM on folder",name:"usesum",boxLabel:"Enable"},{xtype:"checkbox",fieldLabel:"Expand All",name:"expandall",boxLabel:"Enable"}]},{xtype:"treepanel",name:"udgtree",store:{xtype:"treestore",fields:["gname","values","valuedesc","ctype","syntax"],folderSort:false},hideHeaders:true,rootVisible:true,useArrows:true,multiSelect:true,singleExpand:false,flex:1,selModel:"SINGLE",tbar:[{xtype:"button",text:"Add",handler:function(){var b=this;b.Mex.call(b)},scope:this},{xtype:"button",text:"Remove",handler:function(){var b=this;b.Mrx.call(b)},scope:this}],plugins:[{ptype:"cellediting",clicksToEdit:false}],columns:[{xtype:"treecolumn",text:"Group name",dataIndex:"gname",flex:1,editor:{allowBlank:false}},{text:"Values",flex:1,dataIndex:"valuedesc"},{xtype:"actioncolumn",width:50,items:[{iconCls:"icon-grid-config",tooltip:IRm$.r1("B_CONFIG_ITEM"),handler:function(d,h,c,f,g,b){a.Mkx(h,b)},scope:a}]}],listeners:{checkchange:function(c,b){c.set("chekced",b)},celldblclick:function(b,c,l,d,k,n,f,g){var j=this;if(d.isRoot()==false&&d.hasChildNodes()==true){var h=new IG$._Iad({gname:d.get("gname"),callback:new IG$._I3d(this,function(e){d.set("gname",e)})});h.show(this);return false}},scope:this}}]}]});IG$._Iab.superclass.initComponent.apply(this)},listeners:{afterrender:function(b){var a=this;setTimeout(function(){a._IFe.call(a)},100)}}});IG$._Iae=$s.extend($s.window,{modal:false,isWindow:true,region:"center",layout:{type:"fit",align:"stretch"},closable:false,resizable:false,width:500,height:400,callback:null,_IG0:function(){this.close();this.callback&&this.callback.execute()},_IFf:function(){if(this.writable==true){this._IH1._IFf.call(this._IH1)}this._IG0()},initComponent:function(){this._IH1=new IG$._Iab({uid:this.uid,writable:this.writable,wd:this});this.title=IRm$.r1("T_UDG");$s.apply(this,{defaults:{bodyStyle:"padding:10px"},items:[this._IH1],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}]});IG$._Iae.superclass.initComponent.apply(this,arguments)}});IG$._Iad=$s.extend($s.window,{isWindow:true,region:"center",layout:{type:"fit",align:"stretch"},closable:false,resizable:false,width:230,autoHeight:true,modal:true,callback:null,_IG0:function(){this.close()},_IFf:function(){var a=this.down("[name=gname]").getValue();if(!a){return}this.callback&&this.callback.execute(a);this._IG0()},initComponent:function(){this.title=IRm$.r1("T_UDG");this._IH1=new IG$._Iab({uid:this.uid,writable:this.writable,wd:this});$s.apply(this,{defaults:{bodyStyle:"padding:10px"},items:[{xtype:"form",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:"Group name",allowBlank:false,name:"gname"},{xtype:"displayfield",value:"Set group name for this subject"}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(a){this.down("[name=gname]").setValue(this.gname||"")},scope:this}});IG$._Iad.superclass.initComponent.apply(this,arguments)}});IG$.c$s18=function(){var a=this;a.iteminfo;a.fields;a.expressiontype;a.expression;a.calcmode=false;a.cubeinfo={styles:[]};a.objinfo={};a.fields=[]};IG$.c$s18.prototype={m1$17:function(j){var k=this,e,b,f,h,l,c,d,g,a;e=IG$._I18(j,"/smsg/item");k.iteminfo=IG$._I1c(e);d=IG$._I18(j,"/smsg/item/objinfo");f=IG$._I18(j,"/smsg/item/Fields");h=IG$._I18(j,"/smsg/item/Expression");l=IG$._I18(j,"/smsg/item/mfilter");k.fields=[];if(d){k.objinfo=IG$._I1c(d)}else{k.objinfo={}}if(f){a=IG$._I26(f);for(g=0;g<a.length;g++){k.fields.push(IG$._I1c(a[g]))}}if(h){k.expressiontype=IG$._I1b(h,"type");k.calcmode=IG$._I1b(h,"calcmode")=="T";k.expression=IG$._I24(h)}k.mfilter=l?IG$._I24(l):null;b=IG$._I18(j,"/smsg/item/cubeinfo");if(b){l=IG$._I18(b,"AppStyle/Default");if(l){tnodes=IG$._I26(l);for(g=0;g<tnodes.length;g++){k.cubeinfo.styles.push({name:IG$._I1b(tnodes[g],"name"),type:"appbase"})}}l=IG$._I18(b,"AppStyle/Custom");if(l){tnodes=IG$._I26(l);for(g=0;g<tnodes.length;g++){k.cubeinfo.styles.push({name:IG$._I1b(tnodes[g],"name"),type:"appcustom"})}}l=IG$._I18(b,"CubeStyle/Custom");if(l){tnodes=IG$._I26(l);for(g=0;g<tnodes.length;g++){k.cubeinfo.styles.push({name:IG$._I1b(tnodes[g],"name"),type:"cubestyle"})}}}},TX:function(){var d=this,b,a,c="<smsg><item uid='"+d.iteminfo.uid+"' name='"+d.iteminfo.name+"' type='"+d.iteminfo.type+"'>";if(d.objinfo){c+="<objinfo";for(a in d.objinfo){c+=" "+a+"='"+d.objinfo[a]+"'"}c+="></objinfo>"}c+="<Fields>";for(b=0;b<d.fields.length;b++){d.fields[b].type=d.fields[b].type||d.fields[b].itemtype;c+="<item "+IG$._I20(d.fields[b],"name;uid;type;nodepath;memo","s")+"/>"}c+="</Fields>";c+="<Expression type='"+d.expressiontype+"' calcmode='"+(d.calcmode==true?"T":"F")+"'><![CDATA["+d.expression+"]]></Expression>";c+="<mfilter><![CDATA["+(d.mfilter||"")+"]]></mfilter>";c+="</item></smsg>";return c},cl:function(){var c=this,b=new IG$.c$s18(),a;b.objinfo=c.objinfo;b.fields=[];for(a=0;a<c.fields.length;a++){b.fields.push(c.fields[a])}b.expressiontype=c.expressiontype;b.expression=c.expression;b.mfilter=c.mfilter;b.calcmode=c.calcmode}};IG$._Ie1=$s.extend($s.window,{modal:false,isWindow:true,region:"center",layout:"fit",closable:false,resizable:false,width:500,height:530,_ILa:null,callback:null,_IFe:function(){var a=this,b=a.dmode,c=new IG$._I3e(),d=a.down("[name=expressiontype]");d.setValue("([field])");if(b){a.rs_sK5s()}else{c.init(a,{ack:"5",payload:IG$._I2d({uid:a.uid}),mbody:IG$._I2e({option:"diagnostics"})},a,a.rs_sK5,null);c._l()}},expressionChange:function(c,a,b){if(a){this.down("[name=expression]").setValue(a)}},rs_sK5:function(a){var b=this;b.clItem=new IG$.c$s18();b.clItem.m1$17(a);b.rs_sK5s()},rs_sK5s:function(){var h=this,e,b,f,c,a=[],k,d=h.down("[name=optstyle]");b=h.clItem.iteminfo&&h.clItem.iteminfo.nodepath?h.clItem.iteminfo.nodepath.split("/"):null;if(b){for(e=0;e<h.clItem.fields.length;e++){f=h.clItem.fields[e].nodepath;f=(f?f.split("/"):null);if(f){for(c=f.length-1;c>=0;c--){if(f[c]==b[c]){f.splice(c,1)}}h.clItem.fields[e].cpath=f.join("/")}}}k=h.clItem;a.push({disp:"--- select ---",name:""});for(e=0;e<k.cubeinfo.styles.length;e++){a.push({disp:k.cubeinfo.styles[e].name,name:k.cubeinfo.styles[e].name,type:k.cubeinfo.styles[e].type})}d.store.loadData(a);d.setValue(k.objinfo.itemstyle||"");h.datagrid.store.loadData(h.clItem.fields);h.down("[name=expression]").setValue(h.clItem.expression);h.down("[name=mfilter]").setValue(h.clItem.mfilter);var g=h.down("[name=expressiontype]");h.clItem.expressiontype=(h.clItem.expressiontype=="COUNT")?"COUNT_DISTINCT":h.clItem.expressiontype;g.setValue(h.clItem.expressiontype);g.on("change",h.expressionChange,h);h.down("[name=calcmode]").setValue(h.clItem.calcmode);IG$.r___.a(h.down("[name=calcmode]"),"calcmode");if(!h.dmode){h.m1$18()}},m1$18:function(){var a=this,b=new IG$._I3e();b.init(a,{ack:"11",payload:"<smsg><item uid='"+a.uid+"' parenttype='Cube;MCube;DataCube;SQLCube' read='F'/></smsg>",mbody:IG$._I2e({option:"parentcontent"})},a,a.rs_getParentcube,null);b._l()},rs_getParentcube:function(a){var c=this,d=IG$._I18(a,"/smsg"),b;if(d){b=IG$._I17(d);if(b){c.cubeuid=IG$._I1b(b,"uid");c.cubepath=IG$._I1b(b,"nodepath")}}},_IFf:function(){var f=this,l,k,j,e,a,b=f,c,h=f.down("[name=datagrid]");l=f.down("[name=expression]").getValue();f.clItem.expression=l;a=f.down("[name=expressiontype]");l=a.getValue();for(c=0;c<a.store.data.items.length;c++){if(a.store.data.items[c].data.value==l){f.clItem.expressiontype=a.store.data.items[c].data.name}}f.clItem.mfilter=f.down("[name=mfilter]").getValue();f.clItem.fields=[];for(c=0;c<h.store.data.items.length;c++){e=h.store.data.items[c].data;j={uid:e.uid,name:e.name,nodepath:e.nodepath,memo:e.memo,type:e.type};f.clItem.fields.push(j)}f.clItem.calcmode=f.down("[name=calcmode]").getValue();f.clItem.objinfo.itemstyle=f.down("[name=optstyle]").getValue();if(f.dmode){f._IG0({meta:k,citem:f.clItem})}else{k=f.clItem.TX();var g=new IG$._I3e();g.init(b,{ack:"31",payload:IG$._I2d({uid:f.uid}),mbody:k},b,b.rs_sK6,null,null);g._l()}},rs_sK6:function(a){this._IG0()},_IG0:function(b){var a=this;a.callback&&a.callback.execute(b);a.close()},mU$1:function(d){var e=this.down("[name=expression]"),b=e.inputEl.dom,h=e.getRawValue(),g=-1,f=-1,a,c;d="["+d+"]";if(h.length>0){var k=-1,j=-1;a=$(b).getSelection();if(a.length==0){for(c=a.start;c>=0;c--){if(h.charAt(c)=="["){k=c;break}else{if(h.charAt(c)=="]"||h.charAt(c)==")"||h.charAt(c)=="("){break}}}if(k>-1){for(c=a.end;c<h.length;c++){if(h.charAt(c)=="]"){j=c+1;break}else{if(h.charAt(c)=="["||h.charAt(c)==")"||h.charAt(c)=="("){break}}}}}else{if(a.start-1>-1&&a.end<h.length&&h.charAt(a.start-1)=="["&&h.charAt(a.end)=="]"){a.start-=1;a.end+=1}}if(k==-1||j==-1){k=a.start;j=a.end}h=h.substring(0,k)+d+h.substring(j,h.length);g=k;f=k+d.length}else{h=d;g=0;f=h.length}e.setValue(h);if(g>-1&&f>g){e.selectText(g,f)}},selectItem:function(a){var b=this,c=new IG$._I96({visibleItems:"workspace;folder;metric;custommetric;tabdimension;measuregroupdimension;measure",u5x:{cubebrowse:true,rootuid:b.cubeuid}});c.callback=new IG$._I3d(b,b.P2C,a);IG$._I_5(this,c)},P2C:function(e,a){var d=this;if(a=="grid"){var c=d.down("[name=datagrid]"),b,g,f=false;for(b=0;b<c.store.data.items.length;b++){g=c.store.data.items[b];if(g.get("uid")==e.uid){f=true;break}}if(f==false){if(d.cubepath){e.cpath=e.nodepath.replace(d.cubepath,"")}else{e.cpath=e.nodepath}c.store.add(e)}}},initComponent:function(){var a=this;a.title=IRm$.r1("T_MEASURE");$s.apply(this,{defaults:{bodyStyle:"padding:0px"},items:[{xtype:"panel",layout:"fit",border:0,defaults:{bodyPadding:5},items:[{xtype:"form",border:0,layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",title:IRm$.r1("L_SYNTAX"),flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch"},items:[{name:"expressiontype",fieldLabel:IRm$.r1("L_TYPE"),xtype:"combobox",labelAlign:"left",labelWidth:100,valueField:"value",displayField:"label",value:"",editable:false,store:{xtype:"store",fields:["value","label","name"],data:[{label:"Custom",name:"CUSTOM",value:"([field])"},{label:"Distinct count",name:"COUNT_DISTINCT",value:"COUNT(DISTINCT [field])"},{label:"All count",name:"COUNT_ALL",value:"COUNT([field])"},{label:"Sum",name:"SUM",value:"SUM([field])"},{label:"Average",name:"AVERAGE",value:"AVG([field])"},{label:"Max",name:"MAX",value:"MAX([field])"},{label:"Min",name:"MIN",value:"MIN([field])"}]}},{name:"calcmode",boxLabel:"Calculate In Result",xtype:"checkbox",padding:"0 5 0"}]},{name:"expression",xtype:"textarea",fieldLabel:IRm$.r1("L_SYNTAX"),labelWidth:100},{name:"mfilter",xtype:"textarea",fieldLabel:IRm$.r1("L_M_FILTER"),labelWidth:100},{xtype:"gridpanel",name:"datagrid",store:{xtype:"store",fields:["name","type","delete","uid","nodepath","memo","cpath"]},stateful:true,flex:1,viewConfig:{plugins:[{ptype:"gridviewdragdrop",ddGroup:"_I$RD_G_",enableDrop:true,enableDrag:false}],listeners:{beforedrop:function(e,g,j,n,l,c){var d=false,h,f,k=false,b=(g.records&&g.records.length>0)?g.records[0]:null;(this==g.view)?g.copy=false:g.copy=true;h=(j)?this.panel.store.indexOf(j):0;if(b&&b.data.type=="Metric"){for(f=0;f<this.store.data.items.length;f++){if(this.store.data.items[f].data.uid==b.data.uid){k=true;break}}if(k==false){this.store.add(b.data)}}return d},drop:function(e,f,g,b,d){var c=g?" "+b+" "+g.get("name"):" on empty view";return false}}},columns:[{text:"Name",flex:1,sortable:false,dataIndex:"name"},{text:"Type",flex:1,sortable:false,dataIndex:"type"},{text:"Path",flex:1,sortable:false,dataIndex:"cpath"},{xtype:"actioncolumn",width:30,items:[{iconCls:"icon-grid-delete",tooltip:"Delete item",handler:function(c,e,b){var d=c.store.getAt(e);c.store.removeAt(e)}}]}],listeners:{itemdblclick:function(c,b,g,d,f,e){this.mU$1(b.data.name)},scope:this}},{xtype:"container",layout:{type:"hbox"},items:[{xtype:"displayfield",flex:1,value:IRm$.r1("L_ME_DISP1")},{xtype:"button",text:"Add",handler:function(){this.selectItem("grid")},scope:this}]}]},{xtype:"fieldset",title:IRm$.r1("L_STYLE_OPTION"),layout:"anchor",padding:"3 5",items:[{xtype:"combobox",name:"optstyle",fieldLabel:IRm$.r1("L_BASE_STYLE"),queryMode:"local",displayField:"disp",valueField:"name",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","type","disp"]}}]}]}]}],buttons:["->",{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(c){var b=this;b.datagrid=b.down("[name=datagrid]");b._IFe()}}});IG$._Ie1.superclass.initComponent.apply(this,arguments)}});IG$._IeNa=function(){var a=this;a.iteminfo;a.fields;a.disptype;a.cubeinfo={styles:[]};a.objinfo={};a.fields=[]};IG$._IeNa.prototype={m1$17:function(j){var k=this,d,b,f,h,c,e,g,a;d=IG$._I18(j,"/smsg/item");k.iteminfo=IG$._I1c(d);e=IG$._I18(j,"/smsg/item/objinfo");f=IG$._I18(j,"/smsg/item/Fields");h=IG$._I18(j,"/smsg/item/option");k.fields=[];if(e){k.objinfo=IG$._I1c(e)}else{k.objinfo={}}if(f){a=IG$._I26(f);for(g=0;g<a.length;g++){k.fields.push(IG$._I1c(a[g]))}}if(h){k.disptype=IG$._I1b(h,"type")}b=IG$._I18(j,"/smsg/item/cubeinfo");if(b){mnode=IG$._I18(b,"AppStyle/Default");if(mnode){tnodes=IG$._I26(mnode);for(g=0;g<tnodes.length;g++){k.cubeinfo.styles.push({name:IG$._I1b(tnodes[g],"name"),type:"appbase"})}}mnode=IG$._I18(b,"AppStyle/Custom");if(mnode){tnodes=IG$._I26(mnode);for(g=0;g<tnodes.length;g++){k.cubeinfo.styles.push({name:IG$._I1b(tnodes[g],"name"),type:"appcustom"})}}mnode=IG$._I18(b,"CubeStyle/Custom");if(mnode){tnodes=IG$._I26(mnode);for(g=0;g<tnodes.length;g++){k.cubeinfo.styles.push({name:IG$._I1b(tnodes[g],"name"),type:"cubestyle"})}}}},TX:function(){var d=this,b,a,c="<smsg><item uid='"+d.iteminfo.uid+"' name='"+d.iteminfo.name+"' type='"+d.iteminfo.type+"'>";if(d.objinfo){c+="<objinfo";for(a in d.objinfo){c+=" "+a+"='"+d.objinfo[a]+"'"}c+="></objinfo>"}c+="<Fields>";for(b=0;b<d.fields.length;b++){d.fields[b].type=d.fields[b].type||d.fields[b].itemtype;c+="<item "+IG$._I20(d.fields[b],"name;uid;type;nodepath;memo","s")+"/>"}c+="</Fields>";c+="<option type='"+d.disptype+"'></option>";c+="</item></smsg>";return c},cl:function(){var c=this,b=new IG$.c$s18(),a;b.objinfo=c.objinfo;b.fields=[];for(a=0;a<c.fields.length;a++){b.fields.push(c.fields[a])}b.disptype=c.disptype}};IG$._IeN=$s.extend($s.window,{modal:false,isWindow:true,region:"center",layout:{type:"fit",align:"stretch"},closable:false,resizable:false,width:500,height:450,_ILa:null,callback:null,_IFe:function(){var a=this,b=a.dmode,c=new IG$._I3e(),d=a.down("[name=disptype]");d.setValue("single");if(b){a.rs_sK5s()}else{c.init(a,{ack:"5",payload:IG$._I2d({uid:a.uid}),mbody:IG$._I2e({option:"diagnostics"})},a,a.rs_sK5,null);c._l()}},rs_sK5:function(a){var b=this;b.clItem=new IG$._IeNa();b.clItem.m1$17(a);b.rs_sK5s()},rs_sK5s:function(){var e=this,c,f,a,b,h=[],g,d;f=e.clItem.iteminfo&&e.clItem.iteminfo.nodepath?e.clItem.iteminfo.nodepath.split("/"):null;if(f){for(c=0;c<e.clItem.fields.length;c++){a=e.clItem.fields[c].nodepath;a=(a?a.split("/"):null);if(a){for(b=a.length-1;b>=0;b--){if(a[b]==f[b]){a.splice(b,1)}}e.clItem.fields[c].cpath=a.join("/")}}}d=e.clItem;e.datagrid.store.loadData(e.clItem.fields);g=e.down("[name=disptype]");g.setValue(e.clItem.disptype||"single");if(!e.dmode){e.m1$18()}},m1$18:function(){var a=this,b=new IG$._I3e();b.init(a,{ack:"11",payload:"<smsg><item uid='"+a.uid+"' parenttype='Cube;MCube;DataCube;SQLCube' read='F'/></smsg>",mbody:IG$._I2e({option:"parentcontent"})},a,a.rs_getParentcube,null);b._l()},rs_getParentcube:function(a){var c=this,d=IG$._I18(a,"/smsg"),b;if(d){b=IG$._I17(d);if(b){c.cubeuid=IG$._I1b(b,"uid");c.cubepath=IG$._I1b(b,"nodepath")}}},_IFf:function(){var f=this,l,k,j,e,a,b=f,c,h=f.down("[name=datagrid]");a=f.down("[name=disptype]");f.clItem.disptype=a.getValue();f.clItem.fields=[];for(c=0;c<h.store.data.items.length;c++){e=h.store.data.items[c].data;j={uid:e.uid,name:e.name,nodepath:e.nodepath,memo:e.memo,type:e.type};f.clItem.fields.push(j)}if(f.dmode){f._IG0({meta:k,citem:f.clItem})}else{k=f.clItem.TX();var g=new IG$._I3e();g.init(b,{ack:"31",payload:IG$._I2d({uid:f.uid}),mbody:k},b,b.rs_sK6,null,null);g._l()}},rs_sK6:function(a){this._IG0()},_IG0:function(b){var a=this;a.callback&&a.callback.execute(b);a.close()},selectItem:function(a){var b=this,c=new IG$._I96({visibleItems:"workspace;folder;metric;custommetric;tabdimension;measuregroupdimension;measure",multiselect:1,u5x:{cubebrowse:true,rootuid:b.cubeuid},callback:new IG$._I3d(b,b.P2C,a)});IG$._I_5(this,c)},P2C:function(b,a){var c=this;if(a=="grid"){$.each(b,function(d,g){var f=c.down("[name=datagrid]"),e,j,h=false;for(e=0;e<f.store.data.items.length;e++){j=f.store.data.items[e];if(j.get("uid")==g.uid){h=true;break}}if(h==false){if(c.cubepath){g.cpath=g.nodepath.replace(c.cubepath,"")}else{g.cpath=g.nodepath}f.store.add(g)}})}},_m2:function(d,e){var b=d.getSelectionModel().getSelection(),a=b&&b.length?b[0]:null;if(!a){return}var c=d.getStore().indexOf(a);if(e<0){c--;if(c<0){return}}else{c++;if(c>=d.getStore().getCount()){return}}d.getStore().remove(a);d.getStore().insert(c,a);d.getSelectionModel().select(a,true)},initComponent:function(){var a=this;a.title=IRm$.r1("T_MEASURE");$s.apply(this,{defaults:{bodyStyle:"padding:0px"},items:[{xtype:"panel",layout:"fit",border:0,defaults:{bodyPadding:5},items:[{xtype:"form",border:0,layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",title:IRm$.r1("L_METRIC_ITEMS"),flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldcontainer",layout:"hbox",items:[{name:"disptype",fieldLabel:IRm$.r1("L_TYPE"),xtype:"combobox",labelAlign:"left",labelWidth:100,valueField:"value",displayField:"name",editable:false,store:{xtype:"store",fields:["value","name"],data:[{name:"Compact Layout",value:"single"},{name:"Outline Layout",value:"multi"}]}}]}]},{xtype:"gridpanel",name:"datagrid",store:{xtype:"store",fields:["name","type","delete","uid","nodepath","memo","cpath"]},stateful:true,flex:1,tbar:[{xtype:"toolbar",items:[{xtype:"button",text:"Up",handler:function(){var c=this,b=c.down("[name=datagrid]");c._m2(b,-1)},scope:this},{xtype:"button",text:"Down",handler:function(){var c=this,b=c.down("[name=datagrid]");c._m2(b,1)},scope:this}]}],viewConfig:{plugins:[{ptype:"gridviewdragdrop",ddGroup:"_I$RD_G_",enableDrop:true,enableDrag:false}],listeners:{beforedrop:function(e,g,j,n,l,c){var d=false,h,f,k=false,b=(g.records&&g.records.length>0)?g.records[0]:null;(this==g.view)?g.copy=false:g.copy=true;h=(j)?this.panel.store.indexOf(j):0;if(b&&b.data.type=="Metric"){for(f=0;f<this.store.data.items.length;f++){if(this.store.data.items[f].data.uid==b.data.uid){k=true;break}}if(k==false){this.store.add(b.data)}}return d},drop:function(e,f,g,b,d){var c=g?" "+b+" "+g.get("name"):" on empty view";return false}}},columns:[{text:"Name",flex:1,sortable:false,dataIndex:"name"},{text:"Type",flex:1,sortable:false,dataIndex:"type"},{text:"Path",flex:1,sortable:false,dataIndex:"cpath"},{xtype:"actioncolumn",width:30,items:[{iconCls:"icon-grid-delete",tooltip:"Delete item",handler:function(c,e,b){var d=c.store.getAt(e);c.store.removeAt(e)}}]}],listeners:{itemdblclick:function(c,b,g,d,f,e){this.mU$1(b.data.name)},scope:this}},{xtype:"container",layout:{type:"hbox"},items:[{xtype:"displayfield",flex:1,value:IRm$.r1("L_ME_DISP1")},{xtype:"button",text:"Add",handler:function(){this.selectItem("grid")},scope:this}]}]}]}],buttons:["->",{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(c){var b=this;b.datagrid=b.down("[name=datagrid]");b._IFe()}}});IG$._IeN.superclass.initComponent.apply(this,arguments)}});IG$._Id8=$s.extend($s.window,{modal:false,region:"center",isWindow:true,closeAction:"destroy",layout:{type:"fit",align:"stretch"},closable:true,resizable:false,width:500,height:450,_ILa:null,callback:null,_IG0:function(){this.callback&&this.callback.execute();this.close()},_IFf:function(){var e=this,l,k=e.clItem,j,h,c,a,b,g=this.down("[name=datagrid]");l=e.down("[name=expression]").getValue();k.expression=l;k.fields=[];for(b=0;b<g.store.data.items.length;b++){c=g.store.data.items[b].data;h={uid:c.uid,name:c.name,nodepath:c.nodepath,memo:c.memo,type:c.type};k.fields.push(h)}k.objinfo.itemstyle=e.down("[name=optstyle]").getValue();j=k.TX();var f=new IG$._I3e();f.init(e,{ack:"31",payload:IG$._I2d({uid:this.uid}),mbody:j},e,e.r_IFf,null);f._l()},r_IFf:function(a){if(this.callback){this.callback.execute()}this.close()},selectItem:function(a){var b=new IG$._I96({visibleItems:"workspace;folder;metric;tabdimension;measuregroupdimension;measure;formulameasure",u5x:{cubebrowse:true,rootuid:this.cubeuid}});b.callback=new IG$._I3d(this,this.P2C,a);IG$._I_5(this,b)},P2C:function(e,a){var d=this;if(a=="measure"){var c=d.down("[name=datagrid]"),b,g,f=false;for(b=0;b<c.store.data.items.length;b++){g=c.store.data.items[b];if(g.get("uid")==e.uid){f=true;break}}if(f==false){c.store.add(e)}}},mU$1:function(d){var e=this.down("[name=expression]"),b=e.inputEl.dom,h=e.getRawValue(),g=-1,f=-1,a,c;d="["+d+"]";if(h.length>0){var k=-1,j=-1;$(b).focus();a=$(b).getSelection();if(a.length==0){k=h.length;j=h.length}else{if(a.start-1>-1&&a.end<h.length&&h[a.start-1]=="["&&h[a.end]=="]"){a.start-=1;a.end+=1}}if(k==-1||j==-1){k=a.start;j=a.end}h=h.substring(0,k)+d+h.substring(j,h.length);g=k;f=k+d.length}else{h=d;g=0;f=h.length}e.setValue(h);if(g>-1&&f>g){e.selectText(g,f)}},_IFd:function(){var a=this,b=new IG$._I3e();b.init(a,{ack:"5",payload:IG$._I2d({uid:this.uid}),mbody:IG$._I2e({option:"diagnostics"})},a,a.rs_sK5,null);b._l()},rs_sK5:function(b){var e=this,c=e.down("[name=datagrid]"),a=e.down("[name=optstyle]"),f=[],d;d=e.clItem=new IG$.c$s18();e.clItem.m1$17(b);c.store.loadData(e.clItem.fields);e.down("[name=expression]").setValue(e.clItem.expression);f.push({disp:"--- select ---",name:""});for(i=0;i<d.cubeinfo.styles.length;i++){f.push({disp:d.cubeinfo.styles[i].name,name:d.cubeinfo.styles[i].name,type:d.cubeinfo.styles[i].type})}a.store.loadData(f);a.setValue(d.objinfo.itemstyle||"");e.m1$18()},m1$18:function(){var a=this,b=new IG$._I3e();b.init(a,{ack:"11",payload:"<smsg><item uid='"+this.uid+"' parenttype='Cube;MCube;DataCube;SQLCube' read='F'/></smsg>",mbody:IG$._I2e({option:"parentcontent"})},a,a.rs_getParentcube,null);b._l()},rs_getParentcube:function(a){var c=IG$._I18(a,"/smsg"),b;if(c){b=IG$._I17(c);if(b){this.cubeuid=IG$._I1b(b,"uid")}}},initComponent:function(){var a=this;$s.apply(this,{title:IRm$.r1("T_FORMULA_MEASURE"),buttons:["->",{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this._IG0()},scope:this}],items:[{xtype:"container",padding:5,bodyPadding:"5 5",layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",title:IRm$.r1("L_SYNTAX_FORMULA"),defaultType:"textfield",layout:{type:"vbox",align:"stretch"},defaults:{labelWidth:130},items:[{name:"expression",xtype:"textarea"},{xtype:"displayfield",value:IRm$.r1("L_FM_DISP1")}]},{xtype:"gridpanel",name:"datagrid",store:{fields:["name","type","delete","uid","nodepath","memo"]},stateful:true,height:160,viewConfig:{stripeRows:true,plugins:{ptype:"gridviewdragdrop",ddGroup:"_I$RD_G_"},listeners:{beforedrop:function(d,e,h,l,k){var c=false,g,f,j=false,b=(e.records&&e.records.length>0)?e.records[0]:null;(this==e.view)?e.copy=false:e.copy=true;g=(h)?this.panel.store.indexOf(h):0;if(b&&(b.data.type=="Measure"||b.data.type=="Metric"||b.data.type=="MeasureGroup"||b.data.type=="TabDimension")){for(f=0;f<this.store.data.items.length;f++){if(this.store.data.items[f].data.uid==b.data.uid){j=true;break}}if(j==false){this.store.add(b.data)}}return c},drop:function(d,e,f,b){var c=f?" "+b+" "+f.get("name"):" on empty view";return false}}},columns:[{text:IRm$.r1("B_NAME"),flex:1,sortable:false,dataIndex:"name"},{text:IRm$.r1("B_TYPE"),flex:1,sortable:false,dataIndex:"type"},{xtype:"actioncolumn",width:50,items:[{iconCls:"icon-grid-delete",tooltip:"Delete item",handler:function(d,f,c){var b=d.store,e=b.getAt(f);b.remove(b.data.items[f])}}]}],listeners:{itemdblclick:function(c,b,h,f,g,e){var d=b.data.name||"";if(d){this.mU$1(d)}},scope:this}},{xtype:"container",layout:{type:"hbox"},items:[{xtype:"displayfield",flex:1,value:IRm$.r1("L_FM_DISP2")},{xtype:"button",text:"Add",handler:function(){this.selectItem("measure")},scope:this}]},{xtype:"fieldset",title:IRm$.r1("L_STYLE_OPTION"),layout:"anchor",padding:"3 5",items:[{xtype:"combobox",name:"optstyle",fieldLabel:IRm$.r1("L_BASE_STYLE"),queryMode:"local",displayField:"disp",valueField:"name",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","type","disp"]}}]}]}],listeners:{afterrender:function(){this._IFd()}}});IG$._Id8.superclass.initComponent.apply(this,arguments)}});IG$._If7=$s.extend($s.window,{modal:true,layout:"fit",closable:false,resizable:false,width:600,height:400,callback:null,_IG0:function(){this.close()},editgrid:null,U1:function(){var d=this,b,e=d.down("[name=editgrid]"),a=d._ILa;if(!this.editgrid){this.editgrid=new qigridview({columnfill:true})}b=this.editgrid;b.initialize.call(b,null,$(e.el.dom));if(a.cubeuid&&a.cubeuid.length>0){d.cubeuid=a.cubeuid;var c=new IG$._I3e();c.init(d,{ack:"5",payload:IG$._I2d({uid:a.cubeuid}),mbody:IG$._I2e({option:"content"})},d,d.rs_U1,null);c._l()}},rs_U1:function(g){var b=this,e=IG$._I18(g,"/smsg/item"),h=b.down("[name=measurelist]"),f,c=[],j=[],k,a,l,d=this.editgrid;b.cubeaddress=IG$._I1b(e,"nodepath");b.MM1=new j$sP(b.uid,g);a=b.MM1;j.push({type:"boolean",name:"Select",field:"select",width:40});b.dimensions=[];b.measures=[];for(f=0;f<a.items.length;f++){l=a.items[f];if(l.metrictype=="measure"){c.push({name:l.name,uid:l.uid});b.measures.push({name:l.name,uid:l.uid})}else{j.push({type:"string",name:l.name,field:l.uid});b.dimensions.push({name:l.name,uid:l.uid})}}k={name:"Measures",defaults:{minwidth:80},columns:[]};j.push(k);for(f=0;f<c.length;f++){k.columns.push({name:c[f].name,type:"numeric",field:c[f].uid,formatstring:"#,###.##"})}h.store.loadData(c);d.setColumns.call(d,j);d.redraw.call(d);b.dataset=[]},U2:function(e){var b=this,h=b.dataset,d=b.editgrid,o={},a=b.dimensions,c=b.measures,f=d.columns,k,g,l;switch(e){case"cmd_addrow":d.addRow.call(d);break;case"cmd_remove_row":for(k=d.rowcount-1;k>=d.fixedRow;k--){cell=d.getCellValue.call(d,k,0);if(cell.checked==true){d.removeRow.call(d,k)}}break;case"cmd_apply_changes":var n="";for(k=d.fixedRow;k<d.rowcount;k++){for(g=1;g<d.colcount;g++){cell=d.getCellValue.call(d,k,g);l=cell.code||cell.text||"";n+=f[g].field+":"+l+","}n+="|"}if(n!=""){b.U3(n,false)}break;case"cmd_import":break}},U3:function(d,b){var a=this,c=new IG$._I3e();c.init(a,{ack:"17",payload:"<smsg><item cubeuid='"+a.cubeuid+"' action='AppendData'/></smsg>",mbody:"<smsg><Data><![CDATA["+d+"]]></Data></List>"},a,a.rs_U3,null,b);c._l()},rs_U3:function(a,b){if(b==false){IG$._I54(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")}else{this.close()}},initComponent:function(){var a=this;a.title=IRm$.r1("L_MC_DATA_EDT");a.edt=new IG$._IC3({uid:a.uid});$s.apply(this,{defaults:{bodyStyle:"padding:0px"},layout:"fit",items:[{xtype:"container",layout:"border",items:[{xtype:"form",region:"north",hidden:true,layout:{type:"vbox"},items:[{xtype:"combobox",name:"measurelist",fieldLabel:"Measure",queryMode:"local",displayField:"name",valueField:"uid",editable:false,autoSelect:true,store:{fields:["name","uid"]}}]},{name:"editgrid",region:"center",flex:1,xtype:"container",listeners:{render:function(){a.U1.call(a)}}}]}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"button",text:"Add row",handler:function(){a.U2.call(a,"cmd_addrow")}},{xtype:"button",text:"Remove selected",handler:function(){a.U2.call(a,"cmd_remove_row")}},"-",{xtype:"button",text:"Update on server",handler:function(){a.U2.call(a,"cmd_apply_changes")}},"-",{xtype:"button",text:"Import from file",handler:function(){a.U2.call(a,"cmd_import")}}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){var b=this},scope:this},{text:IRm$.r1("B_CLOSE"),handler:function(){this.close()},scope:this}]});IG$._If7.superclass.initComponent.apply(this,arguments)}});IG$._IA8a=$s.extend($s.panel,{region:"center",layout:"anchor",defaults:{anchor:"100%"},callback:null,pitem:null,_IFf:function(x){var C=this,y=C.down("[name=cbschemas]"),A=C.down("[name=cbtable]"),f=C.down("[name=cbfield]"),w=C.down("[name=cbcodefield]"),z=C.down("[name=cbsortfield]"),e=C.down("[name=viewmode]"),v=C.down("[name=displabel]"),a=C.down("[name=rftb1]"),c=C.down("[name=rftxt1]"),E=C.down("[name=rftb2]"),b=C.down("[name=rftxt2]"),D=C.down("[name=rftb3]"),F=C.down("[name=rftxt3]"),q=C.down("[name=rftc1]"),p=C.down("[name=rftc2]"),o=C.down("[name=rftc3]"),l,k,h,j=y.getValue(),u=A.getValue(),B=f.getValue(),t=w.getValue(),s=z.getValue(),d=["codeschema","codetable","codetableuid","codefield","valuefield","sortfield","codefilter1","codefilter2","codefilter3","codemapping","viewmode","displabel"];function g(J,H){var G,I;for(G=0;G<J.store.data.items.length;G++){I=J.store.data.items[G];if(I.get("uid")==H){return I}}return null}j=g(y,j);u=g(A,u);B=g(f,B);t=g(f,t);s=g(f,s);a=g(a,a.getValue());E=g(E,E.getValue());D=g(D,D.getValue());a=(a?a.get("nodepath"):null);E=(E?E.get("nodepath"):null);D=(D?D.get("nodepath"):null);l=a&&c.getValue()?a+"|"+c.getValue()+"|"+q.getValue():null;k=E&&b.getValue()?E+"|"+b.getValue()+"|"+p.getValue():null;h=D&&F.getValue()?D+"|"+F.getValue()+"|"+o.getValue():null;var n="";if(B&&B.get("nodepath")){C.rec.set("edited",true);C.rec.set("codeschema",j.get("uid"));C.rec.set("codetable",u.get("nodepath"));C.rec.set("codetableuid",u.get("uid"));C.rec.set("codefield",t.get("nodepath"));C.rec.set("valuefield",B.get("nodepath"));if(s){C.rec.set("sortfield",s.get("nodepath"))}C.rec.set("codefilter1",l);C.rec.set("codefilter2",k);C.rec.set("codefilter3",h);n=u.get("name")+"."+B.get("name")}else{C.rec.set("edited",true);$.each(d,function(H,G){C.rec.set(G,"")})}C.rec.set("codemapping",n);C.rec.set("viewmode",e.getValue());C.rec.set("displabel",v.getValue());if(C.pitem){C.pitem.edited=true;$.each(d,function(H,G){C.pitem[G]=C.rec.get(G)})}},sK3:function(){if(this.pooluid){var a=this,b=new IG$._I3e();b.init(a,{ack:"25",payload:IG$._I2d({uid:this.pooluid,option:"StoredContent"},"uid;option"),mbody:IG$._I2e({})},a,a.rs_sK3,null,null);b._l()}},rs_sK3:function(a){var c,g,f,d,b=[],e=this.down("[name=cbschemas]");g=IG$._I18(a,"/smsg/item");if(g){f=IG$._I26(g);for(c=0;c<f.length;c++){d=IG$._I1c(f[c]);d.tables=[];b.push(d)}e.store.loadData(b,true);e.setValue(this.rec.get("codeschema"))}},sK5:function(c){var a=this,b=new IG$._I3e();b.init(a,{ack:"25",payload:IG$._I2d({uid:c.data.uid,option:"StoredContent"},"uid;option"),mbody:IG$._I2e({})},a,a.rs_sK5,null,c);b._l()},rs_sK5:function(e,b){var d,a,f,h,j=this.down("[name=cbtable]"),g,c=this.rec.get("codetable");b.data.tables=[];a=IG$._I18(e,"/smsg/item");if(a){f=IG$._I26(a);for(d=0;d<f.length;d++){h=IG$._I1c(f[d]);h.fields=[];b.data.tables.push(h);if(h.nodepath==c){g=h.uid}}}j.store.loadData(b.data.tables,false);j.setValue(g)},sK4:function(c){var a=this,b=new IG$._I3e();b.init(a,{ack:"25",payload:IG$._I2d({uid:c.data.uid,option:"StoredContent"},"uid;option"),mbody:IG$._I2e({})},a,a.rs_sK4,null,c);b._l()},rs_sK4:function(z,x){var D=this,u,t,k,B,a,G=D.down("[name=cbfield]"),F=D.down("[name=cbcodefield]"),c=D.down("[name=cbsortfield]"),s=D.down("[name=displabel]"),b=D.down("[name=viewmode]"),o=D.rec.get("codefield"),e=D.rec.get("valuefield"),h=D.rec.get("sortfield"),C=D.rec.get("viewmode"),g=D.rec.get("displabel"),l,A,y;x.data.fields=[];k=IG$._I18(z,"/smsg/item");if(k){B=IG$._I26(k);for(u=0;u<B.length;u++){a=IG$._I1c(B[u]);a.uid=a.uid||u;x.data.fields.push(a);if(a.nodepath==o){l=a.uid}if(a.nodepath==e){A=a.uid}if(a.nodepath==h){y=a.uid}}}G.store.loadData(x.data.fields,false);F.store.loadData(x.data.fields,false);F.setValue(l);G.setValue(A);c.store.loadData(x.data.fields,false);c.setValue(y);b.setValue(C||"");s.setValue(g||"");D.down("[name=rftb1]").store.loadData(x.data.fields,false);D.down("[name=rftb2]").store.loadData(x.data.fields,false);D.down("[name=rftb3]").store.loadData(x.data.fields,false);var E,w,d,p,v,q,n;for(u=1;u<4;u++){E=D.rec.get("codefilter"+u);if(E){w=D.down("[name=rftb"+u+"]");d=D.down("[name=rftxt"+u+"]");v=D.down("[name=rftc"+u+"]");if(E.indexOf("|")>-1){D.down("[name=rfilter"+u+"]").expand();p=E.substring(0,E.indexOf("|"));q=E.substring(E.indexOf("|")+1);n="1";if(q.indexOf("|")>-1){n=q.substring(q.indexOf("|")+1);q=q.substring(0,q.indexOf("|"))}d.setValue(q);v.setValue(parseInt(n));for(t=0;t<x.data.fields.length;t++){if(x.data.fields[t].nodepath==p){w.setValue(x.data.fields[t].uid);break}}}}}},initComponent:function(){var a=[];$.each(IG$._IE1,function(b,c){a.push({value:c[0],name:c[1]})});$s.apply(this,{items:[{xtype:"fieldset",checkboxToggle:this.d_m=="cmap"?false:true,title:IRm$.r1("L_LOOKUP"),collapsed:false,layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"combobox",name:"cbschemas",queryMode:"local",fieldLabel:IRm$.r1("L_SCHEMA"),displayField:"name",valueField:"uid",editable:false,autoSelect:false,store:{fields:["name","memo","uid","type","nodepath"]},listeners:{change:function(h,d,g){if(d){var f=this.down("[name=cbschemas]"),c=this.down("[name=cbtable]"),e,b;for(e=0;e<f.store.data.items.length;e++){b=f.store.data.items[e];if(b.data.uid==d){if(b.data.tables&&b.data.tables.length>0){c.store.loadData(b.data.tables,false)}else{this.sK5(b)}break}}}},scope:this}},{xtype:"combobox",name:"cbtable",queryMode:"local",fieldLabel:"Table",displayField:"name",valueField:"uid",editable:false,autoSelect:false,store:{fields:["name","memo","uid","type","nodepath"]},listeners:{change:function(h,d,c){if(d){var g=this,l=g.down("[name=cbtable]"),j=g.down("[name=cbfield]"),k=g.down("[name=cbcodefield]"),b=g.down("[name=cbsortfield]"),e,f;for(e=0;e<l.store.data.items.length;e++){f=l.store.data.items[e];if(f.data.uid==d){if(f.data.fields&&f.data.fields.length>0){j.store.loadData(f.data.fields,false);k.store.loadData(f.data.fields,false);b.store.loadData(f.data.fields,false);g.down("[name=rftb1]").store.loadData(f.data.fields,false);g.down("[name=rftb2]").store.loadData(f.data.fields,false);g.down("[name=rftb3]").store.loadData(f.data.fields,false)}else{this.sK4(f)}break}}}},scope:this}},{xtype:"combobox",name:"cbcodefield",queryMode:"local",fieldLabel:"Code Field",displayField:"name",valueField:"uid",editable:false,autoSelect:true,store:{fields:["name","memo","uid","type","nodepath"]}},{xtype:"combobox",name:"cbfield",queryMode:"local",fieldLabel:"Value Field",displayField:"name",valueField:"uid",editable:false,autoSelect:true,store:{fields:["name","memo","uid","type","nodepath"]}},{xtype:"combobox",name:"cbsortfield",queryMode:"local",fieldLabel:"Sort Field",displayField:"name",valueField:"uid",editable:false,autoSelect:true,store:{fields:["name","memo","uid","type","nodepath"]}}]},{xtype:"fieldset",title:IRm$.r1("L_ADV_OPTION"),collapsed:false,layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"combobox",fieldLabel:"Data View",name:"viewmode",queryMode:"local",editable:false,valueField:"value",displayField:"name",store:{xtype:"store",fields:["name","value"],data:[{name:"Matching Values",value:""},{name:"Show All Codes",value:"code"},{name:"Show All Values",value:"value"}]}},{xtype:"combobox",fieldLabel:"Label Value",name:"displabel",queryMode:"local",editable:true,valueField:"value",displayField:"name",store:{xtype:"store",fields:["name","value"],data:[{name:"Mapped values",value:""},{name:"{CODE} {VALUE}",value:"{CODE} {VALUE}"},{name:"{CODE} {SORT} {VALUE}",value:"{CODE} {SORT} {VALUE}"}]}}]},{xtype:"fieldset",name:"rfilter1",checkboxToggle:true,title:"Range Filter 1st",collapsed:true,layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"combobox",name:"rftb1",fieldLabel:"Filter Field",queryMode:"local",displayField:"name",valueField:"uid",editable:false,autoSelect:true,store:{fields:["name","memo","uid","type","nodepath"]}},{xtype:"combobox",name:"rftc1",fieldLabel:IRm$.r1("L_OPERATOR"),queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{fields:["name","value"],data:a}},{xtype:"textfield",name:"rftxt1",fieldLabel:"Filter Value"}],listeners:{collapse:function(c,b){this.down("[name=rftb1]").setValue("");this.down("[name=rftxt1]").setValue("")}}},{xtype:"fieldset",name:"rfilter2",checkboxToggle:true,title:"Range Filter 2nd",collapsed:true,layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"combobox",name:"rftb2",fieldLabel:"Filter Field",queryMode:"local",displayField:"name",valueField:"uid",editable:false,autoSelect:true,store:{fields:["name","memo","uid","type","nodepath"]}},{xtype:"combobox",name:"rftc2",fieldLabel:IRm$.r1("L_OPERATOR"),queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{fields:["name","value"],data:a}},{xtype:"textfield",name:"rftxt2",fieldLabel:"Filter Value"}],listeners:{collapse:function(c,b){this.down("[name=rftb2]").setValue("");this.down("[name=rftxt2]").setValue("")}}},{xtype:"fieldset",name:"rfilter3",checkboxToggle:true,title:"Range Filter 3rd",collapsed:true,layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"combobox",name:"rftb3",fieldLabel:"Filter Field",queryMode:"local",displayField:"name",valueField:"uid",editable:false,autoSelect:true,store:{fields:["name","memo","uid","type","nodepath"]}},{xtype:"combobox",name:"rftc3",fieldLabel:IRm$.r1("L_OPERATOR"),queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{fields:["name","value"],data:a}},{xtype:"textfield",name:"rftxt3",fieldLabel:"Filter Value"}],listeners:{collapse:function(c,b){this.down("[name=rftb3]").setValue("");this.down("[name=rftxt3]").setValue("")}}}]});IG$._IA8a.superclass.initComponent.apply(this,arguments)}});IG$._IA8=$s.extend($s.window,{modal:true,region:"center",layout:"fit",closable:false,resizable:false,width:400,height:550,callback:null,pitem:null,_IG0:function(){this.close()},_IFf:function(b){var a=this;if(b=="clear"){if(a.callback){a.callback.execute("clear");a._IG0()}}else{a.p_1._IFf.call(a.p_1);a.callback&&a.callback.execute();a._IG0()}},sK3:function(){var b=this,a=b.p_1||b.down("[name=p_1]");b.p_1=a;a.pooluid=b.pooluid;a.rec=b.rec;a.sK3.call(a)},initComponent:function(){this.title=IRm$.r1("L_T_LOOKUP");$s.apply(this,{items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},padding:10,autoScroll:true,items:[new IG$._IA8a({name:"p_1",d_m:"cube"})]}],buttons:["->",{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("L_CLEAR_LOOKUP"),handler:function(){this._IFf("clear")},scope:this},{text:IRm$.r1("B_CLOSE"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(){this.sK3()}}});IG$._IA8.superclass.initComponent.apply(this,arguments)}});IG$.c$bb=function(){var a=this;a.item={};a.objectinfo={};a.metric=null;a.geocode={enable:false,geolat:null,geolng:null};a.cubeinfo={styles:[]}};IG$.c$bb.prototype={l1:function(e){var g=this,b,f,h,l,d,k,j,a,c=g.geocode;b=IG$._I18(e,"/smsg/item");g.item=IG$._I1c(b);b=IG$._I18(e,"/smsg/item/objinfo");if(b){g.objectinfo=IG$._I1c(b)}b=IG$._I18(e,"/smsg/item/Metric");if(b){g.metric={name:IG$._I1b(b,"name"),fields:[]};b=IG$._I19(b,"FieldInfo");if(b){f=IG$._I26(b);for(d=0;d<f.length;d++){k=IG$._I1c(f[d]);g.metric.fields.push(k)}}}b=IG$._I18(e,"/smsg/item/Metric/CodeTable");if(b){a=g.codetable=IG$._I1c(b);a.rangefilter=[];h=IG$._I18(b,"RangeFilter");if(h){f=IG$._I26(h);for(d=0;d<f.length;d++){j={rangefield:IG$._I1b(f[d],"rangefield"),value:""};l=IG$._I18(f[d],"value");if(l){j.value=IG$._I24(l)||""}a.rangefilter.push(j)}}}b=IG$._I18(e,"/smsg/item/Metric/geocode");if(b){c.enable=IG$._I1b(b,"enable");h=IG$._I18(b,"geolat");if(h){c.geolat=IG$._I1c(h)}h=IG$._I18(b,"geolng");if(h){c.geolng=IG$._I1c(h)}}b=IG$._I18(e,"/smsg/item/mask");if(b){g.masktype=IG$._I1b(b,"type");g.maskpattern=IG$._I1a(b,"pattern");g.pattern_replace=IG$._I1a(b,"pattern_replace");g.aes_pp=IG$._I1a(b,"aes_pp")}b=IG$._I18(e,"/smsg/item/cubeinfo");if(b){h=IG$._I18(b,"AppStyle/Default");if(h){f=IG$._I26(h);for(d=0;d<f.length;d++){g.cubeinfo.styles.push({name:IG$._I1b(f[d],"name"),type:"appbase"})}}h=IG$._I18(b,"AppStyle/Custom");if(h){f=IG$._I26(h);for(d=0;d<f.length;d++){g.cubeinfo.styles.push({name:IG$._I1b(f[d],"name"),type:"appcustom"})}}h=IG$._I18(b,"CubeStyle/Custom");if(h){f=IG$._I26(h);for(d=0;d<f.length;d++){g.cubeinfo.styles.push({name:IG$._I1b(f[d],"name"),type:"cubestyle"})}}}},l2:function(){var d=this,c=[],a,b=d.geocode;c.push("<smsg><item uid='"+d.item.uid+"'>");if(d.objectinfo){c.push("<objinfo"+IG$._I21(d.objectinfo)+"/>")}if(d.metric){c.push("<Metric name='"+(d.metric.name||"")+"'>");c.push("<FieldInfo>");for(a=0;a<d.metric.fields.length;a++){c.push("<Field"+IG$._I21(d.metric.fields[a])+"/>")}c.push("</FieldInfo>");if(d.codetable){c.push("<CodeTable"+IG$._I21(d.codetable)+">");c.push("<RangeFilter>");for(a=0;a<d.codetable.rangefilter.length;a++){c.push("<Filter rangefield='"+d.codetable.rangefilter[a].rangefield+"'>");c.push("<value><![CDATA["+d.codetable.rangefilter[a].value+"]]></value>");c.push("</Filter>")}c.push("</RangeFilter>");c.push("</CodeTable>")}if(b){c.push("<geocode enable='"+(b.enable||"F")+"'>");if(b.geolat&&b.geolat.uid){c.push("<geolat uid='"+(b.geolat.uid||"")+"' name='"+b.geolat.name+"'/>")}if(b.geolng&&b.geolng.uid){c.push("<geolng uid='"+(b.geolng.uid||"")+"' name='"+b.geolng.name+"'/>")}c.push("</geocode>")}c.push("</Metric>");c.push("<mask type='"+(d.masktype||"")+"'>");c.push("<pattern><![CDATA["+(d.maskpattern||"")+"]]></pattern>");c.push("<pattern_replace><![CDATA["+(d.pattern_replace||"")+"]]></pattern_replace>");c.push("<aes_pp><![CDATA["+(d.aes_pp||"")+"]]></aes_pp>");c.push("</mask>")}c.push("</item></smsg>");return c.join("")}};IG$._Idf=$s.extend($s.window,{modal:true,region:"center",layout:{type:"fit",align:"stretch"},closable:false,resizable:true,width:480,height:520,callback:null,_IG0:function(){this.close()},_IFf:function(){var A=this,y=A.item;if(y){var u,d=A.down("[name=cb_sortdir]"),x=d.getGroupValue(),g=A.down("[name=cb_sorttype]"),b=A.down("[name=cb_sorttype]").getGroupValue(),v=A.down("[name=optstyle]"),c=A.down("[name=optremoveblank]"),q=A.down("[name=isdatetype]"),t=A.down("[name=dateformat]"),f=A.down("[name=usegeocode]"),z=A.down("[name=fname]"),k=IG$._I4c,j={},n="",w,o,B=y.objectinfo,p=y.metric?y.metric.fields:null,e=y.geocode,h;B.sortorder=(x=="")?null:x;B.sorttype=(b=="")?null:b;B.removeblank=c.getValue();B.itemstyle=v.getValue();B.isdatetype=(q.getValue()?"T":"F");B.dateformat=t.getValue();B.optsortitemuid=A.optsortitemuid;B.optsortitemname=A.optsortitemname;B.optdispitemname=A.optdispitemname;B.optdispitemuid=A.optdispitemuid;e.enable=f.getValue()==true?"T":"F";y.masktype=A.down("[name=masktype]").getValue();y.maskpattern=A.down("[name=mpattern]").getValue();y.pattern_replace=A.down("[name=mpattern_rep]").getValue();y.aes_pp=A.down("[name=aes_passph]").getValue();if(p&&p.length&&z.getValue()){p[0].name=z.getValue();h=p[0].nodepath;h=h.substring(0,h.lastIndexOf("/"))+"/"+p[0].name;p[0].nodepath=h}if(A.geolatuid&&A.geolatname){e.geolat={uid:A.geolatuid,name:A.geolatname}}if(A.geolnguid&&A.geolngname){e.geolng={uid:A.geolnguid,name:A.geolngname}}B.dateitems="CUSTOM";B.datecustom=A.down("[name=t_dateformat]").getValue()}if(A.callback){A.callback.execute(y);A._IG0()}else{var l=this,a=new IG$._I3e(),s=y.l2.call(y);a.init(l,{ack:"31",payload:IG$._I2d({uid:l.uid}),mbody:s},l,l.rs_fV6,null);a._l()}},rs_fV6:function(a){this._IG0()},_IFd:function(){var a=this;a.formulas=[];if(a.uid){a.a2()}},a1:function(){var y=this,w=y.item,z=w.objectinfo,s,v=z.sortorder||"",d=y.down("[name=optsortdir]"),a=z.sorttype||"",h=y.down("[name=optsorttype]"),t=y.down("[name=optstyle]"),b=y.down("[name=optremoveblank]"),p=y.down("[name=optsortitemname]"),c=y.down("[name=optdispitemname]"),o=y.down("[name=isdatetype]"),q=y.down("[name=dateformat]"),f=y.down("[name=usegeocode]"),g=y.down("[name=cmap_disp]"),x=y.down("[name=fname]"),k=y.down("[name=masktype]"),j=IG$._I4c,u,n=[],e=w.geocode,l=w.metric?w.metric.fields:null;d.setValue({cb_sortdir:[v]});h.setValue({cb_sorttype:[a]});b.setValue(z.removeblank||false);o.setValue(z.isdatetype=="T"||false);q.setValue(z.dateformat||"");f.setValue(e.enable=="T");g.setValue(z.cmap_disp||"");x.setValue(l&&l.length?l[0].name:"");k.setValue(z.masktype||"");y.geolnguid=e.geolng?e.geolng.uid:null;y.geolngname=e.geolng?e.geolng.name:null;y.geolatuid=e.geolat?e.geolat.uid:null;y.geolatname=e.geolat?e.geolat.name:null;y.down("[name=geolat]").setValue(y.geolatname);y.down("[name=geolng]").setValue(y.geolngname);if(z.optsortitemuid){p.setValue(z.optsortitemname);y.optsortitemuid=z.optsortitemuid;y.optsortitemname=z.optsortitemname}if(z.optdispitemuid){c.setValue(z.optdispitemname);y.optdispitemuid=z.optdispitemuid;y.optdispitemname=z.optdispitemname}y.down("[name=masktype]").setValue(w.masktype||"");y.down("[name=mpattern]").setValue(w.maskpattern||"");y.down("[name=mpattern_rep]").setValue(w.pattern_replace||"");y.down("[name=aes_passph]").setValue(w.aes_pp||"");y.down("[name=optsortitem]").setVisible(z.cubetype=="SQLCube"||z.cubetype=="Cube");y.down("[name=optdispitem]").setVisible(z.cubetype=="SQLCube"||z.cubetype=="Cube");n.push({disp:"--- select ---",name:"",type:""});for(s=0;s<w.cubeinfo.styles.length;s++){n.push({disp:w.cubeinfo.styles[s].name,name:w.cubeinfo.styles[s].name,type:w.cubeinfo.styles[s].type})}t.store.loadData(n);t.setValue(z.itemstyle||"");y.down("[name=t_dateformat]").setValue(z.datecustom||"")},a2:function(){var a=this,b;b=new IG$._I3e();b.init(a,{cacheid:"",refresh:"",ack:"5",payload:IG$._I2d({uid:a.uid}),mbody:IG$._I2e({option:"diagnostics"})},a,a.rs_a2,false);b._l()},rs_a2:function(a){var c=this,b=new IG$.c$bb();b.l1.call(b,a);c.item=b;c.a1()},cdt:function(){var c=this,a=c.down("[name=dateformat]"),b="";a.setValue(b)},P2C:function(c){var a=this,b=new IG$._I96({visibleItems:c=="codemap"?"workspace;folder;codemap":"workspace;folder;metric;tabdimension;measuregroupdimension",u5x:{cubebrowse:true,rootuid:c=="codemap"?"/SYS_Lookup":a.item.objectinfo.cubeuid},callback:new IG$._I3d(a,a.rs_P2C,c)});IG$._I_5(a,b)},rs_P2C:function(a,e){var c=this,b=c.item,d=b.objectinfo;if(e=="codemap"){b.objectinfo.cmap_uid=a.uid;b.objectinfo.cmap_disp=a.name;c.down("[name=cmap_disp]").setValue(a.name)}else{if(e=="optsortitemname"){c.optsortitemuid=a.uid;c.optsortitemname=a.name;c.down("[name=optsortitemname]").setValue(a.name)}else{if(e=="optdispitemname"){c.optdispitemuid=a.uid;c.optdispitemname=a.name;c.down("[name=optdispitemname]").setValue(a.name)}else{if(e=="geolat"){c.geolatuid=a.uid;c.geolatname=a.name;c.down("[name=geolat]").setValue(a.name)}else{if(e=="geolng"){c.geolnguid=a.uid;c.geolngname=a.name;c.down("[name=geolng]").setValue(a.name)}}}}}},initComponent:function(){var b,a=this,e=[],d=a.styles,f=[{text:"Email",handler:function(){var j=this,g=j.down("[name=mpattern]"),h=j.down("[name=mpattern_rep]");g.setValue("(^[^@]{3}|(?!^)\\G)[^@]");h.setValue("$1*")},scope:this}],c=ig$.patterns;if(c){$.each(c,function(g,h){pitems.push({text:h.name,handler:function(){var l=this,j=l.down("[name=mpattern]"),k=l.down("[name=mpattern_rep]");j.setValue(h.value);h.replace&&k.setValue(h.replace)},scope:this})})}a.title=IRm$.r1("T_METRIC_SETTING");e.push({name:"-Item Default-",value:""});if(d&&d.length>0){for(b=0;b<d.length;b++){e.push({name:d[b].name,value:d[b].name})}}$s.apply(a,{bodyStyle:"padding:5px; background: #ffffff",border:0,items:[{xtype:"panel",layout:"fit",padding:"5 5",items:[{xtype:"tabpanel",items:[{xtype:"panel",layout:"anchor",autoScroll:true,bodyPadding:"5 5",title:"General Options",defaults:{anchor:"100%"},items:[{xtype:"fieldset",title:IRm$.r1("L_SORT_SEL"),layout:"anchor",padding:"0 5",defaults:{anchor:"100%"},items:[{xtype:"radiogroup",name:"optsortdir",fieldLabel:IRm$.r1("L_SORT_ORD"),padding:"0 5",plain:true,items:[{boxLabel:IRm$.r1("B_DEFAULT"),name:"cb_sortdir",inputValue:"",checked:true},{boxLabel:IRm$.r1("B_ASC"),name:"cb_sortdir",inputValue:"asc"},{boxLabel:IRm$.r1("B_DSC"),name:"cb_sortdir",inputValue:"desc"}]},{xtype:"radiogroup",name:"optsorttype",fieldLabel:IRm$.r1("L_SORT_TP"),padding:"0 5",plain:true,items:[{boxLabel:IRm$.r1("B_DEFAULT"),name:"cb_sorttype",inputValue:"",checked:true},{boxLabel:IRm$.r1("B_STRING"),name:"cb_sorttype",inputValue:"VARCHAR"},{boxLabel:IRm$.r1("B_NUMERIC"),name:"cb_sorttype",inputValue:"NUMBER"}]},{xtype:"fieldcontainer",name:"optdispitem",fieldLabel:IRm$.r1("L_F_DISP"),hidden:true,layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",name:"optdispitemname",flex:1},{xtype:"button",text:"..",handler:function(){this.P2C("optdispitemname")},scope:this},{xtype:"button",text:IRm$.r1("B_CLEAR"),handler:function(){var g=this;g.optdispitemname=null;g.optdispitemuid=null;g.down("[name=optdispitemname]").setValue("")},scope:this}]},{xtype:"fieldcontainer",name:"optsortitem",fieldLabel:IRm$.r1("L_F_SORT"),hidden:true,layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",name:"optsortitemname",flex:1},{xtype:"button",text:"..",handler:function(){this.P2C("optsortitemname")},scope:this},{xtype:"button",text:IRm$.r1("B_CLEAR"),handler:function(){var g=this;g.optsortitemname=null;g.optsortitemuid=null;g.down("[name=optsortitemname]").setValue("")},scope:this}]}]},{xtype:"fieldset",title:IRm$.r1("L_STYLE_OPTION"),layout:"anchor",padding:"3 5",items:[{xtype:"combobox",name:"optstyle",fieldLabel:IRm$.r1("L_BASE_STYLE"),queryMode:"local",displayField:"disp",valueField:"name",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","type","disp"]}}]},{xtype:"fieldset",title:IRm$.r1("L_OTHER_OPTION"),layout:"anchor",padding:"3 5",defaults:{anchor:"100%"},items:[{xtype:"checkbox",name:"optremoveblank",boxLabel:IRm$.r1("L_REM_BLK")},{xtype:"checkbox",name:"isdatetype",boxLabel:IRm$.r1("L_DATE_TYPE"),listeners:{change:function(p,l,q,n){var o=this,g=p.getValue(),j=o.down("[name=t_format]"),h=o.down("[name=d_format]"),k=o.down("[name=customdatetypecontainer]");j.setVisible(g);h.setVisible(g)},scope:this}},{xtype:"fieldcontainer",fieldLabel:IRm$.r1("L_DATE_FORMAT_SRC"),name:"d_format",labelWidth:130,hidden:true,layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",name:"dateformat",flex:1},{xtype:"button",text:"Example",menu:{items:[{text:"2001.07.04 AM 12:08:56",value:"yyyy.MM.dd a HH:mm:ss",handler:function(){var g=a.down("[name=dateformat]");g.setValue(this.value)}},{text:"2001-07-04 AM 12:08:56",value:"yyyy-MM-dd a HH:mm:ss",handler:function(){var g=a.down("[name=dateformat]");g.setValue(this.value)}},{text:"Wed, Jul 4, '01",value:"EEE, MMM d, ''yy",handler:function(){var g=a.down("[name=dateformat]");g.setValue(this.value)}},{text:"20010704120856",value:"yyyyMMddHHmmss",handler:function(){var g=a.down("[name=dateformat]");g.setValue(this.value)}}]}}]},{xtype:"fieldcontainer",fieldLabel:IRm$.r1("L_DATE_FORMAT_TGT"),name:"t_format",labelWidth:130,hidden:true,layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",name:"t_dateformat",flex:1},{xtype:"button",text:"Example",menu:{items:[{text:"2001.07.04 AM 12:08:56",value:"yyyy.MM.dd a HH:mm:ss",handler:function(){var g=a.down("[name=t_dateformat]");g.setValue(this.value)}},{text:"2001-07-04 AM 12:08:56",value:"yyyy-MM-dd a HH:mm:ss",handler:function(){var g=a.down("[name=t_dateformat]");g.setValue(this.value)}},{text:"Wed, Jul 4, '01",value:"EEE, MMM d, ''yy",handler:function(){var g=a.down("[name=t_dateformat]");g.setValue(this.value)}},{text:"20010704120856",value:"yyyyMMddHHmmss",handler:function(){var g=a.down("[name=t_dateformat]");g.setValue(this.value)}}]}}]}]},{xtype:"fieldset",title:IRm$.r1("L_CODE_FIELD"),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch"},fieldLabel:IRm$.r1("L_CODE_FIELD"),items:[{xtype:"textfield",name:"cmap_disp",readOnly:true,flex:1},{xtype:"button",text:"..",handler:function(){this.P2C("codemap")},scope:this},{xtype:"button",text:IRm$.r1("B_CLEAR"),handler:function(){var h=this,g=h.item,j=g.objectinfo;h.down("[name=cmap_disp]").setValue("");j.cmap_disp="";j.cmap_uid=""},scope:this}]}]}]},{xtype:"panel",title:"Advanced Options",layout:"anchor",bodyPadding:"5 5",autoScroll:true,defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:"Field name",name:"fname"},{xtype:"fieldset",title:"Mask Text",layout:"anchor",items:[{xtype:"combobox",name:"masktype",fieldLabel:"Mask type",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"],data:[{name:"No Mask",value:""},{name:"RegExp Pattern",value:"pattern"},{name:"Base64 Encoding",value:"base64"},{name:"SHA-1",value:"sha1"},{name:"AES",value:"aes"}]},listeners:{change:function(h){var n=this,k=h.getValue(),l=n.down("[name=pb1]"),j=n.down("[name=mpattern_rep]"),g=n.down("[name=aes_passph]");l[k=="pattern"?"show":"hide"]();j[k=="pattern"?"show":"hide"]();g[k=="aes"?"show":"hide"]()},scope:this}},{xtype:"fieldcontainer",fieldLabel:"Mask Pattern",hidden:true,name:"pb1",layout:"hbox",items:[{xtype:"textfield",name:"mpattern"},{xtype:"button",text:"Example",menu:{xtype:"menu",items:f}}]},{xtype:"textfield",name:"mpattern_rep",hidden:true,fieldLabel:"Replace With"},{xtype:"textfield",name:"aes_passph",hidden:true,fieldLabel:"AES Pass Phrase (For decryption)"}]},{xtype:"fieldset",title:"Geo Code",layout:"anchor",items:[{xtype:"checkbox",fieldLabel:"Use geocode",name:"usegeocode",boxLabel:"Enable"},{xtype:"fieldcontainer",fieldLabel:"Latitude",layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",flex:1,name:"geolat"},{xtype:"button",text:"..",handler:function(){this.P2C("geolat")},scope:this}]},{xtype:"fieldcontainer",fieldLabel:"Longitude",layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",flex:1,name:"geolng"},{xtype:"button",text:"..",handler:function(){this.P2C("geolng")},scope:this}]},{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch"},items:[{xtype:"fieldcontainer",flex:1},{xtype:"button",text:"GeoMapping",handler:function(){var g=new IG$._Id7({uid:this.uid});IG$._I_5(this,g)},scope:this}]}]}]}]}]}],buttons:["->",{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(){this._IFd()}}});IG$._Idf.superclass.initComponent.apply(this,arguments)}});IG$._Id7=$s.extend($s.window,{title:"Geo Mapping",modal:true,region:"center",layout:"fit",closable:false,resizable:false,width:500,autoHeight:true,callback:null,_IG0:function(){this.close()},_IFf:function(){var c=this,b=[],a;this.callback&&this.callback.execute(b);this._IG0()},in$t:function(){var b=this;var a=b.down("[name=georeqtype]");if(ig$.geo_encoding&&ig$.geo_encoding.length>0){a.store.loadData(ig$.geo_encoding)}b.g1()},g1:function(){if(this.uid){var a=this,c="",d,b=new IG$._I3e();c="<smsg>";d=IG$._I2d({uid:this.uid,option:"valuelist"},"uid;option");c+="</smsg>";b.init(a,{ack:"18",payload:d,mbody:c},a,a.rs_g1,null);b._l()}},rs_g1:function(b){var d=this.uid,a=new IG$._ICd(b,d),c=this.down("[name=grd_data]");this.pool=a.pool;c.store.loadData(a.data)},g2:function(){var f=this,h=f.down("[name=georeqtype]").getValue();if(h){var a=this,e="",c,g=new IG$._I3e(),d,b=f.down("[name=grd_data]"),j;c=IG$._I2d({uid:this.uid,action:"geoencode",georeqtype:h},"uid;action;georeqtype");e="<smsg><items>";for(d=0;d<b.store.data.items.length;d++){j=b.store.data.items[d];if(!j.get("lat")||!j.get("lng")){e+="<item>";e+="<address><![CDATA["+j.get("code")+"]]></address>";e+="</item>"}}e+="</items></smsg>";g.init(a,{ack:"8",payload:c,mbody:e},a,a.rs_g2,null);g._l()}},rs_g2:function(j){var o=this,p=o.down("[name=georeqtype]").getValue(),a=IG$._I18(j,"/smsg/results"),l=(a?IG$._I26(a):null),c=o.down("[name=grd_data]"),e,b={},n,f,k,d,h;if(l){d=(IG$.geocoder&&IG$.geocoder[p])?IG$.geocoder[p]:null;if(d){for(e=0;e<l.length;e++){n=IG$._I19(l[e],"code");n=IG$._I24(n);k=IG$._I19(l[e],"result");k=IG$._I24(k);k=Base64.decode(k);h=d.getGeoCode(k);if(h.lat&&h.lng){b[n]=h}}}for(e=0;e<c.store.data.items.length;e++){f=c.store.data.items[e];h=b[f.get("code")];if(h){f.set("lat",h.lat);f.set("lng",h.lng)}}}},g3:function(){var f=this,h=f.down("[name=geosql]").getValue();if(f.uid&&h&&f.pool){var a=this,e="",c,g=new IG$._I3e(),d,b=f.down("[name=grd_data]"),j;c=IG$._I2d({uid:this.uid,action:"geoupdate",pool:this.pool},"uid;action;pool");e="<List>";e+="<SQL><![CDATA["+h+"]]></SQL>";e+="<items>";for(d=0;d<b.store.data.items.length;d++){j=b.store.data.items[d];if(j.get("lat")&&j.get("lng")){e+="<address lat='"+j.get("lat")+"' lng='"+j.get("lng")+"'><![CDATA["+j.get("code")+"]]></address>"}}e+="</items></List>";g.init(a,{ack:"8",payload:c,mbody:e},a,a.rs_g2,null);g._l()}},rs_g3:function(a){},initComponent:function(){var a=this;$s.apply(this,{defaults:{bodyStyle:"padding:10px"},items:[{xtype:"form",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"displayfield",value:"Address to geo axis values"},{xtype:"gridpanel",name:"grd_data",height:250,store:{xtype:"store",fields:["code","lat","lng"]},plugins:[{ptype:"cellediting",clicksToEdit:false}],columns:[{xtype:"gridcolumn",text:"Address",dataIndex:"code",flex:1},{xtype:"gridcolumn",text:"Latitude",dataIndex:"lat",editor:{allowBlank:false}},{xtype:"gridcolumn",text:"Longitude",dataIndex:"lng",editor:{allowBlank:false}}]},{xtype:"fieldset",title:"Get GeoEncode",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch"},items:[{xtype:"combobox",fieldLabel:"Geo Request Type",flex:1,name:"georeqtype",queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]}},{xtype:"button",text:"Update GeoCode",handler:function(){var b=this;b.g2()},scope:this}]},{xtype:"textarea",name:"geosql",fieldLabel:"Apply Database"},{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch"},items:[{xtype:"fieldcontainer",flex:1},{xtype:"button",text:"Run SQL",handler:function(){var b=this;b.g3()},scope:this}]}]}]}],buttons:["->",{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(b){this.in$t()}}});IG$._Id7.superclass.initComponent.apply(this,arguments)}});IG$._I9c=$s.extend($s.window,{modal:true,layout:"border",closable:false,resizable:true,width:650,height:500,_ILa:null,callback:null,globalstyle:null,globalstylemap:null,styleinfo:null,Mb_1:function(){var a=this,b=new IG$._I3e();b.init(a,{ack:"1",payload:IG$._I2d({address:"ReportStyle"}),mbody:IG$._I2e()},a,a.rs_Mb_1,null);b._l()},rs_Mb_1:function(h){var g=IG$._I18(h,"/smsg/item/themes"),o,p,k,q,n=[{name:"Select Item",value:""}],c,f=ig$.theme_id,a,b,e,d,s,l=["Global","Default","Custom","Item"];this.globalstyle=[];this.globalstylemap={};if(g){o=IG$._I26(g);if(!f){c=o[0]}else{for(e=0;e<o.length;e++){if(IG$._I1b(o[e],"name")==o){c=o[e];break}}if(!c){c=o[0]}}}if(c){for(e=0;e<l.length;e++){q=l[e];p=IG$._I18(c,q);if(p){b=IG$._I26(p);for(d=0;d<b.length;d++){k=new IG$._IF7(b[d],"global",false);this.globalstyle.push(k);n.push({name:k.name,value:k.name});this.globalstylemap[k.name]=k}}}for(q in this.globalstylemap){k=this.globalstylemap[q];if(k.custom==true&&k.basestylename&&this.globalstylemap[k.basestylename]){s=this.globalstylemap[k.basestylename];k._IFb.call(k,s)}}}this.down("[name=base_style]").store.loadData(n);this.Mb_2()},Mb_2:function(){var g=this,c,h,e,j,d=g.down("[name=stylelist]"),f=[],b,a;g.down("[name=c_cset]").setValue(g.c_cset||"");if(g.styleinfo){a={name:"LocalStyle",leaf:false,children:[]};f.push(a);for(c=0;c<g.styleinfo.length;c++){e=g.styleinfo[c];b={name:e.name,leaf:true,custom:false};if(e.basestylename&&g.globalstylemap[e.basestylename]){j=g.globalstylemap[e.basestylename];e._IFb.call(e,j)}a.children.push(b)}d.store.setRootNode({expanded:true,text:"Style",name:"Style",title:"Style",children:f})}},Mb_3:function(d){var a,c=this,b=c.down("[name=form_header]"),e=c.down("[name=form_data]");c.Mb_4();for(a=0;a<c.styleinfo.length;a++){if(c.styleinfo[a].name==d){c.__e1=c.styleinfo[a];c.__e2=1;c.down("[name=base_style]").setValue(c.styleinfo[a].basestylename||"");b.Mb_6.call(b,c.styleinfo[a].hs);e.Mb_6.call(e,c.styleinfo[a].ds);c.__e2=0;break}}},Mb_4:function(){var b=this,a=b.down("[name=form_header]"),d=b.down("[name=form_data]"),c=b.down("[name=base_style]").getValue();if(b.__e1&&c){b.__e1.basestylename=c;d.Mb_7.call(d);a.Mb_7.call(a)}},_IG0:function(){var a=this;a.callback&&a.callback.execute(a);a.close()},_IFf:function(){var c=this,a,d,b;c.Mb_4();for(a=0;a<c.styleinfo.length;a++){b=c.styleinfo[a];if(b.basestylename&&c.globalstylemap[b.basestylename]){d=c.globalstylemap[b.basestylename];b.Mb_16(d)}}c.c_cset=c.down("[name=c_cset]").getValue();c._IG0()},_t$:function(e){var d=this;switch(e){case"cmd_add_custom":var g=new IG$.mA$_s({styleinfo:this.globalstyle,callback:new IG$._I3d(this,this.rs__sK3a)});IG$._I_5(this,g);break;case"cmd_delete":var b,a=this.down("[name=stylelist]"),f=a.getSelectionModel().selected,c=f&&f.length>0?f.items[0]:null;if(c){for(b=0;b<d.styleinfo.length;b++){if(c.get("name")==d.styleinfo[b].name){d.styleinfo.splice(b,1);c.remove();break}}}break}},rs__sK3a:function(b){var o=b[0],h=b[1];if(h&&o){var c,e;e=this.globalstylemap[h];if(e){var d=this.down("[name=stylelist]"),j=d.store.getProxy(),f=j.getReader(),g,k,n,l=d.store.getRootNode();n=l.childNodes[l.childNodes.length-1];k={name:o,leaf:true,custom:true};g=new IG$._IF7(null,"item",true);g.name=o;g.nodename="ItemStyle";g.basestylename=h;g.hs=new IG$._IF8(null,"Header");g.ds=new IG$._IF8(null,"Data");this.styleinfo.push(g);g._IFb.call(g,e);var a=f.extractData.call(f,[k],true);d.store.fillNode.call(d.store,n,a)}}},initComponent:function(){var a=this,d=new IG$._Id0({title:IRm$.r1("L_STYLE_TITLE"),name:"form_header",htype:"hd"}),e=new IG$._Id0({title:IRm$.r1("L_STYLE_DATA"),name:"form_data",htype:"dt"}),f=[{name:"Default",value:""}],c=IG$.__c_.chartcolors,b;for(b in c){f.push({name:b,value:b})}a.title=IRm$.r1("T_STYLE_WIZARD");$s.apply(this,{defaults:{bodyStyle:"padding:3px"},items:[{xtype:"treepanel",title:"Style",name:"stylelist",preventHeader:true,region:"west",width:160,split:true,border:false,rootVisible:false,hideHeaders:true,autoScroll:true,store:{xtype:"treestore",fields:["name","text","type","pname","region","custom"],root:{expanded:true,name:"Style",children:[]},folderSort:false},useArrows:true,dockedItems:[{xtype:"toolbar",dock:"top",plain:true,items:[{iconCls:"icon-toolbar-add",tooltip:"Add Custom Style",text:"Add New",handler:function(){this._t$("cmd_add_custom")},scope:this},{iconCls:"icon-grid-delete",tooltip:"Delete",handler:function(){this._t$("cmd_delete")},scope:this}]}],columns:[{xtype:"treecolumn",text:"text",flex:2,sortable:false,dataIndex:"name"},{xtype:"actioncolumn",width:26,items:[{iconCls:"icon-grid-delete",tooltip:"Delete item",handler:function(h,k,g){var j=h.store.getAt(k)},getClass:function(h,k,l,n,j,g){if(n==0||l.isLeaf()==false||(l.data&&l.data.custom==false)){return"idv-hd-val"}return""}}]}],listeners:{afterrender:function(){var g=this},itemclick:function(h,g,k,j,n){var l=g.get("name");if(g.isRoot()==false&&l){a.Mb_3.call(a,l)}}}},{xtype:"form",region:"center",layout:{type:"vbox",align:"stretch"},items:[{xtype:"combobox",fieldLabel:"Inherit",name:"base_style",displayField:"name",valueField:"value",editable:false,queryMode:"local",store:{fields:["name","value"]},listeners:{change:function(g,j,o){var n=this,h=n.down("[name=base_style]").getValue(),k,l=n.down("[name=form_header]"),p=n.down("[name=form_data]");if(n.__e2){return}if(h){k=n.globalstylemap[h];if(k){l.Mb_6.call(l,k.hs);p.Mb_6.call(p,k.ds)}}},scope:this}},{xtype:"tabpanel",plain:true,flex:1,items:[e,d],bbar:[{xtype:"toolbar",items:[{xtype:"combobox",fieldLabel:"Chart Style",name:"c_cset",displayField:"name",valueField:"value",editable:false,queryMode:"local",store:{fields:["name","value"],data:f}}]}]}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(){this.Mb_1()}}});IG$._I9c.superclass.initComponent.apply(this,arguments)}});IG$._Icf=function(){};IG$._IC5=$s.extend(IG$._I57,{scroll:false,initialized:false,closable:true,autoScroll:false,collapseFirst:true,bodyBorder:false,layout:{type:"border"},dbscan:100,_i0:function(a,f,e){var d=this,c=d.metricdatas,g=[],b;a=(a)?a:d._gp;f=(f)?f:d._gpp;if(!a||(d._gp==a&&!e)){return}d._gp=a;d._gpp=f},_i1:function(l,e){var k=this,h=k.metricdatas,n=k.metricmap,d,a,f=l.get?l.get("__uid"):l.__uid,g=l.get?l.get("uid"):l.uid,b=l.get?l.get("name"):l.name,j=l.get?l.get("type"):l.type,c;for(d=0;d<h.length;d++){m=h[d];if(m.__uid==f){if(e==true){if(n[m.relpath]){delete n[m.relpath][m.name]}h.splice(d,1)}else{a=h[d]}break}}return a},_i2:function(d){var g=this,a=d.get("fieldname"),j=d.get("alias"),e=g.sqloption,c,h=e?e.columns:null,b,f;if(h){for(c=0;c<h.length;c++){if(h[c].fieldname==a||h[c].alias==j){b=h[c];break}}}if(b){f=new IG$._Ib2({fitem:b,callback:new IG$._I3d(g,function(){})});IG$._I_5(g,f)}else{IG$._I54(ig$.appname,IRm$.r1("E_NO_MATCH_FLD"),null,g,1,"error")}},rs__i3:function(b,e,a){var h=this,d=h.down("[name=t_btn]"),f=h.down("[name=mtree]"),c=b.get("nodepath"),k=b.get("uid"),j=(b.get("writable")=="T"||b.get("manage")=="T")?true:false,g=(b.get("manage")=="T")?true:false;if(!b.isExpanded()&&!e&&!a){b.expand()}d.setDisabled(true);h._s1=b;if(j||g){d.setDisabled(false)}h.sK7(k);h._i0(k,c)},_c:function(a){var b=this;b._i0.call(b,null,null,true);if(!b.uid){b.$f1.call(b,false)}else{b.sK4L.call(b,true,a)}},_d:function(a){var c=this,b=c.down("[name=mtree]");if(c._s1){c.__luid=null;b._I90.call(b,a,c._s1.get("uid"),c._s1.get("nodepath"),c._s1)}},_2:function(k,n,g,j,h,a){var l=this,b,p,c,b,e=l.itemtype,f;c={};IG$._I1d(k,c,"nodepath;datasize;datatype;tablename;fieldname;sqlfield;alias;sequence;uniquekey;mcuid;fieldid");c.name=k.alias||k.name;if(e=="NoSQL"){f=c.name.split("/");c.name=f.join(".")}b=l.metricmap[g];if(b&&b[c.name]){p=1;while(true){if(b[c.name+"("+p+")"]){p++}else{c.name+="("+p+")";break}}}c.fieldfullpath=k.nodepath;c.tableuid=j;c.tablename=h;c.tableseq=a;if(n){c.nodepath=n+c.name;c.relpath=l.sK8(c.nodepath,c.name)}c.fieldname=k.fieldname||k.name;c.fieldinfo=e=="SQLCube"||e=="DataCube"||e=="NoSQL"?c.fieldname:c.tablename+(c.tableseq!="0"?"#"+c.tableseq:"")+"."+c.fieldname;c.codemapping=(c.valuefield&&c.valuefield)?c.codetable+"."+c.valuefield:"";c.__uid=c.__uid||"s_"+(l.__uid++);IG$._I1d(k,c,"codefield;sortfield;codeschema;codetable;codetableuid;valuefield;codefilter1;codefilter2;codefilter3;viewmode;displabel;uid;pid;alias;sequence;uniquekey;mcuid");return c},_3:function(f,l,k,g,a){var b=this,n,h,e,d,c=b.metricmap,j=b.metricdatas,p;b._gpp=b._gpp||"";h=b.sK8.call(b,b._gpp)+"/";e=h.substring(1);if(b.nodepath){n=b.nodepath+h}if(!c[h]){c[h]={}}c=c[h];f.pid=b._gp;d=b._2(f,n,h,k,g,a);d.folder=e;d.type="Metric";d.iconcls=IG$._I11("metric");c[d.name]=d;d.__uid=d.__uid||"s_"+(this.__uid++);b.dataview.store.add([d]);b.metricdatas.push(d);b._c.call(b);b._i0.call(b,null,null,true)},_1:function(g,q,p,v){var a=this,h,n,c,l=[],s,y,f,x,b=a.metricmap,k,e,w;k=a.sK8.call(a,a._gpp||"")+"/";e=k.substring(1);if(a.nodepath){s=a.nodepath+k}else{s="*"+k}if(!b[k]){b[k]={}}b=b[k];for(h=0;h<q.length;h++){n=q[h].data;if(n.checked){n.pid=a._gp;c=a._2(n,s,k,g.uid,g.name,g.seq);c.folder=e;c.type="Metric";c.iconcls=IG$._I11("metric");b[c.name]=c;l.push(c);a.dataview.store.add([c])}}a.metricdatas=a.metricdatas||[];for(h=0;h<l.length;h++){a.metricdatas.push(l[h])}a._c.call(a,v)},_s5:function(c,d){var a=this,b=new IG$._I3e();b.init(a,{ack:"31",payload:IG$._I2d({uid:d.get("uid"),name:d.get("name"),itemtype:d.get("type"),description:d.get("description"),memo:d.get("memo")},"uid;name;itemtype;pid;description;memo"),mbody:IG$._I2e({option:"rename"})},a,function(f){var n=a.metricmap,e=n[d.get("relpath")],j,l=d.get("uid"),g=d.get("__uid"),h;if(e){for(j in e){if((e[j].uid&&e[j].uid==l)||(!e[j].uid&&e[j].__uid==g)){h=e[j];h.name=d.get("name");delete e[j];e[h.name]=h;break}}}d.set("edited",false)},null);b._l()},_5:function(g,e){var a=this,f=a._i1(g,false),d,c,b;if(e=="set"){b=new IG$._IA8({pooluid:a.pooluid,rec:g,pitem:f,callback:new IG$._I3d(a,function(j){var h=this;if(j=="clear"){h._5(g,"unset")}})});IG$._I_5(a,b)}else{d="codefield;sortfield;codeschema;codetable;codetableuid;valuefield;codefilter1;codefilter2;codefilter3;viewmode;displabel".split(";");g.set("edited",true);for(c=0;c<d.length;c++){g.set(d[c],"");f[d[c]]=""}g.set("codemapping","")}},_6:function(){var b=this,c=b.securityfilter,a;if(c&&c.length>0){a=new IG$._Id9({uid:b.uid,securityfilter:c});IG$._I_5(b,a)}else{a=new IG$._Icb({callback:new IG$._I3d(b,function(j){var e=[],g,h,f="",k="";for(g=0;g<j.length;g++){var d={sid:j[g].get("sid"),name:j[g].get("name")};e.push(d)}if(e.length>0){h=new IG$._IEb(null);for(g=0;g<e.length;g++){f+=(g>0?";":"")+e[g].name;k+=(g>0?";":"")+e[g].sid}h.authname=f;h.authuid=k;h.active=true;b._7(h,true)}})});IG$._I_5(b,a)}},_7:function(d,b){var c=this,a=new IG$._Ia1({_ILb:{filter:d},_ILa:{cubeuid:c.uid},callback:new IG$._I3d(c,function(e){if(b==true){var f=e.filter;c.securityfilter.push(f)}})});IG$._I_5(c,a)},_t$:function(c){var l=this,a,b,d=[],h=l.dataview,e,k,g,j;switch(c){case"cmd_save":if(!l.uid){l.$f1(false)}else{l.sK4L()}break;case"cmd_saveas":l.$f1(false);break;case"cmd_model":l.sK5_m1a();break;case"cmd_model_new":b=IG$._I7d||null;b.m1$7.call(b,null,"CubeModel".toLowerCase(),"New DataModel",null,null,true);break;case"cmd_model_edit":if(l.modeluid){IG$._n1(l.modeluid)}break;case"cr":l.__luid=null;l.sK5();break;case"cmd_delete":IG$._I55(IRm$.r1("B_CONFIRM"),IRm$.r1("B_CD_CHS"),function(n){if(n=="yes"){l.sk5m.call(l)}},l,l);break;case"cmd_regmeasures":l.sk5n();break;case"cmd_style":l.sk5o();break;case"cmd_sec_filter":l._6();break;case"cmd_hl_option":a=new IG$._Ie7({_piobj:l,callback:new IG$._I3d(l,function(){})});IG$._I_5(l,a);break;case"cmd_pre_proc":a=new IG$.MwPP({cube:l,callback:new IG$._I3d(l,l.rs_OP)});IG$._I_5(l,a);break;case"cmd_mdb_option":a=new IG$.MwPo({callback:new IG$._I3d(l,l.rs_Op)});IG$._I_5(l,a);break;case"cmd_nosql_option":a=new IG$._Ic2({dbtype:l.dbtype,dbnodes:l.dbnodes,dbname:l.dbname,callback:new IG$._I3d(l,function(n){var o=this;if(n){o.dbnodes=n.dbnodes;o.dbtype=n.dbtype;o.dbname=n.dbname;o.mC1()}})});IG$._I_5(l,a);break;case"cmd_join_add":a=new IG$.DM2({modelcontent:l.modelcontent,callback:new IG$._I3d(l,l.rs__9)});IG$._I_5(l,a);break;case"cmd_join_delete":l._8();break;case"cmd_sql_input":k=new IG$._Icf();k.sqloption=l.sqloption;a=new IG$._Ib1({wmode:"sqlcube",uid:l.uid,_ILb:k,columns:k.sqloption.columns,callback:new IG$._I3d(l,l.rs_SOp)});IG$._I_5(l,a);break;case"cmd_query_tool":k=new IG$._Icf();g=k.sqloption={};j=l.sqloption;if(j){g.sql=j.sql||j.sqlquery;g.columns=[];g.dbpool=j.dbpool}a=new IG$._Ibe({_ILb:k});IG$._I_5(l,a);break;case"cmd_report":var f=IG$._I7d;f&&f.m1$7.call(f,null,"report","New Report",null,true,true,null,{cubeuid:l.uid});break;case"cmd_import":l.sK3a();break;case"cmd_ld_file":if(l.d1()==true){l.MmD1()}break;case"cmd_buildcube":l.Mmm1();break;case"cmd_add_metric":l.Mmm2();break;case"cmd_sql":if(l.d1()==true){l.MmD2()}break;case"cmd_db_unload":req=new IG$._I3e();req.init(l,{ack:"17",payload:IG$._I2d({cubeuid:l.uid,action:"unlockcube"},"cubeuid;action"),mbody:"<smsg></smsg>"},l,function(){IG$._I54(ig$.appname,IRm$.r1("B_SUCCESS"),null,l,0,"success")},null);req._l();break;case"cmd_db_load":req=new IG$._I3e();req.init(l,{ack:"17",payload:IG$._I2d({cubeuid:l.uid,action:"loadcube"},"cubeuid;action"),mbody:"<smsg></smsg>"},l,function(){IG$._I54(ig$.appname,IRm$.r1("B_SUCCESS"),null,l,0,"success")},null);req._l();break;case"cmd_db_destroy":IG$._I55("Confirm delete DB?","Click ok button to delete molap db content.",l.Mlm1,l,l);break}},sK3a:function(){var h=this,n=[],e,l=h.down("[name=datainfo]"),d=h.dataset,j,a,b,f,c,g;for(e=0;e<l.store.data.items.length;e++){c=l.store.data.items[e];g=c.get("name");f=c.get("uid");n.push({name:g,uid:f,selected:false})}var k=new IG$._Idc({ufiles:n,callback:new IG$._I3d(h,function(C){var x=this,u=C.fileuid,q=new IG$._I3e(),D=C.datalabel,z=C.uploadmode,I=C.delimiter,o=C.deletemode,A=C.targetsheet,y=C.file_encoding,s=x.down("[name=datainfo]"),w=x.dataset,H,G,t,F,v,B,p=s.store,E=p.data.items;if(E.length>0){if(z==false){sitemcount=0;for(B=0;B<E.length;B++){v=E[B];F=v.get("name");if(F.substring(0,D.length)==D){if(F==D){sitemcount=Math.max(sitemcount,1)}else{F=F.substring(D.length);F=F.replace(/[^0-9]/g,"");sitemcount=Math.max(sitemcount,parseInt(F)+1)}}}if(sitemcount>0){D+="("+sitemcount+")"}}else{H=A;if(!H){H=null;for(B=0;B<E.length;B++){v=E[B];F=v.get("name");if(F==D){H=v.get("uid");break}}}}}x.setLoading(true,true);q.init(x,{ack:"27",payload:IG$._I2d({uid:u,delimiter:I,uploadmode:(z==true?"T":"F"),deletemode:(o==true?"T":"F"),regfile:H,file_encoding:y},"uid;delimiter;uploadmode;deletemode;regfile;file_encoding"),mbody:IG$._I2e({option:"storedatacontent"})},x,x.rs_sK3b,null,[100,D,z,o,H]);q._l()})});IG$._I_5(h,k)},rs_sK3b:function(a,d){var b=this,c=IG$._I18(a,"/smsg/item");datauid=(c)?IG$._I1b(c,"uid"):null,req=new IG$._I3e(),cnt=d[0],datalabel=d[1],uploadmode=d[2],deletemode=d[3],regfile=d[4];cnt=(cnt==null||typeof(cnt)=="undefined")?100:cnt;if(datauid){d.push(datauid);req.init(b,{ack:"5",payload:IG$._I2d({uid:datauid}),mbody:IG$._I2e({limit:cnt})},b,b.rs_sK3b_nn,null,d);setTimeout(function(){req._l.call(req)},300)}else{b.setLoading(false)}},cxc:function(e){var b=this,a=b.down("[name=datainfo]").store,d=a.data.items[e],c;c=new IG$._Ie9({uid:d.get("uid")});c.show(b)},rs_sK3b_nn:function(A,B){var D=new IG$._IF1(A),x,u,w,e,F=this,k,s,b,v=B[0],z=B[1],p=B[2],a=B[3],E=B[4],g=B[5],q,f=F.headermap,t=false,C={},c,o=F.dataset,d=F.down("[name=datainfo]"),l,n,f,y;F.setLoading(false);if(D.data.length>0){w=D.header;f=F.headermap;for(x=0;x<w.length;x++){y=w[x];s=(y.type=="numeric"?true:false);b=null;if(!f[y.name]){c={name:y.name,datatype:y.type,fieldname:y.name,fieldid:"column_"+(F._dcolumns.length+1)};F._dcolumns.push(c);f[c.fieldname]=c}else{f[y.name].datatype=y.type;f[y.name].name=y.name}}if(p==true&&E){for(x=0;x<d.store.data.items.length;x++){l=d.store.data.items[x];if(l.get("uid")==E){l.set("uid",g);break}}}else{d.store.insert(0,{name:z,uid:g})}F.sK4L(true);F.C_();F._i0(null,null,true)}else{IG$._I54(ig$.appname,IRm$.r1("L_NO_DATA"),null,null,1,"error")}},_8:function(){var f=this,b=f.down("[name=grd_join]"),a=b.store,e,d,g,c,h;for(e=a.data.items.length-1;e>=0;e--){h=a.data.items[e];if(h.get("selected")==true){g=h.get("joinfrom");c=h.get("jointo");for(d=f.relations.length-1;d>=0;d--){if(f.relations[d].joinfrom==g&&f.relations[d].jointo==c){f.relations.splice(d,1)}}a.removeAt(e)}}},rs__9:function(d){var b=this,e=new IG$._IEa(null),a=b.down("[name=grd_join]");e.source=d.source;e.target=d.target;e.MX();b.relations.push(e);a.store.add({joinfrom:e.joinfrom,jointo:e.jointo,joincondition:e.joincondition})},$f1:function(a){var b=this,c=new IG$._I96({mode:"newitem",initpath:b.nodepath,callback:new IG$._I3d(b,b.$f2,a)});IG$._I_5(b,c)},$f2:function(f,b){var e=this,d=IG$._I2e(),c=new IG$._I3e(),a=e.itemtype;c.init(e,{ack:"31",payload:"<smsg><item address='"+f.nodepath+"/"+f.name+"' name='"+f.name+"' type='"+(a?a:"Cube")+"' pid='"+f.uid+"' description='' source_uid='"+(e.uid||"")+"'/></smsg>",mbody:d},e,e._IO5,null,[f.name,b,f.nodepath,f.uid,d]);c.showerror=true;c._l()},_IO5:function(a){var c=this,d=IG$._I18(a,"/smsg/item"),b;if(d){c.uid=IG$._I1b(d,"uid");c.nodepath=IG$._I1b(d,"nodepath");b=IG$._I1b(d,"name");c.setTitle(b)}c.sK4L()},sk5n:function(){var f=this,d,h,e,b=[],g,c=f.dataview.store.data.items;for(d=0;d<c.length;d++){h=c[d];if(h.get("selected")==true&&h.get("uid")){e={};h.set("type",h.get("type")||h.get("itemtype"));h.set("type",h.get("type")=="Field"?"Metric":h.get("type"));IG$._I1d(h.data,e,"uid;name;type;memo;nodepath","s");e.measurename=h.get("name");e.formula=IG$._I34(h.get("datatype"))?"SUM":"COUNT DISTINCT";b.push(e)}}if(b.length>0){var a=new IG$._Ic9({metaitems:b,mfolder:f.mfolder,pcube:f,callback:new IG$._I3d(f,f.rs_sk5n)});IG$._I_5(f,a)}},rs_sk5n:function(b){var w,v,p=this,d="<smsg>",t="<smsg>",o,x,z,e,g=b.vmode,q=b.items,s=b.clocation,c,y=b.dialog,n=p.nodepath,a,l=b.tmpl,k,h,f,u;p.mfolder=s;for(w=0;w<q.length;w++){x=q[w];if(b.vmode){c=x.clocation+"/"}else{if(s.substring(0,"{parent}".length)=="{parent}"){u=x.nodepath.substring(0,x.nodepath.lastIndexOf("/"));c=u+s.substring("{parent}".length)+"/"}else{c=n+"/"+(s?(s+"/"):"")}}x.cloc=c;f=x.measurename;if(f.indexOf("/")>-1){f=f.split("/");f=f.join("&#x2044;")}z="<item name='"+f+"'";z+=" uid='"+c+f+"' type='"+(x.ctype||"Measure")+"' createstructure='T'";z+="/>";d+=z;if(x.ctype=="DateMetric"){e="<item ><objinfo  ";e+=IG$._I20({cubeuid:p.uid,dateformat:"DATE",fieldid:x.uid,fieldname:f,dbtype:"auto",issql:"T"},"cubeuid;dateformat;fieldid;fieldname;dbtype;issql","s");e+="/></item>"}else{switch(x.formula){case"COUNT DISTINCT":o="COUNT(DISTINCT ["+x.name+"])";break;case"TMPL":break;default:o=x.formula+"(["+x.name+"])";break}if(x.formula=="TMPL"&&l){o=l.expression;k=o.indexOf("[field]");while(k>-1){o=o.substring(0,k)+"["+x.name+"]"+o.substring(k+"[field]".length);k=o.indexOf("[field]")}e="<item name='"+x.measurename+"'";e+=">";e+="<Expression type='"+l.expressiontype+"' calcmode='"+(l.calcmode?"T":"F")+"'>";e+="<![CDATA["+o+"]]>";e+="</Expression>";e+="<Fields>";e+="<item name='"+x.name+"' uid='"+x.uid+"' nodepath='"+x.nodepath+"' type='"+x.type+"' datatype='"+x.datatype+"'/>";for(v=0;v<l.fields.length;v++){l.fields[v].type=l.fields[v].type||l.fields[v].itemtype;e+="<item "+IG$._I20(l.fields[v],"name;uid;type;nodepath;memo","s")+"/>"}e+="</Fields>";e+="</item>"}else{e="<item name='"+x.measurename+"'";e+=">";e+="<Expression type='"+x.formula+"'>";e+="<![CDATA["+o+"]]>";e+="</Expression>";e+="<Fields>";e+="<item name='"+x.name+"' uid='"+x.uid+"' nodepath='"+x.nodepath+"' type='"+x.type+"' datatype='"+x.datatype+"'/>";e+="</Fields>";e+="</item>"}}t+=e}d+="</smsg>";t+="</smsg>";p.setLoading(true);a=new IG$._I3e();a.init(p,{ack:"30",payload:d,mbody:t},p,p.rs_sk5n2,null,[y,q]);a._l()},rs_sk5n2:function(g,c){var n=this,o,l=c[0],k=c[1],a=IG$._I18(g,"/smsg"),j=IG$._I26(a),p,h,f,b,e,d=[],q;n.setLoading(false);for(e=0;e<k.length;e++){q=k[e];if(q.ctype=="DateMetric"&&j[e]){q.cuid=IG$._I1b(j[e],"uid");d.push(q)}}if(d.length){p="<smsg>";h="<smsg>";for(e=0;e<d.length;e++){$.each([{name:"YYYY",rname:"YEAR"},{name:"QUARTER"},{name:"MM"},{name:"DD",rname:"DAY"},{name:"WM",rname:"WEEKMONTH"},{name:"WEEK"}],function(s,t){f=IRm$.r1("B_"+t.rname+"");b=t.name;p+="<item  uid='"+k[e].cloc+"/"+d[e].measurename+"/"+f+"' pid='"+d[e].cuid+"' name='"+f+"' type='CustomMetric'/>";h+="<item  uid='"+k[e].cloc+"/"+d[e].measurename+"/"+f+"' pid='"+d[e].cuid+"' name='"+f+"' type='CustomMetric'>";h+="<Fields><item  uid='"+d[e].uid+"' name='"+d[e].uid+"' nodepath='' type='Metric'>";h+="</item></Fields><CustomMetricInfo  datedivision='"+b+"' dateformat='DATE' predefinetype='DATE' type='CUSTOM_FIELD' customdatetype=''></CustomMetricInfo>";h+="<Expression><$DATE_YYYY(["+d[e].name+"])$</Expression></item>"})}p+="</smsg>";h+="</smsg>";o=new IG$._I3e();o.init(n,{ack:"30",payload:p,mbody:h},n,function(s){IG$._I54(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")});o._l()}else{IG$._I54(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")}},sk5o:function(){var b=this,a=new IG$._I9c({styleinfo:b.customstyle,c_cset:b.c_cset,callback:new IG$._I3d(b,function(c){b.c_cset=c.c_cset})});IG$._I_5(b,a)},sk5m:function(){var e,h,j,g,a=this,f,b=a.dataview.store.data.items;j="";g="<smsg><info option='delete'/></smsg>";for(e=b.length-1;e>=0;e--){h=b[e].data;if(h.selected==true&&h.uid){j+="<item uid='"+h.uid+"' name='"+h.name+"' type='"+h.type+"'/>"}else{if(h.selected){a._i1(b[e],true)}}}if(j){req=new IG$._I3e();req.init(a,{ack:"30",payload:"<smsg>"+j+"</smsg>",mbody:g},a,a.rs_sK4Ld,null);req._l()}else{a._i0(null,null,true)}},rs_sK4Ld:function(a){var e=this,c,g,b=e.dataview.store,f=e.metricmap,d,h;for(c=b.data.items.length-1;c>=0;c--){g=b.data.items[c];if(g.get("selected")){h=g.get("relpath");if(h&&f[h]){delete f[h][g.get("name")]}b.remove(g)}}},sK4L:function(c,b){var a=this;a.sK4L_(c,b)},sK4L_:function(b,n){var k=this,f,j,e,a=this,q=[],l,c={},p,g=k.dataview,o="name;fieldfullpath;datatype;tablename;fieldname;datasize;nodepath;relpath;folder;tableuid;tableseq;update;codetable;codefield;codetableuid;valuefield;sortfield;codeschema;ukey;uid;codefilter1;codefilter2;codefilter3;viewmode;displabel;pid;type;alias;uniquekey;sequence;mcuid;fieldid",h={};k.setLoading(true);k.titemmap={};for(f=0;f<k.dataview.store.data.items.length;f++){p=k.dataview.store.data.items[f].data;k.titemmap["key_"+f]=p;p.ukey="key_"+f;if(!p.uid||p.edited){c[p.ukey]={tobj:p};h[p.__uid]=p;p.update="T";q.push("<"+p.type+""+IG$._I20(p,o,"s")+"></"+p.type+">")}}if(q){l=new IG$._I3e();l.init(a,{ack:"6",payload:IG$._I2d({uid:k.uid,trid:k.trid},"uid;trid"),mbody:"<smsg>"+q.join("")+"</smsg>"},a,function(w,t){var y=this,v,d=(w)?IG$._I18(w,"/smsg"):null,x=(d)?IG$._I26(d):null,s,u;if(x){for(v=0;v<x.length;v++){s=IG$._I1c(x[v]);if(s.ukey&&t&&t[s.ukey]){t[s.ukey].tobj.uid=s.uid}if(s.ukey&&y.titemmap[s.ukey]){y.titemmap[s.ukey].uid=s.uid}}for(v=0;v<g.store.data.items.length;v++){rec=g.store.data.items[v];u=rec.get("__uid")?h[rec.get("__uid")]:null;if(u){rec.set("uid",u.uid)}}}if(!b){var z=new IG$._I3e();z.init(a,{ack:"11",payload:IG$._I2d({}),mbody:IG$._I2e({act:"c",option:"trid",trid:a.trid})},a,function(A){a.rs_sK4L(null)},null);z._l()}n&&n.execute()},null,c);l._l()}else{n&&n.execute()}},rs_sK4L:function(j,b){var o=this,h,a,u,e,n=["<smsg><item uid='"+o.uid+"'><objinfo model='"+(o.modeluid?o.modeluid:"")+"' mfolder='"+(o.mfolder||"")+"' version='1.1'/>"],c=o.itemtype,l,s;l=function(k){n.push(k)};if(c=="MCube"){o._omc.items=[];var g=o.tree,p=g.getRootNode(),f=p.firstChild,q;if(f&&f.childNodes){for(h=0;h<f.childNodes.length;h++){r=f.childNodes[h];q={name:r.get("name"),type:r.get("type"),mcuid:r.get("mcuid"),metrictype:r.get("metrictype")||"",stylename:r.get("stylename")||"",sequence:r.get("sequence")||"",uniquekey:r.get("uniquekey")||"",fieldname:r.get("fieldname")||""};o._omc.items.push(q)}}}l("<Styles c_cset='"+(o.c_cset||"")+"'>");s=o.defaultstyle;if(s&&s.length>0){l("<Default>");for(h=0;h<s.length;h++){l(s[h].tx())}l("</Default>")}s=o.customstyle;if(s&&s.length>0){l("<Custom>");for(h=0;h<s.length;h++){l(s[h].tx())}l("</Custom>")}l("</Styles>");if(c=="MCube"){s=o._omc.items;l("<MetricItems>");for(h=0;h<s.length;h++){l("<item"+IG$._I20(s[h],"uid;nodepath;name;metrictype;stylename;type;sequence;uniquekey;fieldname;mcuid","s")+"/>")}l("</MetricItems>");s=o._omc.sqldata;l("<SQLData>");if(s.dbpool&&s.columns){l("<item dbpool='"+(s.dbpool||"")+"'><columns>");for(h=0;h<s.columns.length;h++){l("<column name='"+s.columns[h].name+"' datatype='"+s.columns[h].datatype+"' mappto='"+(o.sqldata.columns[h].mapto||"")+"'/>")}l("</columns><sqlquery><![CDATA["+(s.sql||"")+"]]></sqlquery></item>")}l("</SQLData><DataLoader><Option>");s=o._omc.dataloader.option;if(s){for(var d in s){l("<prop name='"+d+"'><![CDATA["+s[d]+"]]></prop>")}}l("</Option></DataLoader>")}l("<SecurityFilter>");s=o.securityfilter;if(s&&s.length>0){for(h=0;h<s.length;h++){l(s[h].TX())}}l("</SecurityFilter>");s=o.relations;if(c=="MDBCube"&&s){l("<Relation>");for(h=0;h<s.length;h++){l(s[h].TX())}l("</Relation>")}s=o.hloption;l("<hloption>");if(s){for(h=0;h<s.length;h++){l(s[h].TX.call(s[h]))}}l("</hloption>");l("<sqlsyntax><![CDATA["+(o.sqlsyntax||"")+"]]></sqlsyntax>");s=o.sqloption;if(c=="SQLCube"&&s){l("<ExecuteSQL dbpool='"+(s.dbpool||"")+"'><SQL><![CDATA["+(s.sqlquery||"")+"]]></SQL><columns>"+IG$._I4e(s.columns,"column")+"</columns>");l("<prompts>");for(h=0;h<s.prompts.length;h++){l(s.prompts[h].L1())}l("</prompts></ExecuteSQL>")}else{if(c=="DataCube"){l("<result><DataObjects>");u=o.down("[name=datainfo]");s=u.store.data.items;for(h=0;h<s.length;h++){e=s[h];l("<data uid='"+e.get("uid")+"' name='"+e.get("name")+"'/>")}l("</DataObjects>");l("<Header>");s=o._dcolumns;for(h=0;h<s.length;h++){l("<item"+IG$._I20(s[h],"datatype;fieldname;name;fieldid","s")+"/>")}l("</Header></result>")}else{if(c=="NoSQL"){l("<nosql"+IG$._I20(o,"dbtype;dbname;tablename;dbnode","s")+IG$._I20(o,"dbscan","i")+"><dbnodes>");s=o.dbnodes;if(s){for(h=0;h<s.length;h++){l("<dbnode name='"+s[h].name+"' uid='"+s[h].uid+"'/>")}}l("</dbnodes></nosql>")}}}l("</item></smsg>");o.sK4(o.uid,n.join(""))},sK4:function(b,d){var a=this,c=new IG$._I3e();c.init(a,{ack:"31",payload:IG$._I2d({uid:b}),mbody:d},a,a.rs_sK4,null);c._l()},rs_sK4:function(a){var b=this;b.setLoading(false);b.down("[name=b_m1]").show();IG$._I54(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")},entryLogin:function(b){if(demos.Login.success==true){var a=this;a.sK5(a)}else{history.back(-1)}},sK5:function(c){var b=this,a=b.itemtype,d;b.metricmap={};b.metricdatas=[];b.defaultstyle=[];b.customstyle=[];b.securityfilter=[];b.relations=[];b._dcolumns=[];b.headermap={};b.dataset=[];b.sqloption={dbpool:null,sqlquery:null,columns:[],prompts:[]};b.__cl=false;if(!b.uid){if(!b.modeluid&&a!="SQLCube"&&a!="DataCube"&&a!="NoSQL"){setTimeout(function(){IG$._I54(ig$.appname,IRm$.r1("M_SEL_MODEL"),function(){if(a=="MDBCube"){var e=new IG$.MwPo({callback:new IG$._I3d(b,b.rs_Op)});IG$._I_5(b,e)}else{b.sK5_m1a.call(b)}},null,1,"warning")},100)}}else{b.setLoading(true,true);if(b.writable==true){IG$._I56(b,function(f){var e=this;if(f!="unlock"){e.writable=false;e.down("[name=t_save]").hide()}})}b.down("[name=b_m1]").show();d=new IG$._I3e();d.init(b,{ack:"6",payload:IG$._I2d({address:b.uid,type:"cube"}),mbody:IG$._I2e({option:"CubeContent",trid:b.trid})},b,b.rs_sK5,null,[c]);d._l()}},rs_sK5:function(x,y){var e,f,u,d,z=this,o,v,g=y[0],s,k=z.down("[name=grd_join]"),a=[],w,t=z.itemtype,h,l,c,q="/smsg/item";z.metricmap={};e=IG$._I18(x,q);z.nodepath=IG$._I1b(e,"nodepath");z.modeluid=null;e=IG$._I18(x,q+"/objinfo");if(e){z.modeluid=IG$._I06(IG$._I1b(e,"model"))}z.defaultstyle=[];z.customstyle=[];z._omc={items:[],itemmap:{},sqldata:{},dataloader:{option:{}}};e=IG$._I18(x,q+"/MetricItems");if(e){f=IG$._I26(e);for(u=0;u<f.length;u++){w={};IG$._I1f(w,f[u],"uid;nodepath;name;metrictype;stylename;type;sequence;uniquekey;fieldname;mcuid","s");z._omc.items.push(w);z._omc.itemmap[w.uid]=w}}e=IG$._I18(x,q+"/SQLData/item");if(e){z._omc.sqldata.dbpool=IG$._I1b(e,"dbpool");o=IG$._I19(e,"sqlquery");if(o){z._omc.sqldata.sql=IG$._I24(o)}}e=IG$._I18(x,q+"/DataLoader/Option");if(e){v=IG$._I26(e);for(u=0;u<v.length;u++){pname=IG$._I1b(v[u],"name");pvalue=IG$._I24(v[u]);z._omc.dataloader.option[pname]=pvalue}}e=IG$._I18(x,q+"/Styles");if(e){z.c_cset=IG$._I1b(e,"c_cset")}e=IG$._I18(x,q+"/Styles/Default");if(e){f=IG$._I26(e);for(u=0;u<f.length;u++){d=new IG$._IF7(f[u]);z.defaultstyle.push(d)}}e=IG$._I18(x,q+"/Styles/Custom");if(e){f=IG$._I26(e);for(u=0;u<f.length;u++){d=new IG$._IF7(f[u]);z.customstyle.push(d)}}e=IG$._I18(x,q+"/SecurityFilter");z.securityfilter=[];if(e){f=IG$._I26(e);for(u=0;u<f.length;u++){d=new IG$._IEb(f[u]);z.securityfilter.push(d)}}z._dcolumns=[];z.headermap={};if(t=="DataCube"){e=IG$._I18(x,q+"/result/Header");if(e){f=IG$._I26(e);for(u=0;u<f.length;u++){d=IG$._I1c(f[u]);d.fieldid=d.fieldid||"column_"+u;z._dcolumns.push(d);z.headermap[d.name]=d}}h=IG$._I18(x,q+"/result/DataObjects");if(h){l=IG$._I26(h);for(u=0;u<l.length;u++){z.dataset.push(IG$._I1c(l[u]))}}z.down("[name=datainfo]").store.loadData(z.dataset)}else{if(t=="NoSQL"){e=IG$._I18(x,q+"/nosql");if(e){z.dbnode=IG$._I1b(e,"dbnode");z.dbscan=parseInt(IG$._I1b(e,"dbscan")||"100");z.dbtype=IG$._I1b(e,"dbtype");z.dbname=IG$._I1b(e,"dbname");z.tablename=IG$._I1b(e,"tablename");z.dbnodes=[];h=IG$._I18(e,"dbnodes");if(h){l=IG$._I26(h);for(u=0;u<l.length;u++){z.dbnodes.push(IG$._I1c(l[u]))}}if(z.dbtype){z.mC1()}}}}e=IG$._I18(x,q+"/Relation");z.relations=[];if(e){f=IG$._I26(e);for(u=0;u<f.length;u++){d=new IG$._IEa(f[u]);d.MX();a.push({joinfrom:d.joinfrom,jointo:d.jointo,joincondition:d.joincondition||"="});z.relations.push(d)}}e=IG$._I18(x,q+"/hloption");z.hloption=[];if(e){f=IG$._I26(e);for(u=0;u<f.length;u++){d=new IG$._Ie4(f[u]);z.hloption.push(d)}}e=IG$._I18(x,q+"/sqlsyntax");z.sqlsyntax=(e?IG$._I24(e):"");e=IG$._I18(x,q+"/ExecuteSQL");if(e){z.sqloption.dbpool=IG$._I1b(e,"dbpool");o=IG$._I19(e,"SQL");if(o){z.sqloption.sqlquery=IG$._I24(o)}o=IG$._I19(e,"columns");if(o){v=IG$._I26(o);for(u=0;u<v.length;u++){var b=IG$._I4f(v[u]);z.sqloption.columns.push(b)}}o=IG$._I19(e,"prompts");if(o){v=IG$._I26(o);for(u=0;u<v.length;u++){var n=new IG$._Ib4(v[u]);z.sqloption.prompts.push(n)}}}k.store.loadData(a);if(g&&z.build_cube){z.modeluid=z.modeluid||[];if(z.cube_model_uid){c=0;for(u=0;u<z.modeluid.length;u++){if(z.modeluid[u]==z.cube_model_uid){c=1;break}}!c&&z.modeluid.push(z.cube_model_uid)}}if(z.modeluid&&z.modeluid.length>0){if(t=="MDBCube"){z.D_()}else{z.sK6(g)}}else{if(t=="SQLCube"){if(z.uid){z.C_();z.sK7()}}else{if(t=="DataCube"){if(z.uid){z.C_();z.sK7()}}else{if(t=="MCube"){if(z.uid){z.MC_();z.sK7()}}else{if(t=="NoSQL"){if(z.uid){z.sK7()}}else{IG$._I54(ig$.appname,IRm$.r1("M_SEL_MODEL"),function(){if(t=="MDBCube"){var j=new IG$.MwPo({callback:new IG$._I3d(z,z.rs_Op)});IG$._I_5(z,j)}else{z.sK5_m1a.call(z)}},null,1,"warning")}}}}}z.__cl=true;if(z.dataview.store.data.items.length){var p=z.sK7_d();if(p.length>0){IG$._I54(ig$.appname,IRm$.r1("L_ERR_CUBE_ITEMS"),null,z,1,"error")}}},rs_SOp:function(k){var j=this,f,b,d,c={},h=j.metricdatas,g=j.dataview,a="dataoption_",e,l;for(f=0;f<h.length;f++){l=h[f];if(l.ltype=="metric"&&l.alias){c[l.alias]=l}}l=j.sqloption.columns;for(f=0;f<l.length;f++){b=l[f];e=b.dataoption;if(e){b[a+"valuetype"]=e.valuetype;b[a+"data"]=e.data;b[a+"datadelimiter"]=e.datadelimiter;b[a+"coldelimiter"]=e.coldelimiter}if(b.alias&&c[b.alias]){d=c[b.alias];d.fieldname=b.fieldname;d.alias=b.alias;d.fieldinfo=b.fieldname;d.dispname=b.dispname;d.type=b.type;d.ltype=b.type.toLowerCase();d.iconcls=IG$._I11(d.ltype);d.edited=true;if(e){d[a+"valuetype"]=e.valuetype;d[a+"data"]=e.data;d[a+"datadelimiter"]=e.datadelimiter;d[a+"coldelimiter"]=e.coldelimiter}d.edited=true;d.iconcls=IG$._I11(d.ltype)}else{b.pid=j._gp}}j.sK4L(true);j.C_();j._i0(null,null,true)},rs_OP:function(a){this.sqlsyntax=a||""},rs_Op:function(a){var b=this;b.modeluid=IG$._I06(a.dbname);b.D_()},C_:function(){var j=this,f=j.tree,k=f.getRootNode(),e=f.store.getRootNode(),h=f.store.model,g,c=j.itemtype,d=(c=="DataCube")?j._dcolumns:j.sqloption.columns,l,a,b;while(k.firstChild){k.removeChild(k.firstChild)}k.set("disp",c=="DataCube"?"Data Headers":"Query Tables");j.modelcontent={};l={name:c=="DataCube"?"Headers":"QueryTable",type:"Table"};l.uid=l.name;l.leaf=false;l.selected=true;l.checked=false;l.fields=[];l.disp=l.alias||l.name;j.modelcontent[l.uid]=l;a=f.appendNodeElement(k,l);for(g=0;g<d.length;g++){b=IG$._I1d(d[g]);b.leaf=true;b.type="Field";b.checked=true;b.tableuid=l.uid;b.tableseq=l.seq;b.disp=b.alias||b.name;b.fieldid=d[g].fieldid;l.fields.push(b);f.appendNodeElement(a,b)}k.expand()},D_:function(){var a=this;a.setLoading(true,true);var b=new IG$._I3e();b.init(a,{ack:"25",payload:IG$._I2d({uid:a.uid,option:"mdbfiles",method:"gettable",dbname:a.modeluid},"uid;dbname;method;option"),mbody:IG$._I2e({option:"standard",trid:a.trid})},a,a.rs_D_,null);b._l()},rs_D_:function(l){var o=this,b=IG$._I18(l,"/smsg/Tables"),n=(b?IG$._I26(b):null),h,g,q=[],s,f=o.tree,p=f.getRootNode(),e=f.store.getRootNode(),k,a,c;var d=f.store.model;o.modelcontent={};e.removeAll();p.removeAll(true,false);if(n){for(h=0;h<n.length;h++){s=IG$._I1c(n[h]);s.uid=s.name;s.leaf=false;s.selected=true;s.checked=false;s.fields=[];s.disp=s.alias||s.name;q.push(s);o.modelcontent[s.uid]=s;k=IG$._I26(n[h]);a=f.appendNodeElement(p,s);for(g=0;g<k.length;g++){c=IG$._I1c(k[g]);c.leaf=true;c.checked=false;c.tableuid=s.uid;c.tableseq=s.seq;c.disp=c.alias||c.name;s.fields.push(c);f.appendNodeElement(a,c)}}}if(o.uid){o.sK7()}},sK5_m1a:function(){var a=this,b=new IG$._I96({visibleItems:"workspace;folder;cubemodel;"});b.callback=new IG$._I3d(a,a.sK5_m1);IG$._I_5(a,b)},sK5_m1:function(b){var a=this;if(b){a.modeluid=IG$._I06(b.uid);a.sK6()}},sK6:function(a){var c=this;var b=new IG$._I3e();b.init(c,{ack:"5",payload:IG$._I2d({address:c.modeluid,type:"CubeModel"}),mbody:IG$._I2e({trid:c.trid})},c,c.rs_sK6,null,[a]);b._l()},rs_sK6:function(n,e){var p=this,s=p.tree,q=s.getRootNode(),l=e?e[0]:0,c=IG$._I18(n,"/smsg/item/Tables"),b=IG$._I26(c),k,f,d,h,a,g,o=IG$._I18(n,"/smsg/item/objinfo");p.modelcontent={};while(q.firstChild){q.removeChild(q.firstChild)}if(o){p.pooluid=IG$._I1b(o,"pooluid");p.mfolder=IG$._I1b(o,"mfolder")}for(k=0;k<b.length;k++){d=IG$._I1c(b[k]);d.uid=IG$._I06(d.uid);d.leaf=false;d.fields=[];d.checked=false;d.disp=d.alias||d.name;if(!d.seq){d.seq=0}if(d.seq&&d.seq>0){d.disp+="#"+d.seq}p.modelcontent[d.uid+"#"+d.seq]=d;a=s.appendNodeElement(q,d);s.appendNodeElement(a,{disp:"Wait while loading",type:"ml_tb",uid:d.uid,leaf:true})}q.expand();if(p.uid){p.sK7(undefined,l)}},sK7:function(a,b){var d=this,c=new IG$._I3e(),e=a||d.uid;if(e==d.__luid){if(b&&d.build_cube){d._b1()}return}d.__luid=e;d.metricdatas=[];c.init(d,{ack:"6",payload:IG$._I2d({address:e,type:"Cube"}),mbody:IG$._I2e({option:"CubeMetrics",trid:d.trid})},d,d.rs_sK7,null,[b]);c._l()},rs_sK7:function(z,B){var C=this,h=B?B[0]:0,e=IG$._I18(z,"/smsg/item"),g=IG$._I26(e),q=[],w,v,o,y,x,s,c,A={},a,l,b,p,n,k,D,d;C.metricmap={};C.metricdatas=q;if(C.sqloption&&C.sqloption.columns){for(w=0;w<C.sqloption.columns.length;w++){C.sqloption.columns[w].uid=null;A[C.sqloption.columns[w].fieldname]=C.sqloption.columns[w]}}for(w=0;w<g.length;w++){o=g[w];s={},c={};s=IG$._I1c(o);D=s.type.toLowerCase();if(D=="folder"){continue}s.relpath=C.sK8(s.nodepath,s.name);s.iconcls=IG$._I11(D);if(D=="metric"){y=IG$._I17(o);x=IG$._I18(g[w],"objinfo");if(x){s.fieldid=IG$._I1b(x,"fieldid")}x=IG$._I18(g[w],"Metric/FieldInfo");if(x){x=IG$._I17(x)}if(x){IG$._I1f(c,x,"datasize;datatype;name;tableuid;tablename;tableseq;nodepath;codefield;codetable;sortfield;codeschema;codefilter1;codefilter2;codefilter3;viewmode;displabel;alias","s");c.tableuid=IG$._I06(c.tableuid);if(!c.tableseq){c.tableseq="0"}}IG$._I1d(c,s,"datasize;datatype;tablename;tableuid;tableseq;alias");s.fieldname=c.name;s.fieldinfo=s.tablename+"."+s.fieldname;s.fieldfullpath=c.nodepath;a=IG$._I18(g[w],"Metric/CodeTable");if(a){l=IG$._I1c(a);s.codefield=l.codefield;s.codetable=l.tablefield;s.codetableuid=l.tableuid;s.valuefield=l.valuefield;s.sortfield=l.sortfield;s.codeschema=l.codeschema;s.viewmode=l.viewmode;s.displabel=l.displabel;b="";if(s.codetable&&s.codefield&&s.valuefield){d=s.codetable.lastIndexOf("/");b=(d>-1)?s.codetable.substring(d+1)+".":"";d=s.codefield.lastIndexOf("/");b+=(d>-1)?s.codefield.substring(d+1)+" - ":" - ";d=s.valuefield.lastIndexOf("/");b+=(d>-1)?s.valuefield.substring(d+1):"";if(b==""){b="Error on codemapping"}}s.codemapping=b;p=IG$._I19(a,"RangeFilter");if(p){k=IG$._I26(p);for(v=0;v<k.length;v++){n=IG$._I19(k[v],"value");s["codefilter"+(v+1)]=IG$._I1b(k[v],"rangefield")+"|"+IG$._I24(n)}}}}s.selected=false;if(A&&A[s.fieldname]){o=A[s.fieldname].dataoption;if(o){s.dataoption_data=o.data;s.dataoption_valuetype=o.valuetype;s.dataoption_datadelimiter=o.datadelimiter;s.dataoption_coldelimiter=o.coldelimiter}}if(!C.metricmap[s.relpath]){C.metricmap[s.relpath]={}}C.metricmap[s.relpath][s.name]=s;s.__uid=s.__uid||"s_"+(C.__uid++);q.push(s)}C.dataview.store.loadData(q);if(C.__cl){var u=C.sK7_d();if(u.length>0){IG$._I54(ig$.appname,IRm$.r1("L_ERR_CUBE_ITEMS"),null,C,1,"error")}}if(h&&C.build_cube){C._b1()}},_b1:function(){var a=this,b=new IG$._$1c({p_1:a});b.show()},sK7_d:function(){var o=this,f=o.modelcontent,h,g,n,l,d=[],p,e,c=o.sqloption?o.sqloption.columns:null,b={},q={},a=o.itemtype;if(a=="DataCube"){c=o._dcolumns}if(c&&a=="SQLCube"){for(h=0;h<c.length;h++){b["column_"+(h+1)]=c[h];if(c[h].fieldname){q[c[h].fieldname]=c[h]}}}else{if(c&&a=="DataCube"){for(h=0;h<c.length;h++){b[c[h].fieldname]=c[h]}}else{if(c&&a=="NoSQL"){}}}for(h=0;h<o.dataview.store.data.items.length;h++){n=o.dataview.store.data.items[h].data;if(n.type=="Metric"){if(a=="SQLCube"){n.status="";if(!n.alias){n.status+="no_alias";if(b[n.fieldname]&&b[n.fieldname].alias){n.alias=b[n.fieldname].alias;n.edited=true}}else{if(b[n.fieldname]&&b[n.fieldname].alias!=n.alias){n.status+="no_alias";n.alias=b[n.fieldname].alias;n.edited=true}else{if(q[n.fieldname]&&q[n.fieldname].alias!=n.alias){n.status+="no_alias";n.alias=q[n.fieldname].alias;n.edited=true}}}}else{if(a=="DataCube"){n.status=""}else{if(a=="NoSQL"){n.status=""}else{p=n.tableuid+"#"+n.tableseq;if(!f){n.status=""}else{if(f){n.status="";if(f[p]){if(f[p].name!=n.tablename){n.status+="tablenamemismatch";n.tablename=f[p].name;n.fieldinfo=n.tablename+(n.tableseq!="0"?"#"+n.tableseq:"")+"."+n.fieldname;n.edited=true}if(l==false){n.status+=";fieldnotexist";n.edited=true}}else{for(e in f){if(f[e].name==n.tablename){n.tableuid=f[e].uid;n.status+=";tablechanged";n.edited=true;break}}}}else{n.status="notexisttable"}}}}}if(n.status!=""){d.push(n)}}}return d},sK8:function(e,a){var d=this,c="",b=d.nodepath||"*";if(e.indexOf(b)==0){if(a){c=e.substring(b.length,e.length-a.length)}else{c=e.substring(b.length)}}return c},_m1:function(){var b=this,a=new IG$._I3e();a.init(b,{ack:"11",payload:IG$._I2d({}),mbody:IG$._I2e({act:"b",option:"trid"})},b,function(c){var d=IG$._I18(c,"/smsg/item");if(d){b.trid=IG$._I1b(d,"trid")}b.sK5(1)},null);a._l()},d1:function(b){var a=this;if(!a.uid){var c=new IG$._I96({mode:"newitem",initpath:a.nodepath});c.callback=new IG$._I3d(a,a.rs_d1,b);IG$._I_5(a,c);return false}return true},rs_d1:function(c,d){if(c&&c.nodepath&&c.name){var b=this,e=IG$._I2e(),a=new IG$._I3e();a.init(b,{ack:"31",payload:"<smsg><item address='"+c.nodepath+"/"+c.name+"' name='"+c.name+"' type='DataCube' pid='"+c.uid+"' description=''/></smsg>",mbody:"<smsg><item address='"+c.nodepath+"'/></smsg>"},b,function(){b._t$(d)},null);a.showerror=false;a._l()}},MC_:function(){var h=this,e=h.tree,j=e.getRootNode(),d=e.store.getRootNode(),g=e.store.model,f,c=h._omc.items,k,a,b;while(j.firstChild){j.removeChild(j.firstChild)}j.set("disp","Field Items");k={name:"Loaded Field",type:"Table"};k.uid=k.name;k.leaf=false;k.selected=true;k.checked=false;k.fields=[];k.disp=k.alias||k.name;a=e.appendNodeElement(j,k);for(f=0;f<c.length;f++){b=IG$._I1d(c[f]);b.leaf=true;b.type="Field";b.checked=true;b.disp=b.name;k.fields.push(b);e.appendNodeElement(a,b)}j.expand()},MmD1:function(){var g=this,b=g.tree,h=b.getRootNode(),c=h.firstChild,d,a,j,e=[];if(c&&c.childNodes){for(d=0;d<c.childNodes.length;d++){a=c.childNodes[d];j={name:a.get("name"),mcuid:a.get("mcuid")};e.push(j)}}var f=new IG$.M$d10({uid:g.uid,columns:e,mm:g._omc,callback:new IG$._I3d(g,g.rs_MmD1)});IG$._I_5(g,f)},rs_MmD1:function(c){var e=this,d=new IG$._I3e(),b,a,f=c.buildcube;if(!f){e.rs_mD1b(c.columns)}else{e.setLoading(true);b=["<smsg>"];for(a=0;a<c.columns.length;a++){b.push("<column mcuid='"+c.columns[a].mcuid+"' name='"+c.columns[a].name+"' datatype='"+c.columns[a].datatype+"' isuse='"+(c.columns[a].selected==true?"T":"F")+"' ismeasure='"+(c.columns[a].ismeasure==true?"T":"F")+"'/>")}b.push("</smsg>");d.init(e,{ack:"17",payload:IG$._I2d({uid:e.uid,action:"38",datafile:c.datafile,delimiter:c.delimiter,datatransformer:c.datatransformer},"uid;action;datafile;delimiter;datatransformer"),mbody:b.join("")},e,e.rs_mD1a,null);d._l()}},rs_mD1b:function(c){var j=this,g,h={},o,l,d,f=j.tree,k=f.getRootNode(),e=k.firstChild,a=1,b=0,n;n=e?e.childNodes:null;if(n){for(g=0;g<n.length;g++){r=n[g];l=r.get("name");h[l]=r}}for(g=0;g<c.length;g++){o=c[g];o.type="Metric";o.datatype=(o.datatype=="number")?"numeric":"string";o.metrictype=o.type;o.fieldname=o.name;o.sequence=(o.datatype=="numeric")?0:a++;o.uniquekey=(o.datatype=="numeric")?b++:-1;o.disp=o.name;o.leaf=true;o.checked=true;l=o.name;n=h[l];if(n){n.set("type",o.type);n.set("datatype",o.datatype);n.set("metrictype",o.metrictype);n.set("fieldname",o.fieldname);n.set("uniquekey",o.uniquekey);n.set("sequence",o.sequence);n.set("mcuid",o.mcuid)}else{f.appendNodeElement(e,o)}}},rs_mD1a:function(f){var j=this,a=IG$._I18(f,"/smsg"),g=(a?IG$._I26(a):null),e,h={},o,l,b,d=j.tree,k=d.getRootNode(),c=k.firstChild,n;j.setLoading(false);if(g){if(c&&c.childNodes){for(e=0;e<c.childNodes.length;e++){r=c.childNodes[e];l=r.get("mcuid");h[l]=r}}for(e=0;e<g.length;e++){o=IG$._I1c(g[e]);o.type="Field";o.datatype=(o.ismeasure=="T")?"numeric":"string";o.metrictype=o.type;o.fieldname=o.name;o.sequence=o.sequence;o.uniquekey=o.uniquekey;o.leaf=true;o.disp=o.name;o.checked=true;l=o.mcuid;n=h[l];if(n){n.set("type",o.type);n.set("datatype",o.datatype);n.set("metrictype",o.metrictype);n.set("fieldname",o.fieldname);n.set("uniquekey",o.uniquekey);n.set("sequence",o.sequence)}else{d.appendNodeElement(c,o)}}}},Mmm1:function(){var h=this,g=new IG$._I3e(),a=h.dataview,b=a.store,f,d,e=false,c;c=b.data.items;for(d=0;d<c.length;d++){f=c[d];if(f.get("type")=="Metric"&&!f.get("uid")){e=true;IG$._I54(ig$.appname,"Save Cube before build multi dimensional database",null,null,0,"success");break}}if(e==false){g.init(h,{ack:"17",payload:"<smsg><item cubeuid='"+h.uid+"' action='BuildCube'/></smsg>",mbody:"<smsg></smsg>"},h,h.rs_Mmm1,null);g._l()}},rs_Mmm1:function(a){IG$._I54(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")},Mmm2:function(){var g=this,f=g.dataview,h=f.getSelectionModel(),c=g.cubeaddress,e=(c)?c.length:0,d,a,j,b;d=c;if(h.selected.items.length>0){a=h.selected.items[0];if(a.get("type")=="blank"){d=a.get("nodepath");b=a}else{d=a.get("nodepath");d=d.substring(0,d.lastIndexOf("/"))}}j={isnew:true,name:g.nameprefix+(g.nindex++),uid:null,parentnodepath:d,relpath:d.substring(e),type:"Metric"};j.nodepath=j.parentnodepath+"/"+j.name;f.store.add(j);if(b){f.store.remove(b)}},MmD2:function(){var f=this,a=f.dataview,b=[],e,c,d;for(c=0;c<a.store.data.items.length;c++){d=a.store.data.items[c];e={name:d.get("name"),uid:d.get("uid")};b.push(e)}var g=new IG$.mA$_c({uid:f.uid,columns:b,sqldata:f.sqldata,callback:new IG$._I3d(f,f.rs_MmD2)});IG$._I_5(f,g)},rs_MmD2:function(g){var k=this,f,c,h=k.dataview,l=new IG$._I3e(),d=0,b=1,o,n,j={},e,a=k.MM1;k.sqldata={dbpool:g.dbpool,columns:g.columns,sql:g.sql};a.sqldata=k.sqldata;c=k.sqldata.columns;if(g.buildcube==true){k.setLoading(true);cnt=["<smsg>"];for(f=0;f<g.columns.length;f++){cnt.push("<column uid='"+(g.columns[f].uid||"")+"' name='"+g.columns[f].name+"' datatype='"+g.columns[f].datatype+"' isuse='"+(g.columns[f].selected==true?"T":"F")+"'/>")}cnt.push("</smsg>");e=["<smsg><item uid='"+k.uid+"' action='sqlcube' dbpool='"+g.dbpool+"'>"];e.push("<SQL><![CDATA["+g.sql+"]]></SQL>");e.push("</item></smsg>");l.init(k,{ack:"17",payload:e.join(""),mbody:cnt.join("")},k,k.rs_mD2a,null);l._l()}},rs_mD2a:function(g){var k=this,e,b=IG$._I18(g,"/smsg"),h=IG$._I26(b),f=k.dataview,a,j={},l,n,c=k.cubeaddress,d=(c)?c.length:0;for(e=0;e<f.store.data.items.length;e++){l=f.store.data.items[e].get("uid");j[l]=f.store.data.items[e]}for(e=0;e<h.length;e++){n=IG$._I1c(h[e]);n.type=(n.datatype=="number")?"Measure":"Metric";n.datatype=(n.datatype=="number")?"numeric":"string";n.metrictype=n.type;n.fieldname=n.name;n.sequence=n.sequence;n.uniquekey=n.uniquekey;n.isnew=j[l]?false:true;n.parentnodepath=c;n.relpath=c.substring(d);n.nodepath=n.parentnodepath+"/"+n.name;l=n.uid;if(j[l]){j[l].set("type",n.type);j[l].set("datatype",n.datatype);j[l].set("metrictype",n.metrictype);j[l].set("fieldname",n.fieldname);j[l].set("uniquekey",n.uniquekey);j[l].set("sequence",n.sequence)}else{f.store.add(n)}}},Mlm1:function(a){var c=this,b;if(a=="yes"){b=new IG$._I3e();b.init(c,{ack:"17",payload:IG$._I2d({cubeuid:c.uid,action:"51"},"cubeuid;action"),mbody:"<smsg></smsg>"},c,function(){IG$._I54(ig$.appname,IRm$.r1("B_SUCCESS"),null,c,0,"success")},null);b._l()}},_d1:function(q){var B=this,p=B.tree,y=B.down("[name=mtree]"),e,f,A,s,x,w,l,v,t,c,u,b,o,h,d,z,a;if(q==0){e=B.tree.getRootNode();for(x=0;x<e.childNodes.length;x++){f=e.childNodes[x];f.expand()}A=y.getRootNode();y._I92.call(y,A);B._d2(e,A)}else{if(q==1){e=B.tree.getRootNode();s={};for(x=0;x<e.childNodes.length;x++){f=e.childNodes[x];b=f.get("name");if(s[b]){o=1;while(s[b+"_"+o]){o++}b=b+"_"+o}f.set("fname",b);s[b]=1}A=y.getRootNode();for(x=0;x<A.childNodes.length;x++){f=A.childNodes[x];if(s[f.get("name")]){delete s[f.get("name")]}}h=B.nodepath;c=["<smsg>"];u=["<smsg>"];t=0;for(v in s){z="<item name='"+v+"' uid='"+h+"/"+v+"' type='Folder' createstructure='T' pid='"+B.uid+"'/>";d="<item name='"+v+"'></item>";u.push(d);c.push(z);t++}c.push("</smsg>");u.push("</smsg>");if(t>0){a=new IG$._I3e();a.init(B,{ack:"30",payload:c.join(""),mbody:u.join("")},B,function(j){y._I92.call(y,A);B._d2(e,A)});a._l()}else{B.fireEvent("_bb_comp")}}else{if(q==2){e=B.tree.getRootNode();s={};for(x=0;x<e.childNodes.length;x++){f=e.childNodes[x];v=0;for(w=0;w<f.childNodes.length;w++){if(f.childNodes[w].get("checked")){v=1;break}}if(v==0){for(w=0;w<f.childNodes.length;w++){f.childNodes[w].set("checked",true)}}}A=y.getRootNode();B.__grec=[];B.__rrec=[];for(x=0;x<e.childNodes.length;x++){f=e.childNodes[x];B.__grec.push(f)}B._p1()}else{if(q==3){if(B.__rrec.length){var g=new IG$._Ic9({metaitems:B.__rrec,vmode:1,pcube:B,callback:new IG$._I3d(B,B.rs_sk5n)});IG$._I_5(B,g)}B.fireEvent("_bb_comp")}else{B.sK4L();B.fireEvent("_bb_comp")}}}}},_p1:function(){var e=this,b,d=e.down("[name=mtree]"),a=d.getRootNode(),f=e.__grec[0],c;if(f){e.__grec.splice(0,1);for(b=0;b<a.childNodes.length;b++){if(f.get("fname")==a.childNodes[b].get("name")){c=a.childNodes[b];break}}if(!c){for(b=0;b<a.childNodes.length;b++){if(f.get("name")==a.childNodes[b].get("name")){c=a.childNodes[b];break}}}if(c){e._gp=c.get("uid");e._gpp=c.get("nodepath");e._1.call(e,f.data,f.childNodes,0,new IG$._I3d(e,function(){e._a1.call(e)}))}}},_a1:function(){var k=this,g,h=k.dataview,d,n,f,e,c,a,j,l;for(g=0;g<h.store.data.items.length;g++){d=h.store.data.items[g];if(d.get("uid")){f=d.get("datatype");e=d.get("name").toLowerCase();f=f?f.toLowerCase():null;c=d.get("nodepath");c=c.substring(0,c.lastIndexOf("/"));l=0;if(f&&/(number|numeric|decimal|float|double|int)/.test(f)){l=1;c=c+"/"+IRm$.r1("L_MEASURE");a="Measure";j=IRm$.r1("L_C_TOTAL",d.get("name"))}else{if(/(date|time|datetime|timestamp)/.test(f)){l=3;c=c+"/"+IRm$.r1("L_B_CM");a="DateMetric";j=IRm$.r1("L_C_DATE",d.get("name"))}else{if(e.indexOf("_id")>-1){l=2;c=c+"/"+IRm$.r1("L_MEASURE");a="Measure";j=IRm$.r1("L_C_DCOUNT",d.get("name"))}}}if(l){n={};IG$._I1d(d.data,n,"uid;name;type;memo;nodepath","s");n.measurename=j;n.formula=l==1?"SUM":(l==2?"COUNT DISTINCT":"");n.clocation=c;n.ctype=a;k.__rrec.push(n)}}}k.dataview.store.loadData([]);if(k.__grec.length){setTimeout(function(){k._p1.call(k)},20)}else{k.fireEvent("_bb_comp")}},_d2:function(a,e){var d=this,c=1,f,b;for(b=0;b<a.childNodes.length;b++){f=a.childNodes[b];if(f.childNodes&&f.childNodes.length&&f.childNodes[0].get("type")=="ml_tb"){c=0;break}}if(c){for(b=0;b<e.childNodes.length;b++){f=e.childNodes[b];if(f.childNodes&&f.childNodes.length&&f.childNodes[0].get("type")=="load"){c=0;break}}}if(c){d.fireEvent("_bb_comp")}else{setTimeout(function(){d._d2.call(d,a,e)},500)}},mC1:function(){var b=this,a=new IG$._I3e();if(!(b.dbnodes&&b.dbnodes.length)){return}b.setLoading(true);a.init(b,{ack:"25",payload:IG$._I2d({address:"/"+b.dbname,option:"StoredContent"},"address;option"),mbody:IG$._I2e({})},b,function(p){var q=this,l=q.tree,s=l.getRootNode(),h=l.store.getRootNode(),o=l.store.model,n,k,e=q.itemtype,u,c,g,f=[],d,t=0;while(s.firstChild){s.removeChild(s.firstChild)}s.set("disp","Documents");q.modelcontent={};tnode=IG$._I18(p,"/smsg/item");if(tnode){tnodes=IG$._I26(tnode);for(n=0;n<tnodes.length;n++){u=IG$._I1c(tnodes[n]);f.push(u)}if(f.length){$.each(f,function(v,w){var j=new IG$._I3e();j.init(q,{ack:"25",payload:IG$._I2d({uid:w.uid,option:"StoredContent"},"uid;option"),mbody:IG$._I2e({})},q,function(x){q.setLoading(false);var y,B=IG$._I18(x,"/smsg/item"),A,z;if(B){A=IG$._I26(B);for(y=0;y<A.length;y++){z=IG$._I1c(A[y]);z.type="Table";z.uid=z.uid;z.seq=0;z.selected=false;z.checked=false;z.fields=[];z.leaf=false;z.disp=z.name;q.modelcontent[z.uid]=z;c=l.appendNodeElement(s,z);l.appendNodeElement(c,{disp:"Wait while loading",type:"ml_tb",uid:z.uid,leaf:true})}}});j._l()})}else{t=1}}else{t=1}t==1&&q.setLoading(false);s.expand()},null);a._l()},initComponent:function(){var b=this,d=this,f=false,e=true,c=true,a=d.itemtype;d.__uid=0;d.pl=["name","nodepath","uid","datasize","datatype","fieldfullpath","fieldinfo","fieldname","relpath","selected","tablename","tableuid","tableseq","type","codetable","codefield","codeschema","codemapping","codetableuid","valuefield","sortfield","codefilter1","codefilter2","codefilter3","ukey","folder","viewmode","displabel","dataoption_data","dataoption_datadelimiter","dataoption_coldelimiter","dataoption_valuetype","dispname","edited","pid","__uid","iconcls","writable","alias","metrictype","sequence","uniquekey","mcuid","fieldid","fname"];d.tree=new IG$._Ib0({border:0,flex:1,cmode:1});f=(/MDBCube|SQLCube|MCube|DataCube|NoSQL/).test(a);e=a!="MCube";c=a!="DataCube";d.addEvents("_bb_comp");$s.apply(d,{dockedItems:[{xtype:"toolbar",dock:"top",hidden:IG$.__ep,items:[" ",{iconCls:"icon-toolbar-save",tooltip:IRm$.r1("L_SAVE_CUBE"),handler:function(){this._t$("cmd_save")},scope:this},{iconCls:"icon-toolbar-saveas",tooltip:IRm$.r1("L_SAVE_CUBE"),handler:function(){this._t$("cmd_saveas")},scope:this},{xtype:"tbseparator",hidden:!e||f?true:false},{iconCls:"icon-toolbar-import",tooltip:IRm$.r1("L_IMPORT_FILE"),text:"Upload File",hidden:c,handler:function(){this._t$("cmd_import")},scope:this},{iconCls:"icon-toolbar-mcubefile",text:IRm$.r1("L_LD_FILE"),tooltip:IRm$.r1("L_LD_FILE"),hidden:e,handler:function(){this._t$("cmd_ld_file")},scope:this},{iconCls:"icon-toolbar-mcubedb",tooltip:IRm$.r1("L_LD_SQL_D"),text:IRm$.r1("L_LD_SQL"),hidden:true,handler:function(){this._t$("cmd_sql")},scope:this},{iconCls:"icon-toolbar-buildcube",text:IRm$.r1("L_BUILD_MCUBE"),tooltip:IRm$.r1("L_BUILD_MCUBE"),hidden:true,handler:function(){this._t$("cmd_buildcube")},scope:this},{iconCls:"icon-toolbar-addmetric",tooltip:IRm$.r1("L_ADD_METRIC"),hidden:true,handler:function(){this._t$("cmd_add_metric")},scope:this},{xtype:"tbseparator",hidden:e},{iconCls:"icon-toolbar-db-unload",tooltip:IRm$.r1("L_LD_UL"),text:IRm$.r1("L_LD_UL"),hidden:true,handler:function(){this._t$("cmd_db_unload")},scope:this},{iconCls:"icon-toolbar-db-load",tooltip:IRm$.r1("L_LD_LK"),text:IRm$.r1("L_LD_LK"),hidden:true,handler:function(){this._t$("cmd_db_load")},scope:this},{xtype:"tbseparator",hidden:true},{iconCls:"icon-toolbar-db-destroy",text:IRm$.r1("L_LD_INI"),title:IRm$.r1("L_LD_INI"),hidden:e,handler:function(){this._t$("cmd_db_destroy")},scope:this},{iconCls:"icon-toolbar-model_new",tooltip:IRm$.r1("L_MODEL_CREATE"),handler:function(){this._t$("cmd_model_new")},hidden:f,scope:this},{iconCls:"icon-toolbar-model",tooltip:IRm$.r1("L_MODEL_SELECT"),handler:function(){this._t$("cmd_model")},hidden:f,scope:this},{iconCls:"icon-toolbar-model_edit",tooltip:IRm$.r1("L_MODEL_EDIT"),handler:function(){this._t$("cmd_model_edit")},hidden:f,scope:this},{xtype:"tbseparator",hidden:f},{iconCls:"icon-toolbar-option",tooltip:"MDB Options",handler:function(){this._t$("cmd_mdb_option")},hidden:a=="MDBCube"?false:true,scope:this},{iconCls:"icon-toolbar-option",tooltip:"NoSQL Options",handler:function(){this._t$("cmd_nosql_option")},hidden:a=="NoSQL"?false:true,scope:this},{iconCls:"icon-toolbar-sql",text:"SQL",tooltip:"SQL Input",handler:function(){this._t$("cmd_sql_input")},hidden:a=="SQLCube"?false:true,scope:this},{iconCls:"icon-refresh",tooltip:IRm$.r1("L_REFRESH"),handler:function(){this._t$("cr")},scope:this},{iconCls:"icon-measure",tooltip:IRm$.r1("L_REG_MEASURES"),handler:function(){this._t$("cmd_regmeasures")},scope:this},{iconCls:"icon-toolbar-remove",tooltip:IRm$.r1("L_DELETE_CHECKED"),handler:function(){this._t$("cmd_delete")},scope:this},{iconCls:"icon-toolbar-style",tooltip:"Style",handler:function(){this._t$("cmd_style")},scope:this},{iconCls:"icon-toolbar-filter",tooltip:"Security Filter",hidden:(a=="SQLCube"||a=="DataCube"?true:false),handler:function(){this._t$("cmd_sec_filter")},scope:this},{iconCls:"icon-toolbar-hl",tooltip:IRm$.r1("L_TB_HL"),handler:function(){this._ILb_=true;this._t$("cmd_hl_option")},scope:this},{iconCls:"icon-toolbar-sql",text:"QueryTool",tooltip:"QueryTool",handler:function(){this._t$("cmd_query_tool")},hidden:a=="SQLCube"?false:true,scope:this},{iconCls:"icon-toolbar-preproc",text:IRm$.r1("L_SQL_PRE"),tooltip:IRm$.r1("L_SQL_PRE"),handler:function(){this._t$("cmd_pre_proc")},hidden:a=="SQLCube"||a=="DataCube"||a=="NoSQL"?true:false,scope:this},"->",{iconCls:"icon-report",text:IRm$.r1("M_REPORT"),name:"b_m1",hidden:true,handler:function(){this._t$("cmd_report")},scope:this}]}],items:[{xtype:"panel",layout:"fit",region:"west",collapsed:false,width:200,collapsible:true,split:true,useSplitTips:true,title:IRm$.r1("L_NAVIGATOR"),tbar:[{xtype:"button",name:"t_btn",text:IRm$.r1("L_CREATE_ITEM"),disabled:true,menu:{xtype:"menu",items:[{text:IRm$.r1("D_FOLDER"),hidden:ig$.fm.ig_n_f_f,handler:function(){this._d("Folder")},scope:this},"-",{text:IRm$.r1("D_CUSTOMMETRIC"),hidden:ig$.fm.ig_n_cm,handler:function(){this._d("CustomMetric")},scope:this},{text:IRm$.r1("D_MEASURE"),hidden:ig$.fm.ig_n_ms,handler:function(){this._d("Measure")},scope:this},{text:IRm$.r1("D_FORMULA"),hidden:ig$.fm.ig_n_fm,handler:function(){this._d("FormulaMeasure")},scope:this},"-",{text:IRm$.r1("D_DATEMETRIC"),hidden:ig$.fm.ig_n_dm,handler:function(){this._d("DateMetric")},scope:this},{text:IRm$.r1("D_CHARTMEASURE"),hidden:ig$.fm.ig_n_cms,handler:function(){this._d("ChartMeasure")},scope:this},{text:IRm$.r1("D_UDG"),hidden:ig$.fm.ig_n_udg,handler:function(){this._d("GroupField")},scope:this},{text:IRm$.r1("D_HIERARCHY"),hidden:ig$.fm.ig_n_hm,handler:function(){this._d("Hierarchy")},scope:this},{xtype:"menuseparator",hidden:a!="DataCube"},{text:IRm$.r1("D_TABDIMENSION"),hidden:a!="DataCube"||ig$.fm.ig_n_tabdim,handler:function(){this._d("TabDimension")},scope:this}]}},{xtype:"button",iconCls:"icon-refresh",tooltip:IRm$.r1("L_REFRESH"),handler:function(){var h=this,g=h.down("[name=mtree]"),j=g.getRootNode();g._I92.call(g,j)},scope:this}],items:[new IG$._Idd({name:"mtree",rootuid:this.uid,_s1:function(l){var q=this,h=this.customMenu,n=l.get("type").toLowerCase(),p=l.get("name"),j=l.get("nodepath"),t=l.get("uid"),k=l.get("type"),s=(l.get("writable")=="T"||l.get("manage")=="T")?true:false,o=(l.get("manage")=="T")?true:false,g=false;h.removeAll();if(s||o){g=true;if(n=="folder"){h.add({text:IRm$.r1("B_FOLDER"),hidden:ig$.fm.ig_n_f_f,handler:function(){this._I90.call(this,"Folder",t,j,l)},scope:this})}h.add({text:IRm$.r1("L_RENAME_ITEM",p),hidden:ig$.fm.ig_n_ren,handler:function(){this._I91.call(this,p,t,j,record)},scope:this});h.add({text:IRm$.r1("L_DELETE_ITEM",p),hidden:ig$.fm.ig_n_del,handler:function(){this._IHf.call(this,t,record)},scope:this})}return g},_i4:new IG$._I3d(d,function(h,g){this.rs__i3(h,1,0)}),_i3:new IG$._I3d(d,function(h,g){this.rs__i3(h,0,1)})})]},{title:IRm$.r1("L_TABLES"),region:"east",floatable:false,layout:{type:"vbox",align:"stretch"},collapsed:false,items:[d.tree,{xtype:"displayfield",value:IRm$.r1("L_TABLE_DROP")},{xtype:"gridpanel",plain:true,hidden:a!="DataCube",name:"datainfo",title:IRm$.r1("L_LD_FLS"),height:200,resizable:false,layout:"fit",stateful:true,columnLines:true,store:{fields:["name","uid","type","nodepath"]},plugins:[{ptype:"cellediting",clicksToEdit:false}],fbar:[{xtype:"checkbox",name:"cbloadlastonly",fieldLabel:"",hideLabel:false,boxLabel:IRm$.r1("L_L_TAB")}],columns:[{xtype:"gridcolumn",flex:1,text:IRm$.r1("B_NAME"),dataIndex:"name",editor:{allowBlank:false}},{xtype:"actioncolumn",width:50,sortable:false,items:[{iconCls:"icon-grid-config",tooltip:IRm$.r1("B_CONFIG_ITEM"),handler:function(h,j,g){d.cxc(j)},scope:d},{iconCls:"icon-grid-delete",tooltip:IRm$.r1("B_DELETE_ITEM"),handler:function(h,k,g){var j=this;IG$._I55(IRm$.r1("B_CONFIRM"),IRm$.r1("L_C_DEL_ITEM"),function(n){if(n=="yes"){var l=h.store.getAt(k);h.store.remove(l)}},j,j)},scope:d}]}]}],width:230,listeners:{beforecollapse:function(){},beforeexpand:function(){},scope:this}},{layout:"border",items:[{xtype:"panel",layout:"fit",title:IRm$.r1("L_FOLDER_ITEMS"),region:"center",flex:1,items:[{xtype:"gridpanel",name:"dataview",collapsible:false,iconCls:"icon-grid",frame:false,emptyText:IRm$.r1("L_EMPTY_DATA"),store:{xtype:"store",sorters:["name"],groupField:"relpath",fields:d.pl,data:[]},header:false,plugins:[{ptype:"cellediting",clicksToMoveEditor:1,autoCancel:false,listeners:{edit:function(h,g,k){var j=this,n=g.record,l;n.set("edited",true);j._s5(l,n)},scope:this}}],viewConfig:{plugins:{ptype:"gridviewdragdrop",ddGroup:"cubeDDGroup"},listeners:{beforedrop:function(n,o,q,v,u,l){var j=true,p,s=this,h=(o.records&&o.records.length>0)?o.records[0]:null,t=false,g=h?h.data.type:null,k=h&&h.parentNode?h.parentNode.data.type:null;(this==o.view)?o.copy=false:o.copy=true;p=(q)?s.panel.store.indexOf(q):0;if(h&&(g=="Table"||g=="InlineView")){b._1.call(b,h.data,h.childNodes,p);j=false}else{if(h&&(g=="Field"||(k=="InlineView"&&(g=="Metric"||g=="Measure")))){b._3.call(b,h.data,p,h.parentNode.data.uid,h.parentNode.data.name,h.parentNode.data.seq);j=false}}return j},drop:function(j,k,l,g){var h=l?" "+g+" "+l.get("name"):" on empty view";return false}}},columns:[{xtype:"checkcolumn",dataIndex:"selected",width:30,menuDisabled:true,editor:{xtype:"checkbox",cls:"x-grid-checkheader-editor"}},{text:"",dataIndex:"iconcls",menuDisabled:true,width:30,renderer:function(g){return"<div class='igc_g_icon "+g+"'></div>"}},{text:IRm$.r1("B_NAME"),dataIndex:"name",flex:2,tdCls:"igc-td-link",editor:{allowBlank:false}},{text:IRm$.r1("B_DISP_NAME"),dataIndex:"dispname",flex:1},{text:IRm$.r1("L_TABLE_FIELD"),dataIndex:"fieldinfo",hidden:(a=="MCube"||a=="DataCube"),menuDisabled:true,flex:1},{text:IRm$.r1("L_CODE_FIELD"),dataIndex:"codemapping",menuDisabled:true,hidden:(a=="SQLCube"||a=="MCube"||a=="DataCube"||a=="NoSQL"?true:false),width:80,flex:1},{xtype:"actioncolumn",width:50,menuDisabled:true,hidden:true,items:[{iconCls:"icon-grid-add",tooltip:"Set CodeMapping",handler:function(h,k,g){var j=d.dataview.store.getAt(k);d._5.call(d,j,"set")}},{iconCls:"icon-grid-delete",tooltip:"Remove CodeMapping",handler:function(h,k,g){var j=d.dataview.store.getAt(k);d._5.call(d,j,"remove")}}]},{xtype:"actioncolumn",width:50,menuDisabled:true,items:[{iconCls:"icon-toolbar-popt",hidden:a!="SQLCube",tooltip:IRm$.r1("L_EDIT"),handler:function(k,n,j){var g=k,h=g.store,l=h.getAt(n);if(a=="SQLCube"&&l.get("type")=="Metric"){this._i2(l)}},scope:this},{iconCls:"icon-grid-config",tooltip:IRm$.r1("L_EDIT"),handler:function(k,o,j){var g=k,h=g.store,n=h.getAt(o);var l=IG$._I7d;if(l){l.m1$7.call(l,n.get("uid"),n.get("type").toLowerCase(),n.get("name"),n.get("nodepath"),true,n.get("writable")=="T")}},scope:this}]}],listeners:{celldblclick:function(g,p,h,n,k,o,l,j){if(h==5&&a!="SQLCube"&&n.get("type")=="Metric"){l.stopPropagation();l.preventDefault();d._5.call(d,n,"set");return false}},cellclick:function(g,j,p,k,o,q,l,n){if(p==1||p==2){var h=IG$._I7d;if(h){h.m1$7.call(h,k.get("uid"),k.get("type").toLowerCase(),k.get("name"),k.get("nodepath"),true,k.get("writable")=="T")}}},scope:this}}]},{xtype:"gridpanel",region:"south",hidden:a=="MDBCube"?false:true,height:250,title:IRm$.r1("L_JOIN"),name:"grd_join",store:{xtype:"store",fields:["selected","joinfrom","jointo","joincondition"]},tbar:[{iconCls:"icon-toolbar-add",tooltip:IRm$.r1("L_ADD_JOIN"),handler:function(){this._t$("cmd_join_add")},scope:this},{iconCls:"icon-toolbar-remove",tooltip:IRm$.r1("L_DELETE_CHECKED"),handler:function(){this._t$("cmd_join_delete")},scope:this}],columns:[{xtype:"checkcolumn",dataIndex:"selected",width:30,editor:{xtype:"checkbox",cls:"x-grid-checkheader-editor"}},{text:"Join From",dataIndex:"joinfrom",flex:2},{text:"Condition",dataIndex:"condition",flex:2,hidden:true},{text:"Join To",dataIndex:"jointo",flex:2}]}],region:"center",collapsible:false}]});IG$._IC5.superclass.initComponent.call(this)},listeners:{afterrender:function(b){var a=b;a.dataview=a.down("[name=dataview]");a._m1()},deactivate:function(b){var a=b;a.disposeContent(a)},scope:this},disposeContent:function(a){}});IG$.MwPo=$s.extend($s.window,{modal:true,region:"center",layout:"fit",closable:false,resizable:false,width:360,autoHeight:true,dbscan:1,callback:null,serverNode:null,_IG0:function(){this.close()},_IFf:function(){var b=this,c=b.down("[name=mdbfiles]").getValue();var a={dbname:c};this.callback&&this.callback.execute(a);this.close()},A_:function(){var b=this,a=new IG$._I3e();a.init(b,{ack:"25",payload:IG$._I2d({uid:this.uid,option:"mdbfiles"},"uid;dbtype;option"),mbody:IG$._I2e({option:"standard"})},b,b.rs_A_,null);a._l()},rs_A_:function(a){var g=this.down("[name=mdbfiles]"),c=[],f,e,b,d;f=IG$._I18(a,"/smsg");if(f){e=IG$._I26(f);for(b=0;b<e.length;b++){d=IG$._I1b(e[b],"name");c.push({name:d,value:d})}}g.store.loadData(c)},B_:function(a){var c=this,b=new IG$._I3e();b.init(c,{ack:"25",payload:IG$._I2d({uid:this.uid,option:"mdbfiles",method:"gettable",dbname:a},"uid;dbname;method;option"),mbody:IG$._I2e({option:"standard"})},c,c.rs_B_,null);b._l()},rs_B_:function(a){var b=this.down("[name=columnview]"),d=[],g,f,c,e;g=IG$._I18(a,"/smsg/tables");if(g){f=IG$._I26(g);for(c=0;c<f.length;c++){e=IG$._I1b(f[c],"name");d.push({name:e,alias:e})}}b.store.loadData(d)},in$t:function(){var a=this;a.A_()},km1:function(){var b=this,a=b.down("[name=mform]"),c=b.down("[name=txtfilename]");if(c.getValue()){a.getForm().submit({url:ig$.servlet,waitMsg:"Uploading your data file",success:function(d,g){IG$._I54("Success","Processed file on the server",null,b,0,"success");var f=IG$._I18(d.errorReader.xmlData,"/smsg/result"),e=IG$._I1b(f,"uid");b.A_.call(b)}})}},initComponent:function(){var a=this;a.title=IRm$.r1("L_MDB_OPTION");$s.apply(this,{defaults:{bodyStyle:"padding:10px"},layout:"fit",items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},border:0,items:[{xtype:"form",name:"maform",items:[{xtype:"combobox",name:"mdbfiles",fieldLabel:IRm$.r1("L_MDB_DATAFILES"),queryMode:"local",displayField:"name",valueField:"value",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]},listeners:{change:function(b,e,d,c){a.B_.call(a,e)}}}]},{xtype:"gridpanel",name:"columnview",region:"center",collapsible:false,stateful:true,columnLines:true,selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell"},store:{store:"array",buffered:true,pageSize:50,purgePageCount:0,model:"nosqldblistmodel",data:[],proxy:{type:"memory"}},split:false,scroll:"vertical",initialized:false,minHeight:160,height:160,flex:1,autoScroll:true,plugins:[{ptype:"cellediting",clicksToEdit:false}],columns:[{xtype:"gridcolumn",text:IRm$.r1("L_TABLE_NAME"),dataIndex:"name",flex:2},{xtype:"gridcolumn",text:IRm$.r1("L_ALIAS"),dataIndex:"alias",hidden:true,flex:2,editor:{allowBlank:false}}]},{xtype:"form",name:"mform",items:[{xtype:"fieldset",layout:"anchor",title:IRm$.r1("L_UPLOAD_MDB_FILE"),items:[{xtype:"fieldcontainer",fieldLabel:"MDB Upload",layout:"vbox",items:[{xtype:"fileuploadfield",name:"fileupload",buttonText:IRm$.r1("L_SELECT_FILE"),buttonConfig:{margin:"-10 2 0"},hideLabel:true,listeners:{change:function(b,d,e){var g="",c="\\",f=a.down("[name=txtfilename]");if(d){if(d.indexOf("/")>-1){c="/"}d=d.split(c);if(d.length>0){g=d[d.length-1]}}f.setValue(g)}}},{xtype:"hiddenfield",name:"txtfilename"},{xtype:"hiddenfield",name:"targetfolder",value:"msaccess"},{xtype:"hiddenfield",name:"filenamemode",value:"original"}]},{xtype:"button",text:IRm$.r1("L_UPLOAD"),handler:function(){a.km1.call(a)},scope:this}]}]}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(d){var c=this,b=panel.down("[name=mform]");b.getForm().errorReader=new IG$.m2ER();c.in$t()}}});IG$.MwPo.superclass.initComponent.apply(this,arguments)}});IG$.MwPP=$s.extend($s.window,{modal:true,region:"center",layout:"fit",closable:false,resizable:false,width:360,autoHeight:true,callback:null,_IG0:function(){this.close()},_IFf:function(){var c=this,b=c.down("[name=syntax]").getValue();var a=b;this.callback&&this.callback.execute(a);this.close()},in$t:function(){var b=this,a=b.down("[name=syntax]");a.setValue(b.cube.sqlsyntax||"")},initComponent:function(){var a=this;a.title=IRm$.r1("L_SQL_PRE_PROC");$s.apply(this,{defaults:{bodyStyle:"padding:10px"},layout:"fit",items:[{xtype:"panel",border:0,layout:{type:"vbox",align:"stretch"},border:0,items:[{xtype:"form",name:"maform",layout:"fit",border:0,items:[{xtype:"textarea",name:"syntax",height:120,labelWidth:40,fieldLabel:IRm$.r1("L_SYNTAX")}]}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(c){var b=this;b.in$t()}}});IG$.MwPP.superclass.initComponent.apply(this,arguments)}});IG$.DM2=$s.extend($s.window,{modal:true,region:"center",layout:"fit",closable:false,resizable:false,width:360,autoHeight:true,dbscan:1,callback:null,serverNode:null,modelcontent:null,_IG0:function(){this.close()},_IFf:function(){var f=this,c=f.down("[name=columnfrom]").getValue(),b=f.down("[name=tablefrom]").getValue(),e=f.down("[name=columnto]").getValue(),d=f.down("[name=tableto]").getValue();if(!b||!d||!c||!e){return}var a={source:{name:c,tablename:b},target:{name:e,tablename:d}};f.callback&&f.callback.execute(a);f.close()},in$t:function(){var g=this,f=g.modelcontent,b=g.down("[name=tablefrom]"),e=g.down("[name=tableto]"),d=[],c,a;if(f){for(c in f){a=f[c];d.push(a)}b.store.loadData(d);e.store.loadData(d)}},initComponent:function(){var a=this;a.title=IRm$.r1("L_ADD_JOIN");$s.apply(this,{defaults:{bodyStyle:"padding:10px"},layout:"fit",items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},border:0,items:[{xtype:"form",name:"mform",items:[{xtype:"combobox",name:"tablefrom",fieldLabel:IRm$.r1("L_FR_TABLE"),queryMode:"local",displayField:"name",valueField:"name",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]},listeners:{change:function(c,j,h,f){var g=this,e=j,d=[],b=g.down("[name=columnfrom]");if(g.modelcontent&&g.modelcontent[e]){d=g.modelcontent[e].fields}b.store.loadData(d)},scope:this}},{xtype:"combobox",name:"columnfrom",fieldLabel:IRm$.r1("L_FR_COLUMN"),queryMode:"local",displayField:"name",valueField:"name",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]}},{xtype:"combobox",name:"tableto",fieldLabel:IRm$.r1("L_TO_TABLE"),queryMode:"local",displayField:"name",valueField:"name",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]},listeners:{change:function(b,j,h,e){var g=this,d=j,c=[],f=g.down("[name=columnto]");if(g.modelcontent&&g.modelcontent[d]){c=g.modelcontent[d].fields}f.store.loadData(c)},scope:this}},{xtype:"combobox",name:"columnto",fieldLabel:IRm$.r1("L_TO_COLUMN"),queryMode:"local",displayField:"name",valueField:"name",editable:false,autoSelect:true,store:{xtype:"store",fields:["name","value"]}},{xtype:"combobox",name:"condition",fieldLabel:IRm$.r1("L_JOIN_COND"),queryMode:"local",displayField:"name",valueField:"name",editable:false,autoSelect:true,hidden:true,store:{xtype:"store",fields:["name","value"]}}]}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(c){var b=this;b.in$t()},beforeclose:function(){var d=this,c=true;if(d.writable&&d.uid){var b=new IG$._I3e();b.init(panel,{ack:"11",payload:IG$._I2d({uid:panel.uid}),mbody:IG$._I2e({option:"lock",detail:"close"})},panel,function(e){},false);b._l()}return c}}});IG$.DM2.superclass.initComponent.apply(this,arguments)}});IG$._$1c=$s.extend($s.window,{modal:true,region:"center",layout:"fit",closable:false,resizable:false,width:360,autoHeight:true,callback:null,serverNode:null,modelcontent:null,_IG0:function(){this.close()},in$t:function(){var a=this;setTimeout(function(){a.d1.call(a)},100)},d1:function(){var b=this,a=b.p_1;b._cstep=0;a.on("_bb_comp",function(){b._cstep++;if(b._cstep>4){b.close()}else{setTimeout(function(){a._d1.call(a,b._cstep)},100)}});a._d1.call(a,b._cstep)},initComponent:function(){var a=this;a.title=IRm$.r1("L_B_CUBE");$s.apply(this,{layout:"fit",items:[{xtype:"panel",bodyPadding:10,layout:{type:"vbox",align:"stretch"},border:0,items:[{xtype:"displayfield",name:"l_step_1",value:IRm$.r1("L_BB_STEP_1")},{xtype:"displayfield",name:"l_step_2",value:IRm$.r1("L_BB_STEP_2")},{xtype:"displayfield",name:"l_step_3",value:IRm$.r1("L_BB_STEP_3")}]}],listeners:{afterrender:function(c){var b=this;b.in$t()}}});IG$._$1c.superclass.initComponent.apply(this,arguments)}});IG$._Idc=$s.extend($s.window,{modal:true,region:"center",layout:"fit",closable:false,resizable:false,ufiles:null,width:360,autoHeight:true,callback:null,_IG0:function(){this.close()},datalabel:"",uploadmode:false,deletemode:false,sKK1:function(e){var b=this,a=this.down("[name=fieldvalue]"),d=this.down("[name=uploadmode]"),c=this.down("[name=delimiter]"),h=this.down("[name=deletemode]"),g=this.down("[name=targetsheet]"),f=this.down("[name=file_encoding]");b.datalabel=a.getValue();b.uploadmode=d.getValue();b.deletemode=h.getValue();b.delimiter=c.getValue();b.targetsheet=g.getValue();b.file_encoding=f.getValue();b.fileuid=e;if(a.getValue()==""&&b.uploadmode==false){IG$._I52(IRm$.r1("L_MSG_TABNAME"),b);return}this.callback&&this.callback.execute(b);this.close()},_IFf:function(){var a=this.down("[name=mform]"),c=this.down("[name=orig_filename]"),b=this.down("[name=photo]"),d=this.down("[name=file_encoding]");if(a.getForm().isValid()){var e=a.getForm();document.charset="UTF-8";var g=b.getRawValue();if(g.indexOf("\\")>-1){g=g.substring(g.lastIndexOf("\\")+1)}c.setValue(g);a.submit({url:ig$.servlet,waitMsg:"Uploading your data file",success:function(f,k){var j=IG$._I18(f.errorReader.xmlData,"/smsg/result");var h=IG$._I1b(j,"uid");a.customowner.sKK1.call(a.customowner,h)}})}},initComponent:function(){this.title=IRm$.r1("T_DATA_UPLOAD");$s.apply(this,{defaults:{bodyStyle:"padding:10px"},layout:"fit",items:[{xtype:"form",name:"mform",customowner:this,layout:"anchor",items:[{xtype:"hiddenfield",name:"_mts_",value:IG$._g$a},{xtype:"textfield",name:"orig_filename",hidden:true,fieldLabel:"Original name"},{xtype:"fileuploadfield",name:"photo",fieldLabel:"Data",msgTarget:"side",allowBlank:false,anchor:"100%",buttonText:IRm$.r1("L_SELECT_FILE"),buttonConfig:{margin:"0 2 0"}},{xtype:"combobox",fieldLabel:"Delimiter",name:"delimiter",queryMode:"local",autoSelect:true,autoScroll:true,editable:false,labelField:"name",displayField:"name",valueField:"value",store:{fields:["name","value"],data:[{name:",",value:","},{name:"Tab",value:"tab"},{name:"space",value:"space"},{name:"|",value:"|"}]}},{xtype:"textfield",name:"fieldvalue",fieldLabel:"Field Value",allowBlank:false},{xtype:"combobox",name:"file_encoding",hidden:window.ig$.file_encoding&&window.ig$.file_encoding.length>0?false:true,fieldLabel:"Encoding",editable:false,queryMode:"local",labelField:"name",valueField:"value",displayField:"name",store:{xtype:"store",fields:["name","value"],data:window.ig$.file_encoding||[]},listeners:{afterrender:function(a){if(window.ig$.file_encoding&&window.ig$.file_encoding.length>0){a.select(window.ig$.file_encoding[0].value)}}}},{xtype:"fieldset",title:"Replace Data Options",hidden:(this.ufiles&&this.ufiles.length>0?false:true),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",name:"uploadmode",hidden:(this.ufiles&&this.ufiles.length>0?false:true),hideLabel:true,boxLabel:IRm$.r1("L_FILE_APPEND"),listeners:{change:function(h,e,c,g){var b=this,a=h,k=this.down("[name=deletemode]"),f=this.down("[name=targetsheet]"),d=this.down("[name=fieldvalue]"),j=a.getValue();d.allowBlank=j;f.setVisible(j);k.setVisible(j)},scope:this}},{xtype:"combobox",fieldLabel:"Data File",name:"targetsheet",queryMode:"local",hidden:true,autoSelect:true,autoScroll:true,editable:false,labelField:"name",displayField:"name",valueField:"uid",store:{fields:["name","uid","type","nodepath"],data:this.ufiles}},{xtype:"checkbox",name:"deletemode",hidden:true,fieldLabel:" ",hideLabel:true,boxLabel:IRm$.r1("L_FILE_DELETE")}]}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(c){var d=this.down("[name=delimiter]"),g=this.down("[name=targetsheet]"),b=this.ufiles,e,f=0;d.setValue(",");if(b&&b.length>0){for(e=0;e<b.length;e++){if(b[e].selected==true){f=e;break}}g.setValue(b[f].uid)}var a=c.down("[name=mform]");a.getForm().errorReader=new IG$.m2ER();a.customowner=c}}});IG$._Idc.superclass.initComponent.apply(this,arguments)}});IG$._Ic3=$s.extend($s.window,{modal:true,layout:"fit",closable:false,resizable:false,width:300,autoHeight:true,itemtype:null,parentuid:null,callback:null,_IG0:function(){this.close()},$f3:function(){var c=this,b=this.down("[name=fitemname]"),a=this.down("[name=fdesc]");if(c.callback){c.callback.execute({name:b.getValue(),desc:b.getValue()})}this.close()},listeners:{show:function(a){this.down("[name=fitemname]").focus()}},initComponent:function(){var a=this;a.title=IRm$.r1("L_GROUP_MEASURE");a.items=[{xtype:"panel",layout:"anchor",bodyStyle:"padding:10px",defaults:{anchor:"100%"},items:[{fieldLabel:IRm$.r1("L_ITEMNAME"),xtype:"textfield",labelWidth:80,name:"fitemname",value:"",allowBlank:false,blankText:"Item name is required!",enableKeyEvents:true,listeners:{keyup:function(b,c){if(c.keyCode==13){this.$f3.call(this)}},scope:this}},{fieldLabel:IRm$.r1("L_DESCRIPTION"),xtype:"textarea",labelWidth:80,border:false,height:50,name:"fdesc",value:""}]}];a.buttons=[{text:IRm$.r1("B_CONFIRM"),handler:function(){this.$f3()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}];IG$._Ic3.superclass.initComponent.apply(this,arguments)}});IG$._Ie9=$s.extend($s.window,{title:"Uploaded Data Content",modal:true,region:"center",layout:"fit",closable:false,resizable:false,width:500,height:400,uid:null,callback:null,limit:100,_IG0:function(){this.close()},reqDataContent:function(b,d){var a=this,c=new IG$._I3e();c.init(a,{ack:"5",payload:IG$._I2d({uid:b}),mbody:IG$._I2e({start:d,limit:this.limit},"start;limit")},a,a.rs_reqDataContent,null);c._l()},rs_reqDataContent:function(x){var h=this,g=[],v=this.down("[name=dataview]"),f,o=this.down("[name=tb_rowcount]"),k=this.down("[name=tb_rows]");var y=new IG$._IF1(x),u,s,t,b=[],c,h=this,e,w=[],p,a,d=y.rows,q=y.srow,z=[],n=[],l=[];h.mresult=y;if(d>h.limit){k.setVisible(true);for(u=0;u<Math.ceil(d/h.limit);u++){n.push({label:""+(u+1),index:u})}if(n.length!=k.store.data.length){k.store.loadData(n);k.setValue(0)}}else{k.setVisible(false)}o.setText("Total Rows: "+Number(d).format("0,000")+" (Display: "+Number(y.data.length).format("0,000")+")");for(u=0;u<y.header.length;u++){l.push("c"+u);g.push({xtype:"gridcolumn",flex:1,minWidth:50,text:y.header[u].name,dataIndex:"c"+u})}if(y.data.length>0){for(u=0;u<y.data.length;u++){e={};for(s=0;s<y.cols;s++){e["c"+s]=y.data[u][s].text}z.push(e)}}f={fields:l};v.reconfigure(f,g);f.loadData(z);h.setLoading(false)},cp:function(b){var a=this;a.setLoading(true);a.reqDataContent(a.uid,b*a.limit)},initComponent:function(){var a=this;$s.apply(this,{defaults:{bodyStyle:"padding: 0px;"},items:[{xtype:"gridpanel",name:"dataview",columnLines:true,store:{type:"array",fields:[],data:[]},layout:"fit",autoScroll:true,columns:[],viewConfig:{stripeRows:false}}],tbar:[{name:"tb_rowcount",xtype:"tbtext",text:"Reading data..."},{xtype:"combobox",name:"tb_rows",hidden:true,fieldLabel:"Go to",labelWidth:50,queryMode:"local",autoSelect:true,autoScroll:true,editable:false,labelField:"label",displayField:"label",valueField:"index",store:{fields:["label","index"]},listeners:{change:function(f,e,b,c){var d=f.getValue();if(a._pg!=d){a._pg=d;a.cp.call(a,d)}},scope:this}}],buttons:[{text:IRm$.r1("B_CLOSE"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(b){if(this.uid){var c=this;c.setLoading(true);setTimeout(function(){c._pg=0;c.setLoading(true);c.reqDataContent.call(c,c.uid,0)},80)}}}});IG$._Ie9.superclass.initComponent.apply(this,arguments)}});IG$._Ie3=$s.extend($s.window,{modal:true,region:"center",layout:"fit",closable:false,resizable:false,width:360,autoHeight:true,callback:null,_IG0:function(){this.close()},_IFf:function(){var a=this.down("[name=mform]");if(a.getForm().isValid()){a.getForm().submit({url:ig$.servlet,waitMsg:"Uploading your data file",success:function(b,e){var d=IG$._I18(b.errorReader.xmlData,"/smsg/result");var c=IG$._I1b(d,"uid");b.customowner.sKK1.call(b.customowner,c)}})}},initComponent:function(){this.title=IRm$.r1("T_LDATA_TITLE");$s.apply(this,{defaults:{bodyStyle:"padding:10px"},layout:"fit",items:[{xtype:"form",name:"mform",items:[{xtype:"checkbox",name:"cbtabdim",fieldLabel:"Tab dimension",boxLabel:"Enable",labelWidth:100,listeners:{change:function(c){var b=c.getValue(),a=this.down("[name=txttabdim]");a.setVisible(b)},scope:this}},{xtype:"textfield",name:"txttabdim",hidden:true,fieldLabel:"Name"},{xtype:"displayfield",fieldLabel:"Options"},{xtype:"checkbox",name:"cbloadlastonly",hideLabel:true,boxLabel:"Load last tab only"}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this._IFf()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}]});IG$._Ie3.superclass.initComponent.apply(this,arguments)}});IG$._Ie6=$s.extend($s.window,{layout:"fit",modal:true,region:"center",layout:"fit",title:"Config Uploads",closable:false,resizable:false,width:400,autoHeight:true,in$t:function(){var a=this,c=a.opn,b=this.down("[name=datainfo]");if(c.tabdimension&&c.tabdimension.uid&&c.tabdimension.name){a.down("[name=cbtabdim]").setValue(true);a.down("[name=txttabdim]").setValue(c.tabdimension.name)}b.store.loadData(c.dataset)},sk4:function(){var c=this,b=this.down("[name=txttabdim]").getValue();if(b==""){return}var f=new IG$._I3e(),d="31",a=IG$._I2d({address:this.nodepath+"/"+b,name:b,type:"TabDimension",pid:this.uid,description:""},"address;name;type;pid;description;memo"),e=IG$._I2e();f.init(c,{ack:d,payload:a,mbody:e},c,c.rs_sk4,null);f._l()},rs_sk4:function(a){var b=IG$._I18(a,"/smsg/item");if(b){this.tabdimension=IG$._I1c(b)}},cxc:function(e){var b=this,a=this.down("[name=datainfo]").store,d=a.data.items[e];var c=new IG$._Ie9({uid:d.get("uid")});c.show(b)},c1:function(){var a=this,b=a.opn;if(a.down("[name=cbtabdim]").getValue()==false){b.tabdimension=null}},rxc:function(g){var b=this,f=this.opn,a=this.down("[name=datainfo]").store,e=a.data.items[g],d,c=false;for(d=0;d<f.dataset.length;d++){if(f.dataset.uid==e.get("uid")){f.dataset.splice(d,1);c=true;break}}if(c==true){a.remove(e)}else{IG$._I54("Selection Error","Can't find object in original documents",null,b,1,"error")}},initComponent:function(){var a=this;$s.apply(this,{defaults:{bodyStyle:"padding: 0px;"},items:[{xtype:"form",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"panel",border:0,layout:{type:"vbox",align:"stretch",padding:5},items:[{xtype:"fieldset",title:"Use file list as metric",layout:"anchor",defaults:{anchor:"100%"},bodyPadding:2,items:[{xtype:"checkbox",name:"cbtabdim",fieldLabel:"Tab dimension",boxLabel:"Enable",labelWidth:100,listeners:{change:function(c){var b=c.getValue(),d=this.down("[name=fdtabdim]");d.setDisabled(!b)},scope:this}},{xtype:"fieldcontainer",fieldLabel:"Name",name:"fdtabdim",disabled:true,layout:"hbox",items:[{xtype:"textfield",name:"txttabdim",flex:1},{xtype:"button",width:80,text:"Make Item",tooltip:"Create",handler:function(){this.sk4()},scope:this},{xtype:"button",text:"..",tooltip:"Select",handler:function(){},scope:this}]}]},{xtype:"gridpanel",plain:true,name:"datainfo",height:200,resizable:false,layout:"fit",stateful:true,columnLines:true,store:{fields:["name","uid","type","nodepath"]},plugins:[{ptype:"cellediting",clicksToEdit:1}],fbar:[{xtype:"checkbox",name:"cbloadlastonly",fieldLabel:"",hideLabel:false,boxLabel:"Load last tab only"}],columns:[{xtype:"gridcolumn",flex:1,text:"Data name",dataIndex:"name",editor:{allowBlank:false}},{xtype:"actioncolumn",width:50,sortable:false,items:[{iconCls:"icon-grid-config",tooltip:IRm$.r1("B_CONFIG_ITEM"),handler:function(c,d,b){a.cxc(d)},scope:a},{iconCls:"icon-grid-delete",tooltip:IRm$.r1("B_DELETE_ITEM"),handler:function(c,d,b){a.rxc(d)},scope:a}]}]}]}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this.close()},scope:this},{text:IRm$.r1("B_CLOSE"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(b){this.in$t()}}});IG$._Ie6.superclass.initComponent.apply(this,arguments)}});