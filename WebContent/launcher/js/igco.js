function m$TM(b){var a=this;a.category=null;a.cdoc=null;a.border=1;a.padding=2;a.ty=0;a.focused=null;a.docroot=b;a.docroot.empty();a._IFd()}m$TM.prototype={_IFd:function(){},loadData:function(c,b){var a=this;a.data=c;a.category=b;a.drawData(a.docroot,c)},drawData:function(g,f){var e=this,a=g.width(),c=g.height(),b,d=e.category;e.ty=0;e.curdata=f;if(!f.dom){e.makeDom(f,0)}if(e.cdoc){e.cdoc.remove()}if(d&&d.length>1){e.cdoc=$("<div class='mtreemap-caption'></div>");g.append(e.cdoc);for(b=0;b<d.length;b++){$("<input type='radio' name='category' value='"+b+"'>"+d[b].name+"&nbsp;&nbsp;&nbsp;&nbsp;</input>").attr("checked",d[b].selected).appendTo(e.cdoc).bind("change",function(i){var h=$(i.currentTarget).val();h=parseInt(h);f.dom.trigger("changeCateg",{ti:h})})}e.ty=e.cdoc.height()}g.append(f.dom);e.position(f.dom,0,e.ty,a,c-e.ty);e.layout(f,0,a,c-e.ty)},makeDom:function(a,f){var c=this,b=$("<div class='mtreemap-caption'></div>"),e="mtreemap-node mtreemap-level"+Math.min(f,4),d=$("<div class='"+e+"'></div>").css({zIndex:1});d.bind("mousedown",function(g){g.stopPropagation();if(g.button==0){if(c.focused&&a==c.focused&&c.focused.parent){c.focus.call(c,c.focused.parent)}else{c.focus.call(c,a)}}return true});b.html(a.name);d.append(b);a.dom=d;return d},position:function(e,b,f,c,a){var d=this;c-=d.border*2;a-=d.border*2;e.css({left:b,top:f,width:Math.max(c,0),height:Math.max(a,0)})},layout:function(r,b,v,u){if(!("children" in r)){return}var F=this,o=F.padding,I=r.data["$area"],H=r.data["$min"],a=r.data["$max"];var B=0,f=0,A=v-1,e=u-2,E,k,q,C,z,h,d,n,m,w,s,g,j,l,D,G;B+=o;f+=o;A-=o;e-=o;f+=14;E=Math.sqrt(I/((A-B)*(e-f)));for(k=0;l=r.children[k];++k){if(A-B<30||e-f<20){if(l.dom){l.dom.css({zIndex:0});F.position(l.dom,-2,-2,0,0)}continue}var q=((e-f)>(A-B))?false:true;if(q){C=(e-f)*E}else{C=(A-B)*E}z=F.selectSpan(r.children,C,k);h=z[0];d=z[1];n=B;m=f;for(w=k;w<h;++w){l=r.children[w];if(!l.dom){l.parent=r;l.dom=F.makeDom(l,b+1);r.dom.append(l.dom)}else{l.dom.css({zIndex:1})}s=l.data["$area"];j=l.name+"\n"+(l.data["$area"]||"");g=s/d;G=(a-H==0)?0:(s-H)/(a-H);D=IG$._I15("#a7d6ef","#153a6f",20,G*20);$(l.dom).css({backgroundColor:D});$(l.dom).attr("title",j);if(q){v=d/C;u=s/v}else{u=d/C;v=s/u}v/=E;u/=E;v=Math.round(v);u=Math.round(u);F.position(l.dom,n,m,v,u);if("children" in l){F.layout(l,b+1,v,u)}if(q){m+=u}else{n+=v}}if(q){B+=Math.round((d/C)/E)}else{f+=Math.round((d/C)/E)}k=h-1}},selectSpan:function(b,a,c){var f=b[c],h=f.data["$area"],k=h,i=0,d=0,g,j,e;for(g=c;f=b[g];++g){j=f.data["$area"];if(j<h){h=j}if(j>k){k=j}i+=j;e=Math.max(5*a*a*k/(i*i),1*i*i/(a*a*h));if(d&&e>d){i-=j;break}d=e}return[g,i]},focus:function(k){var e=this,c=e.border,a=0,f=k,g,d,b,h,j;e.focused=k;while(f.parent){f=f.parent;a+=1;for(d=0;g=f.children[d];++d){if(g.dom){g.dom.css({zIndex:0})}}}b=f.dom.width();h=f.dom.height();for(j=k;j.parent;j=j.parent){e.position(j.dom,-c,-c,b,h);j.dom.css({zIndex:1})}e.layout(k,a,b,h)},L1:function(){var c=this,a,e=c.curdata,d=c.docroot,b=[];b.push("<svg xmlns='http://www.w3.org/2000/svg' version='1.1'>");c.L1a(e,b);b.push("</svg>");return b.join("")},L1a:function(d,c){var b=this,a,f=d.dom,e;if(f&&f.is(":visible")){e=f.position();c.push("<text x='"+e.left+"' y='"+e.top+"' fill='black'>"+d.name+"</text>");c.push("<rect x='"+e.left+"' y='"+e.top+"' width='"+f.width()+"' height='"+f.height()+"' style='fill:"+f.css("backgroundColor")+";stroke-width:1;stroke:rgb(0,0,0)'/>");if(d.children){for(a=0;a<d.children.length;a++){b.L1a(d.children[a],c)}}}}};function m$B2(a,c){var b=this;b.ind=a;b.rowdata=c;b.ellipses=[];b.label=$("<div class='bblabel'></div>");b.html=$("<div class='bbbox'></div>");b.ind.container.append(b.html);b.paper=new Raphael(b.html[0]);b.html.append(b.label);b.invalidate=-1;b.validateData.call(b)}m$B2.prototype={validateData:function(){var d=this,a,b=d.ellipses,e=d.ind.colorset,f=d.rowdata,c;for(a=0;a<b.length;a++){b[a].html.remove()}b=[];d.label.text(f.name);for(a=0;a<f.value.length;a++){c={};c.color=e[a%e.length];b.push(c)}d.ellipses=b;d.validateDisplay()},validateDisplay:function(){var a=this;if(a.invalidate>-1){clearTimeout(a.invalidate)}setTimeout(function(){a.updateDisplay.call(a)},100)},updateDisplay:function(){var A=this,k=A.ind,n=A.html,m=IG$.x_10._w(n),u=IG$.x_10._h(n),c=A.rowdata,q=A.ellipses,y,f=k.mcalc.max,e=(k.mv==null?k.mcalc.min:(k.mv>k.mcalc.min?k.mv:k.mcalc.min)),d,o,b,a,r,j,s,l,x,v,z,g=A.label;if(m>0&&u>0){l=A.paper;l.clear();l.setSize(m,u);if(q&&q.length>0){b=Math.min(m,u);d=(f==e)?f:f-e;for(s=0;s<q.length;s++){j=(s==0?c.value[s]:j+c.value[s])}r=(j-e)/d*(b*0.8)+b*0.1;for(s=0;s<q.length;s++){a=(s==0?c.value[s]:a+c.value[s]);o=Math.sqrt(r*r*a/j);y=q[s];y.x=m/2;y.y=u/2;y.radius=o/2}for(s=q.length-1;s>=0;s--){y=q[s];x=y.x;v=y.y;z=y.radius;hue=y.color;y.circle=l.set(l.ellipse(x,v+z-z/5,0,0).attr({fill:"rhsb("+hue+", 1, .25)-hsb("+hue+", 1, .25)",stroke:"none",opacity:0}).animate({rx:z,ry:z/2},400,"<"),l.ellipse(x,v,0,0).attr({fill:"r(.5,.9)hsb("+hue+", 1, .75)-hsb("+hue+", .5, .25)",stroke:"none"}).animate({rx:z,ry:z},400,"<"),l.ellipse(x,v,0,0).attr({stroke:"none",fill:"r(.5,.1)#ccc-#ccc",opacity:0}).animate({rx:z-z/5,ry:z-z/20},400,"<"))}}A.label.css({top:(u-g.height()-4),left:(m-IG$.x_10._w(A.label))/2})}}};function m$Bl(a){this.parent=a;this.mv=null;this.colorset=[0.23,0.4,0.3];this.initVariables()}m$Bl.prototype={initVariables:function(){var a=this;a.ex=[];a.mx=[];a.bubbles=[];a.mcalc={};a.container=$("<div class='bbmain'></div>").appendTo(a.parent)},initControl:function(){var c=this,b,a=c.bubbles;for(b=0;b<a.length;b++){a[b].html.remove()}a=[]},loadData:function(d){var m=this,l=m.ea,o=m.ma,f,e,h,a,b,k,n,c,r=m.mcalc,q,g;if(d&&d.length>0&&l&&l.length>0&&o&&o.length>0){for(f=0;f<o.length;f++){o[f].max=0;o[f].min=0}for(f=0;f<d.length;f++){a="col_"&f;b="";n=[];for(e=0;e<l.length;e++){h=l[e].i;b=(e==0?d[f][h]:b+" "+d[f][h])}for(e=0;e<o.length;e++){h=o[e].i;k=Number(d[f][h]);if(f==0){o[e].min=k;o[e].max=k}else{o[e].min=Math.min(o[e].min,k);o[e].max=Math.max(o[e].max,k)}c=(e==0?k:c+k);n.push(k)}if(f==0){r.min=c;r.max=c}else{r.min=Math.min(r.min,c);r.max=Math.max(r.max,c)}q={name:b,value:n};g=new m$B2(m,q);m.bubbles.push(g)}m.validateControl()}},validateControl:function(){var f=this,j=$(f.parent),k=IG$.x_10._w(j),e=IG$.x_10._h(j),d=f.bubbles,g,c,b,l,a;if(k>0&&e>0&&d&&d.length>0){a=0;b=k/d.length;l=e;for(c=0;c<d.length;c++){g=d[c];g.html.css({left:a,top:0,position:"absolute"});IG$.x_10._w(g.html,b);IG$.x_10._h(g.html,l);g.validateDisplay.call(g);a+=b}}}};var gJ=function(b){var d=this,a=IG$.x_10._w(b),c=IG$.x_10._h(b);d.c=b;d.d3_geo_radians=Math.PI/180;d.lng0=null;d.n=null;d.origin=[-98,38];d.C=null;d.p0=null;d.scale=1000;d.translate=[a/2,c/2];d.parallels=[29.5,45.5];this._IFd()};gJ.prototype={_IFd:function(){var e=this,f=e.d3_geo_radians,c=e.c,g,b,a=IG$.x_10._w(c),d=IG$.x_10._h(c);g=e.paper=new Raphael(c[0],a,d);e.attr={fill:"white",stroke:"#666","stroke-width":0.5,"stroke-linejoin":"round"};e.legend=$("<ul class='map-legend'></ul>").appendTo(c)},getAlbers:function(e){var g=this,d=g.d3_geo_radians,i=d*e.parallels[0],h=d*e.parallels[1],b=d*e.origin[1],j=Math.sin(i),f=Math.cos(i),a={};a.lng0=d*e.origin[0];a.n=0.5*(j+Math.sin(h));a.C=f*f+2*a.n*j;a.p0=Math.sqrt(a.C-2*a.n*Math.sin(b))/a.n;a.parallels=e.parallels;a.scale=e.scale||1;a.translate=e.translate;return a},drawMap:function(D,C){var E=this,v,l,q=E.attr,e=E.paper,c,a=E.d3_geo_radians,y,z,j=E.c,b=IG$.x_10._w(j),f=IG$.x_10._h(j),s;E.mode=C?(C.mode||"albers"):"albers";if(C){E.azmode=C.azmode||null;E.scale=C.scale?C.scale:E.scale;E.mapdp=C.mapdp;E.mapseries=C.mapseries}s=Math.min(b/480,f/250);E.scale=s*E.scale;switch(E.mode){case"albers":l=E.getAlbers({origin:E.origin,parallels:E.parallels,scale:1});E.lng0=l.lng0;E.n=l.n;E.C=l.C;E.p0=l.p0;break;case"azimuthal":E.x0=E.origin[0]*a;E.y0=E.origin[1]*a;E.cy0=Math.cos(E.y0);E.sy0=Math.sin(E.y0);break;case"bonne":E.x0=E.origin[0]*a;E.y0=E.origin[1]*a;E.c1=1/Math.tan(E.y1=45*a);break}if(C.maptype!=E.maptype){E.paper.clear();E.data={};E.label=c="";E.frame=e.popup(100,100,c,"right").attr({fill:"#000",stroke:"#666","stroke-width":2,"fill-opacity":0.7}).hide();if(D.pathes){var d=parseFloat(D.width),x=parseFloat(D.height),e=E.paper,u,o,n,B=0,A=0;s=Math.min(b/d,f/x);B=(b-d*s);A=(f-x*s);for(u in D.pathes){o=D.pathes[u];y=e.set();n=e.path(o.path).attr(q);n.color=Raphael.getColor();y.push(n);y[0].scale(s,s,s,s);y[0].translate(B,A);z={id:u,name:o.name||u,data:[],set:y};E.addEvent(y,z);E.data[u]=z}}else{for(v=0;v<D.features.length;v++){E.drawFeature(D.features[v])}}}else{for(u in E.data){E.data[u].set.attr(q)}}E.maptype=C.maptype;E.Y1();E.y1=0;E.applyColor(0)},mouseUp:function(b){var a=this;if(a.clickHandler){a.clickHandler.f.call(a.clickHandler.o,b)}},Y1:function(){var c=this,b=c.legend,a=c.mapseries;b.empty();c.legidx=0;if(a&&a.length>0){$.each(a,function(d,e){$("<li class='map-legend-item'>"+e.name+"</li>").appendTo(b).bind("click",function(){c.legidx=d;c.applyColor.call(c,d)})})}},applyColor:function(j){var u=this,v=u.data,g=u.mapdp,l=u.paper,m=u.mapseries,y,w,a,x,s,k,r,n,q,h=u.label,b,o,e=u.legend,f;if(g&&m&&m.length>j){f=e.children("li");if(f&&f.length>0){for(n=0;n<f.length;n++){$(f[n]).removeClass("map-legend-selected");if(n==j){$(f[n]).addClass("map-legend-selected")}}}for(n=0;n<m.length;n++){}k=m[j];a=k.maxvalue;x=k.minvalue;for(y in v){s="#ffffff";r=[];b=g[y]||(v[y].name?g[v[y].name.toLowerCase()]:null);if(b){w=(a-x==0)?1:((b[j]-x)/(a-x));s=IG$._I15("#ffffff","#153a6f",100,w*100);for(n=0;n<m.length;n++){r.push(m[n].name+": "+b[n])}}v[y].set.attr({fill:s});v[y].data=r}}},albers:function(g,a){var f=this,e=f.d3_geo_radians,d=(a&&a.scale)?f.scale*a.scale:f.scale,c=(a)?a.n:f.n,h=(a)?a.lng0:f.lng0,b=(a)?a.C:f.C,k=(a)?a.p0:f.p0;t=c*(e*g[0]-h),p=Math.sqrt(b-2*c*Math.sin(e*g[1]))/c,translate=[f.translate[0],f.translate[1]];if(a&&a.translate&&a.translate.length==2){var i=1,l=translate[0],j=translate[1];translate=[l+a.translate[0]*translate[0]*i,j+a.translate[1]*translate[1]*i]}return[d*p*Math.sin(t)+translate[0],d*(p*Math.cos(t)-k)+translate[1]]},azimuthal:function(d){var v=this,a=v.d3_geo_radians,q=v.x0,n=v.sy0,u=v.cy0,w=v.scale,o=d[0]*a-q,b=d[1]*a,i=Math.cos(o),f=Math.sin(o),s=Math.cos(b),m=Math.sin(b),h=v.azmode,j=h!=="orthographic"?n*m+u*s*i:null,r,l=h==="stereographic"?1/(1+j):h==="gnomonic"?1/j:h==="equidistant"?(r=Math.acos(j),r?r/Math.sin(r):0):h==="equalarea"?Math.sqrt(2/(1+j)):1,g=l*s*f,e=l*(n*s*i-u*m);return[w*g+v.translate[0],w*e+v.translate[1]]},bonne:function(j){var f=this,e=f.d3_geo_radians,b=f.x0,k=f.y0,i=f.y1,d=f.c1,c=f.scale,h=j[0]*e-b,g=j[1]*e-k;if(i){var a=d+i-g,l=h*Math.cos(g)/a;h=a*Math.sin(l);g=a*Math.cos(l)-d}else{h*=Math.cos(g);g*=-1}return[c*h+f.translate[0],c*g+f.translate[1]]},drawPolygon:function(g,a){var l=this,d=l.paper,f,h=l.attr,e=g[0].length==2&&typeof(g[0][0])=="number",n,m=[],k,b,j;if(e==true){m=[];for(f=0;f<g.length;f++){k=g[f];k=l[l.mode](k,a);b=k[0];j=k[1];m.push((f==0?"M":"L")+b+" "+j)}m.push("Z");n=d.path(m.join("")).attr(h);n.color=Raphael.getColor()}else{for(f=0;f<g.length;f++){l.drawPolygon(g[f],a)}}},drawGeom:function(j,f){var h=this,l,b=h.paper,e,m=[],c,d=null,a,k=[];if(j.parallels||j.origin){a=h.getAlbers({origin:j.origin,parallels:j.parallels,translate:j.translate,scale:j.scale})}switch(j.type){case"Polygon":l=j.coordinates;b.setStart();h.drawPolygon(l,a);e=b.setFinish();break;case"MultiPolygon":l=j.coordinates;b.setStart();h.drawPolygon(l,a);e=b.setFinish();break}if(e){h.addEvent(e,f)}return e},addEvent:function(b,c){var a=this;(function(e,f,d){e.mouseover(function(){e.animate({stroke:"#FF0000","stroke-width":2},500);e.toFront();d.paper.safari();d.current=e},d);e.mouseup(function(){d.mouseUp.call(d,f)},d);e.mouseout(function(){e.animate({stroke:"#666","stroke-width":0.5},500);e.toFront();d.paper.safari()},d);e.hover(function(g){var n=a.c.offset(),v=g.pageX-n.left,s=g.pageY-n.top-10,o,u=a.label,j=a.frame,l=a.paper,r="up",q=null,k,h,m;clearTimeout(a.leave_timer);u=f.name+"\n";for(o=0;o<f.data.length;o++){u+=f.data[o]+"\n"}if(a.ppp){a.ppp.remove()}a.ppp=d.paper.popup(v,s,u,r)})})(b,c,a)},drawFeature:function(a){var c=this,b,d;switch(a.type){case"Feature":d={id:(a.usps||a.id).toLowerCase(),value:(a.usps||a.id),name:a.properties.name||a.usps||a.id,data:[]};b=c.drawGeom(a.geometry,d);d.set=b;c.data[d.id]=d;break;default:break}}};IG$.c$s20=function(){this.p1=null;this.p1n=null;this.p2=null;this.p2n=null;this.p3;this.m1$5=null;this.toString=function(){return this.p1n+", "+this.p2n+" : "+this.p3}};IG$.c$s21=function(){var c,d,b=window.bowser,a=(window&&window.SVGAngle)||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1");this.hasCanvas=(!a&&!b.msie)?true:false;this.p4;this.p5;this.p6;this.p7;this.p8;this.p9;this.a1;this.cr1=0;this.cr2=0;this.selected;this.width;this.height;this.html=$('<div class="matrixchart"></div>');if(this.hasCanvas==true){this.canvas=$("<canvas></canvas>");this.canvas.appendTo(this.html)}this.ux=function(){if(this.p4&&this.p4.m1$5){this.p5=Number.MAX_VALUE;this.p7=Number.MAX_VALUE;this.p6=Number.MIN_VALUE;this.p8=Number.MIN_VALUE;for(c=0;c<this.p4.m1$5.length;c++){d=this.p4.m1$5[c];this.p5=Math.min(this.p5,d[this.p4.p1]);this.p7=Math.min(this.p7,d[this.p4.p2]);this.p6=Math.max(this.p6,d[this.p4.p1]);this.p8=Math.max(this.p8,d[this.p4.p2])}this.p9=this.p6-this.p5;this.a1=this.p8-this.p7}};this.c1=function(g){var f=g[this.p4.p1],e=1-(this.p6-f)/this.p9;return e};this.c2=function(g){var f=g[this.p4.p2],e=1-(this.p8-f)/this.a1;return e};this.c3=function(){var g,h,f,e;this.pd=[];for(g=0;g<this.p4.m1$5.length;g++){h=this.p4.m1$5[g];f=this.c1(h);e=this.c2(h);this.pd.push([f,e])}this.d4()};this.d4=function(){this.width=this.html.innerWidth();this.height=this.html.innerHeight();var m=3,g,l={};g=this.p4.p3>this.cr2?"rgba(0,0,255,":this.p4.p3>this.cr1?"rgba(150,150,150,":"rgba(255,0,0,";if(this.hasCanvas==true){this.canvas.width=this.width;this.canvas.height=this.height;this.ctx=this.canvas[0].getContext("2d");this.ctx.scale(1,1);this.ctx.fillStyle="rgb(255,255,255)";this.ctx.fillRect(0,0,this.width,this.height);this.ctx.strokeStyle="#5F5F5F";this.ctx.lineWidth=1;this.ctx.fillStyle=g+".5)"}else{if(!this.paper){this.paper=Raphael(this.html[0],0,0,this.width,this.height)}else{this.paper.clear()}}for(c=0;c<this.pd.length;c++){var e=this.pd[c],h=(isNaN(e[0])==false?e[0]*this.width:0),f=(isNaN(e[1])==false?(1-e[1])*this.height:this.height),j=Math.floor(h),i=Math.floor(f),n,k=2;j=j-j%5;i=i-i%5;n=""+j+","+i;if(!l[n]){if(this.hasCanvas==true){this.ctx.beginPath();this.ctx.arc(h,f,1,0,Math.PI*2,true);this.ctx.closePath();this.ctx.fill();l[n]={obj:true,mbody:0}}else{l[n]={obj:this.paper.circle(h,f,k),mbody:0};l[n].obj.attr("fill",g+"0.5)")}}}l=null};this.c9=function(e,f){this.d4()};this.m1$1=function(){this.ux();this.c3()}};IG$.c$s22=function(c,b){this.ci=null;this.cells=[];this.parent=c;this.config=b;this.textFields=[];this.showLabels=b.showLabels||true;this.cr1=(b.cr1==null||typeof b.cr1=="undefined")?0:b.cr1;this.cr2=(b.cr2==null||typeof b.cr2=="undefined")?0:b.cr2;this.container=$('<div class="matrixcontainer"></div>');this.container.appendTo(this.parent);this.labelhtml=$('<div class="matrixlabel"></div>');this.labelhtml.css({position:"absolute",top:"0px",left:"0px",width:"0px",height:"0px"});this.labelhtml.appendTo(this.parent);this.idd=false;this.detailviewer=$('<div class="detailviewer"></div>');this.detailviewer.css({position:"absolute",top:10,left:10,width:100,height:100,margin:0,padding:0,backgroundColor:"#ececec",borderColor:"#222222",display:"none"});this.detailviewer.appendTo(this.parent);this.detailviewer.bind("click",function(){$(this).fadeOut()});this.m1$2=$('<div class="detailmatrixplot"></div>');this.m1$2.css({position:"absolute",margin:"20 0 0 0",padding:0,top:0,left:0,right:0,bottom:0});this.uid=0;this.m1$2.appendTo(this.detailviewer);var a=$('<div class="detailmatrixclosebtn"></div>'),d=this.detailviewer;a.css({position:"absolute",top:2,width:16,height:16,right:2});this.detailviewer.append(a);a.bind({click:function(){d.fadeOut()}});this.c1=function(k,x,w){var m=k.length,g=0,q=0,n=0,e=0,v=0,f,j;for(j=0;j<k.length;j++){f=k[j];var h=f[x];var s=f[w];g+=h;q+=s;n+=Math.pow(h,2);e+=Math.pow(s,2);v+=h*s}var u=(m*v)-(g*q);var r=Math.sqrt((m*n)-Math.pow(g,2));var l=Math.sqrt((m*e)-Math.pow(q,2));return u/(r*l)};this.c2=this.c1;this.c3=function(){this.ci=[];if(this.fields.length==0||this.m1$5==null||this.m1$5.length==0){return}var f=this.fields.length;var h=0;for(var g=0;g<f;g++){for(var e=0;e<g+1;e++){if(g!=e){var i=new IG$.c$s20();i.p1n=this.fields[g];i.p1=g;i.p2n=this.fields[e];i.p2=e;i.p3=this.c2.call(this,this.m1$5,i.p1,i.p2);this.ci.push(i);h++}}}};this.c4=function(){var h=this,e=this.ci.length,i;this.m1$3={};while(this.cells.length<e){var g=new IG$.c$s21();g.html.css({border:"1px solid #a5a5a5",width:200,height:200,position:"absolute",padding:0});g.html.appendTo(this.container);i="matrixplot"+this.uid;g.html[0].id=i;this.uid++;g.html.bind({click:function(){h.m1$6.call(h,this)}});this.cells.push(g);this.m1$3[i]=g}while(e<this.cells.length){var f=this.cells.pop();f.remove()}};this.c5=function(){var e=this.fields.length,g,f,h;for(g=0;g<e;g++){if(this.textFields.length<g+1){h=$('<div class="matrixtextfield"></div>');h.css({fontSize:"0.8em",padding:"0 0 0 3",margin:0,position:"absolute",width:130});this.textFields.push(h);h.appendTo(this.labelhtml)}f=this.textFields[g];f[0].innerText=this.fields[g]}while(e<this.textFields.length){var i=textFields.pop();this.textFieldToRemove.remove()}};this.c6=function(){var f=this.textFields.length,i,e,h,g,k,j;if(f>0){i=this.textFields[0];e=i.height();for(h=0;h<f;h++){g=this.textFields[h];k=h*this.m1$4+1;if(h==0){j=0}else{j=(h-1)*this.m1$4+e}g.css({left:k,top:j})}}};this.c7=function(){var h=0;if(this.showLabels&&this.textFields.length>0){var f=this.textFields[0];h=f.position().top+f.height()}var j=this.fields.length;var i=0;for(var m=0;m<j;m++){for(var l=0;l<m+1;l++){if(m!=l){var o=this.ci[i];var n=this.cells[i];o.m1$5=this.m1$5;n.p4=o;n.selected=(o==this.selectedItem);var k="";k=o.p1+"\n"+o.p2+"\n"+o.p3;n.toolTip=k;var g=l*this.m1$4;var e=(m-1)*this.m1$4+h;n.html.css({left:g,top:e,width:this.m1$4,height:this.m1$4});n.cr1=this.cr1;n.cr2=this.cr2;if(this.idd==true){n.m1$1.call(n)}else{n.c9.call(n)}i++}}}};this.c8=function(h,e){var f=h;var i=e;if(this.showLabels==true&&this.textFields.length>0){f=h-this.textFields[this.textFields.length-1].width();i=e-this.textFields[0].height()}else{f=h;i=e}var g=Math.min(f,i)/(this.fields.length-1);return g};this.c9=function(){var g=$(this.parent);var e=g.innerWidth(),f=g.innerHeight();this.container.css({width:e,height:f});this.m1$4=this.c8(e,f);if(this.showLabels&&this.textFields.length>0){this.c6()}this.c7()};this.c10=function(){this.idd=true;this.c3();this.c4();this.c5();this.c9();this.idd=false}};IG$.c$s22.prototype.m1$6=function(d){var c=this.m1$3[d.id],b=c.p4.p3>this.cr2?"rgba(0,0,255,.5)":c.p4.p3>this.cr1?"rgba(150,150,150,.5)":"rgba(255,0,0,0.5)";if(c){var a={chart:{renderTo:this.m1$2[0],defaultSeriesType:"scatter",zoomType:"xy"},title:{text:c.p4.p1n+" vs. "+c.p4.p2n},xAxis:{title:{enabled:true,text:c.p4.p1n},startOnTick:true,endOnTick:true,showLastLabel:true,min:0,max:1},yAxis:{title:{text:c.p4.p2n},min:0,max:1},tooltip:{formatter:function(){return""+this.x+", "+this.y+""}},legend:{enabled:false,layout:"vertical",align:"left",verticalAlign:"top",floating:true,backgroundColor:"#FFFFFF",borderWidth:1},plotOptions:{scatter:{marker:{radius:5,states:{hover:{enabled:true,lineColor:"rgb(100,100,100)"}}},states:{hover:{marker:{enabled:false}}}}},series:[{name:"comparison",color:b,data:c.pd}]};var f=$(this.parent),e=f.width(),g=f.height(),h=Math.min(g,e)*0.85;this.detailviewer.css({left:(e-h-10),top:5,width:h,height:h});this.detailviewer.show();this.plotdetail=new Highcharts.Chart(a)}};IG$.qiNul=function(a,b,c){this.owner=a;this._ILb=b;this.cop=c;this.i1()};IG$.qiNul.prototype={i1:function(){var c=this,b=c.owner,a=$("<div></div>").appendTo(b),d;c.margin={top:19.5,right:19.5,bottom:19.5,left:39.5};c.width=IG$.x_10._w(b);c.height=IG$.x_10._h(b)},i2:function(F){var G=this,a=G.owner,w=G.width,r=G.height,o=G.margin,e=$("<div><div>").appendTo(G.owner),n=G.bb,H=F.data,s=F.colfix,f=F.rowfix,g=(H.length>0)?H[0].length:0,q=[],D={},K,h,A,z,y=s-1,J=(y-1>-1)?y-1:y,m=(J-1>-1)?J-1:J,x=s,v=(g>s+1)?s+1:x,u=(g>x+1)?x+1:x,c,b={},C,I,l=0,B,k=[],d=[{m:0,M:0},{m:0,M:0},{m:0,M:0}],E;B=G.m1(G.cop.nat_timefield,s);m=(B>-1)?B:m;B=G.m1(G.cop.nat_datafield,s);y=(B>-1)?B:y;B=G.m1(G.cop.nat_groupfield,s);J=(B>-1)?B:J;B=G.m1(G.cop.nat_xdata,s);x=(B>-1)?B:x;B=G.m1(G.cop.nat_ydata,s);v=(B>-1)?B:v;B=G.m1(G.cop.nat_vdata,s);u=(B>-1)?B:u;if(s>0){for(A=f;A<H.length;A++){I=H[A][m].code||"";if(!b[I]){k.push(I);b[I]=1}}l=k.length;k=k.sort();b={};for(A=0;A<k.length;A++){b[k[A]]=A}for(A=f;A<H.length;A++){K=H[A][y].code;if(D[K]){c=D[K]}else{c={name:H[A][y].code,region:H[A][J].code,bbdata1:[],bbdata2:[],bbdata3:[]};for(z=0;z<k.length;z++){c.bbdata1.push([z,0]);c.bbdata2.push([z,0]);c.bbdata3.push([z,0])}D[K]=c;q.push(c)}I=H[A][m].code||"";C=-1;if(typeof(b[I])!="undefined"){C=b[I]}E=Number(H[A][x].code)||0;E=isNaN(E)?0:E;c.bbdata1[C][1]=E;d[0].m=Math.min(E,d[0].m);d[0].M=Math.max(E,d[0].M);E=Number(H[A][v].code)||0;E=isNaN(E)?0:E;c.bbdata2[C][1]=E;d[1].m=Math.min(E,d[1].m);d[1].M=Math.max(E,d[1].M);E=Number(H[A][u].code)||0;E=isNaN(E)?0:E;c.bbdata3[C][1]=E;d[2].m=Math.min(E,d[2].m);d[2].M=Math.max(E,d[2].M)}}if(d){for(A=0;A<d.length;A++){if(d[A].m==d[A].M){d[A].M=d[A].m+10}}}G.segnames=b;G.seglists=k;G.segmax=l;G.fs=d;G.dt=q;G.i3()},i3:function(){var G=this,c=G.owner,h,C=G.dt,g=G.fs;G.owner.empty();h=$("<div><div>").appendTo(G.owner);function l(x){return x.bbdata1}function k(x){return x.bbdata2}function f(x){return x.bbdata3}function v(x){return x.region}function J(x){return x.name}var m=G.margin,s=IG$.x_10._w(G.owner)-m.right-m.left,o=IG$.x_10._h(G.owner)-m.top-m.bottom;var K=d3.scale.linear().domain([g[0].m,g[0].M]).range([0,s]),e=d3.scale.linear().domain([g[1].m,g[1].M]).range([o,0]),D=d3.scale.sqrt().domain([g[2].m,g[2].M]).range([0,40]),E=d3.scale.category10();var j=d3.svg.axis().orient("bottom").scale(K).ticks(12,d3.format(",d")),b=d3.svg.axis().scale(e).orient("left");var n;n=this.vis=d3.select(h[0]).append("svg").attr("width",s+m.left+m.right).attr("height",o+m.top+m.bottom).append("g").attr("transform","translate("+m.left+","+m.top+")");n.append("g").attr("class","d3-nation-x d3-nation-axis").attr("transform","translate(0,"+o+")").call(j);n.append("g").attr("class","d3-nation-y d3-nation-axis").call(b);n.append("text").attr("class","d3-nation-x d3-nation-label").attr("text-anchor","end").attr("x",s).attr("y",o-6);n.append("text").attr("class","d3-nation-y d3-nation-label").attr("text-anchor","end").attr("y",6).attr("dy",".75em").attr("transform","rotate(-90)");var i=n.append("text").attr("class","d3-nation-year d3-nation-label").attr("text-anchor","end").attr("y",o-24).attr("x",s);var I=d3.bisector(function(x){return x[0]});var F,r,d=n.append("g").attr("class","d3-nation-dots").selectAll(".dot").data(A(0)).enter();r=d.append("circle").attr("class","d3-nation-dot").style("fill",function(x){return E(v(x))}).call(H).sort(z);r.append("title").text(function(x){return x.name});F=d.append("text").text(function(x){return x.name}).call(a);n.transition().duration(800*G.segmax).ease("linear").tween("year",q).each("end",u);function H(x){x.attr("cx",function(L){var y=K(l(L));y=(y<0?0:y);return y}).attr("cy",function(y){var L=e(k(y));L=(L<0?0:L);return L}).attr("r",function(L){var y=D(f(L));y=(y<0?0:y);return y})}function a(x){x.attr("x",function(M){var L,y=K(l(M));y=(y<0?0:y);L=D(f(M));L=(L<0?0:L);return y-L}).attr("y",function(y){var L=e(k(y));L=(L<0?0:L);return L})}function z(y,x){return f(x)-f(y)}function u(){var M=i.node().getBBox();var y=d3.scale.linear().domain([0,G.segmax]).range([M.x+10,M.x+M.width-10]).clamp(true);n.append("rect").attr("class","d3-nation-overlay").attr("x",M.x).attr("y",M.y).attr("width",M.width).attr("height",M.height).on("mouseover",x).on("mouseout",N).on("mousemove",L).on("touchmove",L);function x(){i.classed("active",true)}function N(){i.classed("active",false)}function L(){w(y.invert(d3.mouse(this)[0]))}}function q(){var x=d3.interpolateNumber(0,G.segmax-1);return function(y){w(x(y))}}function w(x){r.data(A(x),J).call(H).sort(z);F.data(A(x),J).call(a).sort(z);i.text(G.seglists[Math.floor(x)])}function A(x){return C.map(function(y){return{name:y.name,region:y.region,bbdata1:B(y.bbdata1,x),bbdata2:B(y.bbdata2,x),bbdata3:B(y.bbdata3,x)}})}function B(L,O){var N=I.left(L,O,0,L.length-1),y=L[N];if(N>0){var x=L[N-1],M=(O-y[0])/(x[0]-y[0]);return y[1]*(1-M)+x[1]*M}return y[1]}},m1:function(f,d){var b,e=this,a=e._ILb,c=-1;for(b=0;b<a.rows.length;b++){if(a.rows[b].name==f){c=b;break}}if(c==-1&&a.measures.length>0){for(b=0;b<a.measures.length;b++){if(a.measures[b].name==f){c=b+d;break}}}return c}};IG$._ICa=function(a){this.owner=a;this.bb=null;this.i1()};IG$._ICa.prototype={i1:function(){var c=this,b=c.owner,a=$("<div></div>").appendTo(b),d;c.width=IG$.x_10._w(b);c.height=IG$.x_10._h(b);c.margin={top:5,right:40,bottom:20,left:120};if(!c.bb){c.bb=IG$._ICb();IG$.x_10._w(c.bb,c.width-c.margin.right-c.margin.left);IG$.x_10._h(c.bb,c.height-c.margin.top-c.margin.bottom)}d=$("<ul></ul>").appendTo(a);c.gtp=d;d=$("<li></li>").appendTo(c.gtp);$("<div>Ranges</div>").appendTo(d);c.ranges=$("<combobox></combobox>").appendTo(d);d=$("<li></li>").appendTo(c.gtp);$("<div>Measures</div>").appendTo(d);c.measures=$("<combobox></combobox>").appendTo(d);d=$("<li></li>").appendTo(c.gtp);$("<div>Markers</div>").appendTo(d);c.markers=$("<combobox></combobox>").appendTo(d)},i2:function(c){var h=this,d=h.owner,b=h.width,k=h.height,f=h.margin,j=$("<div><div>").appendTo(h.owner),a=d3.select(j[0]).selectAll("svg"),g=h.bb,e;e=h.pD();a.data(e).enter().append("svg").attr("class","bullet").attr("width",b).attr("height",k).append("g").attr("transform","translate("+f.left+","+f.top+")").call(g);var i=a.append("g").attr("text-anchor","end").attr("transform","translate(-6,"+(k-f.top-f.bottom)/2+")");i.append("text").attr("class","title").text(function(l){return l.title});i.append("text").attr("class","subtitle").attr("dy","1em").text(function(l){return l.subtitle});h.vis=a;h.title=i;g.duration(1000)},i3:function(){var b=this,a=b.bb;vis.datum(randomize).call(a)},pD:function(){var q=this,f=[],s=mresult.data,g=mresult.colfix,c=mresult.rowfix,e=(s.length>0)?s[0].length:0,h={},b={},l,k,m=0,d,w,v,o,n,u,a;for(l=g;l<e;l++){}for(l=c;l<s.length;l++){d={title:null,ranges:[],measures:[],markers:[]};u=null;a=null;for(k=0;k<e;k++){if(k<g){w=s[l][k].text||s[l][k].code;d.title=(l==0)?w:d.title+" "+w}else{w=Number(s[l][k].code);v=(k==g)?w:Math.max(v,w);o=(k==g)?w:Math.min(o,w);if(h[k]==true){if(u==null){u=w;a=w}else{u=Math.min(u,w);a=Math.max(a,w)}}if(b[k]==true){d.markers.push(w)}}}d.ranges=[o,n,v];d.measures=[u,a];f.push(d)}return f}};function randomize(a){if(!a.randomizer){a.randomizer=randomizer(a)}a.ranges=a.ranges.map(a.randomizer);a.markers=a.markers.map(a.randomizer);a.measures=a.measures.map(a.randomizer);return a}function randomizer(b){var a=d3.max(b.ranges)*0.2;return function(c){return Math.max(0,c+a*(Math.random()-0.5))}}IG$._ICb=function(){var h="left",i=false,f=0,c=bulletRanges,g=bulletMarkers,b=bulletMeasures,d=380,j=30,e=null;function a(k){k.each(function(z,s){var A=c.call(this,z,s).slice().sort(d3.descending),m=g.call(this,z,s).slice().sort(d3.descending),B=b.call(this,z,s).slice().sort(d3.descending),y=d3.select(this);var n=d3.scale.linear().domain([0,Math.max(A[0],m[0],B[0])]).range(i?[d,0]:[0,d]);var q=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(n.range());this.__chart__=n;var x=bulletWidth(q),w=bulletWidth(n);var v=y.selectAll("rect.range").data(A);v.enter().append("svg:rect").attr("class",function(F,E){return"range s"+E}).attr("width",x).attr("height",j).attr("x",i?q:0).transition().duration(f).attr("width",w).attr("x",i?n:0);v.transition().duration(f).attr("x",i?n:0).attr("width",w).attr("height",j);var l=y.selectAll("rect.measure").data(B);l.enter().append("svg:rect").attr("class",function(F,E){return"measure s"+E}).attr("width",x).attr("height",j/3).attr("x",i?q:0).attr("y",j/3).transition().duration(f).attr("width",w).attr("x",i?n:0);l.transition().duration(f).attr("width",w).attr("height",j/3).attr("x",i?n:0).attr("y",j/3);var r=y.selectAll("line.marker").data(m);r.enter().append("svg:line").attr("class","marker").attr("x1",q).attr("x2",q).attr("y1",j/6).attr("y2",j*5/6).transition().duration(f).attr("x1",n).attr("x2",n);r.transition().duration(f).attr("x1",n).attr("x2",n).attr("y1",j/6).attr("y2",j*5/6);var C=e||n.tickFormat(8);var u=y.selectAll("g.tick").data(n.ticks(8),function(E){return this.textContent||C(E)});var o=u.enter().append("svg:g").attr("class","tick").attr("transform",bulletTranslate(q)).style("opacity",0.000001);o.append("svg:line").attr("y1",j).attr("y2",j*7/6);o.append("svg:text").attr("text-anchor","middle").attr("dy","1em").attr("y",j*7/6).text(C);o.transition().duration(f).attr("transform",bulletTranslate(n)).style("opacity",1);var D=u.transition().duration(f).attr("transform",bulletTranslate(n)).style("opacity",1);D.select("line").attr("y1",j).attr("y2",j*7/6);D.select("text").attr("y",j*7/6);u.exit().transition().duration(f).attr("transform",bulletTranslate(n)).style("opacity",0.000001).remove()});d3.timer.flush()}a.orient=function(k){if(!arguments.length){return h}h=k;i=h=="right"||h=="bottom";return a};a.ranges=function(k){if(!arguments.length){return c}c=k;return a};a.markers=function(k){if(!arguments.length){return g}g=k;return a};a.measures=function(k){if(!arguments.length){return b}b=k;return a};a.width=function(k){if(!arguments.length){return d}d=k;return a};a.height=function(k){if(!arguments.length){return j}j=k;return a};a.tickFormat=function(k){if(!arguments.length){return e}e=k;return a};a.duration=function(k){if(!arguments.length){return f}f=k;return a};return a};function bulletRanges(a){return a.ranges}function bulletMarkers(a){return a.markers}function bulletMeasures(a){return a.measures}function bulletTranslate(a){return function(b){return"translate("+a(b)+",0)"}}function bulletWidth(a){var b=a(0);return function(c){return Math.abs(a(c)-b)}};