window.IExport=window.IExport||{};IExport.jasper={name:"jasper",params:["jasper_template","pdf_output","pdf_label","rtf_output","rtf_label","ppt_output","ppt_label","excel_label","excel_output","xlsx_label","xlsx_output","html_output","html_label","docx_output","docx_label","xml_output","xml_label"],toolbar:{xtype:"splitbutton",iconCls:"icon-toolbar-export",name:"jasper",hidden:true,tooltip:IRm$.r1("L_EXPORT"),menu:{xtype:"menu",items:[]},handler:function(){if(this.dft_jasp_exp){IExport.jasper.exportReport(this,this.dft_jasp_exp)}}},exportReport:function(b,a){var d=b._ILa,h=d.exportOption,g=d.name,f=new IG$._I3e(),e,c="TMPL";g=g.replace(/\./g,"_");g=g.replace(/ /g,"");g+="."+a;e=b._IB4(h,"jasper");f.init(b,{ack:"20",payload:IG$._I2d({uid:b.uid,type:c,filename:g,fonttype:(h&&h.fonttype?h.fonttype:""),utemplate:"T",tmplpage:h.jasper&&h.jasper.jasper_template,jasper_filetype:a},"uid;type;filename;fonttype;utemplate;tmplpage;jasper_filetype"),mbody:e},b,b.r_IB3,null,g);f._l()},toolbarShow:function(a){var c=a._ILa,g=c.exportOption,b=g?g.jasper:null,e=a.down("[name=jasper]"),d=false,f=0;if(b&&b.jasper_template){d=true;e.menu.removeAll();a.dft_jasp_exp=null;$.each(["pdf","rtf","ppt","excel","xlsx","docx","html","xml"],function(j,h){if(b[h+"_output"]=="T"){if(f==0){a.dft_jasp_exp=h}e.menu.add({xtype:"menuitem",text:h,handler:function(){IExport.jasper.exportReport(a,h)}});f++}})}return d},configPanel:{xtype:"panel",title:"Jasper Report",layout:"anchor",defaults:{anchor:"100%"},items:[{fieldLabel:"Template",name:"jasper_template",xtype:"combobox",queryMode:"local",valueField:"value",displayField:"name",editable:false,store:{xtype:"store",fields:["name","value"]}},{xtype:"fieldset",title:"Output Format",layout:"anchor",defaults:{anchor:"100%",layout:{type:"hbox",anchor:"100%"}},items:[{xtype:"fieldcontainer",defaults:{flex:1,labelWidth:60},items:[{xtype:"checkbox",fieldLabel:"PDF",name:"pdf_output",labelAlign:"right"},{xtype:"textfield",fieldLabel:"Label",name:"pdf_label",labelAlign:"right"}]},{xtype:"fieldcontainer",defaults:{flex:1,labelWidth:60},items:[{xtype:"checkbox",fieldLabel:"RTF",name:"rtf_output",labelAlign:"right"},{xtype:"textfield",fieldLabel:"Label",name:"rtf_label",labelAlign:"right"}]},{xtype:"fieldcontainer",defaults:{flex:1,labelWidth:60},items:[{xtype:"checkbox",fieldLabel:"PPT",name:"ppt_output",labelAlign:"right"},{xtype:"textfield",fieldLabel:"Label",name:"ppt_label",labelAlign:"right"}]},{xtype:"fieldcontainer",defaults:{flex:1,labelWidth:60},items:[{xtype:"checkbox",fieldLabel:"Excel",name:"excel_output",labelAlign:"right"},{xtype:"textfield",fieldLabel:"Label",name:"excel_label",labelAlign:"right"}]},{xtype:"fieldcontainer",defaults:{flex:1,labelWidth:60},items:[{xtype:"checkbox",fieldLabel:"Excel",name:"xlsx_output",labelAlign:"right"},{xtype:"textfield",fieldLabel:"Label",name:"xlsx_label",labelAlign:"right"}]},{xtype:"fieldcontainer",defaults:{flex:1,labelWidth:60},items:[{xtype:"checkbox",fieldLabel:"Word docx",name:"docx_output",labelAlign:"right"},{xtype:"textfield",fieldLabel:"Label",name:"docx_label",labelAlign:"right"}]},{xtype:"fieldcontainer",defaults:{flex:1,labelWidth:60},items:[{xtype:"checkbox",fieldLabel:"HTML",name:"html_output",labelAlign:"right"},{xtype:"textfield",fieldLabel:"Label",name:"html_label",labelAlign:"right"}]},{xtype:"fieldcontainer",defaults:{flex:1,labelWidth:60},items:[{xtype:"checkbox",fieldLabel:"XML",name:"xml_output",labelAlign:"right"},{xtype:"textfield",fieldLabel:"Label",name:"xml_label",labelAlign:"right"}]}]}],listeners:{afterrender:function(d){var c=d.pt_p,b=d.ep,e=d.opt,a=new IG$._I3e();a.init(c,{ack:"11",payload:IG$._I2d({uid:c.uid}),mbody:IG$._I2e({option:"jasper"})},c,function(f){var l=IG$._I18(f,"/smsg"),k=IG$._I26(l),g,h,n=[],m,j;n.push({name:IRm$.r1("B_SEL"),value:""});for(g=0;g<k.length;g++){h=IG$._I1c(k[g]);h.value=h.name;n.push(h)}d.down("[name=jasper_template]").store.loadData(n);for(g=0;g<b.params.length;g++){m=d.down("[name="+b.params[g]+"]");if(m&&e[b.name]){j=e[b.name][b.params[g]]||"";j=(j=="T"||j=="F")?(j=="T"?true:false):j;m.setValue(j)}}},false);a._l()}}}};